!function(a,b,c,d){"use strict";!function(a){for(var b={},c=function(){},d=["memory"],e=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profiles","profileEnd","show","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],f,g;f=d.pop();)a[f]=a[f]||b;for(;g=e.pop();)a[g]=a[g]||c}(a.console=a.console||{});var e=a.LMDA||{};e.$window=$(a),e.$html=$("html"),e.$document=$(b),e.$body=$(c),e.Views={},e.Models={},e.Collections={},e.Templates={Controls:{}},e.Mixins={},e.exports={},e.page=null,e.isTouch="ontouchstart"in a||a.DocumentTouch&&b instanceof a.DocumentTouch,e.isWidescreen=e.$html.hasClass("widescreen"),e.isOldbrowser=e.$html.hasClass("ie8"),e.Events=_.extend({},Backbone.Events,{APP_INIT:"app:init",APP_READY:"app:ready",STAT_READY:"Statistics:ready",SCREEN_CHANGE:"screenChange",PAGE_STATE:"pageState",CLOSE_TOOLTIPS:"closeTooltips",OPEN_AUTH_FORM:"auth:open",AUTH_SUCCESS:"auth:success",CART_ADD:"cart:add",CART_UPDATE:"cart:update",WISH_LIST_ADD:"wishlist:add",WISH_LIST_REMOVE:"wishlist:remove"}),e.site=e.country.site,e.sizeSystem="RUS",e.isTouch&&$("body").css("cursor","pointer"),e.ajax=$.ajax,e.console={},e.console.error=function(a,b){a&&"object"==typeof a&&a.message&&((new Image).src="/error/js/catch?msg="+a.message,window.console&&"function"==typeof window.console.error&&window.console.error.apply(window.console,arguments))},e.start=function(){function a(){e.marketing=new e.Marketing,e.Stats&&e.Stats.init(),e.Statistics&&e.Statistics.init(),e.Events.trigger(e.Events.APP_READY)}e.Events.trigger(e.Events.APP_INIT),e.page=new e.Views.PageView,window.addEventListener?window.addEventListener("load",a):window.attachEvent("onload",a)},require&&require.config&&require.config({baseUrl:e.country.staticRoot+e.country.requireBaseUrl,paths:{text:e.country.staticRoot+"src/js/libs/require/modules/require.text"}}),a.LMDA=e}(window,document,document.body||document.getElementsByTagName("body")[0]),function(a,b){$.getScript=function(a,b){return $.ajax({url:a,dataType:"script",cache:!0,success:b})},function(a){var b=a.sync;a.sync=function(c,d,e){e=e||{};var f=e.success,g=e.success;return e.success=function(a,b,c){a&&a.status&&"OK"!==a.status.toUpperCase()&&d.trigger("responseError",a),f&&f.apply(e,arguments)},e.error=function(a,b,c){d.trigger("responseError",a),g&&g.apply(e,arguments)},b.apply(a,arguments)}}(Backbone)}(window,document),function(a,b){"use strict";var c=document.documentElement||document,d=document.getElementsByTagName("body")[0],e=a.location,f=a.LMDA=a.LMDA||{},g=f.$html||$("html"),h=f.$window||$(a),i=f.$document||$(c),j=f.$body||$(d),k;f.Utils=f.Utils||{},f.Utils.slice=k=Array.prototype.slice,f.Utils.formatPrice=function(a,b,c){return a=c&&"by"===f.country.site?parseFloat(a||0).toFixed(2):parseInt(a||0,10),a+="",a=a.replace(/(\d)(?=(\d{3})+\b)/g,"$1 "),b&&(a+=" "+b),a},f.Utils.pluralize=function(a,b,c,d){return a%10==1&&a%100!=11?b:a%10>=2&&4>=a%10&&(10>a%100||a%100>=20)?c:d},f.Utils.ButtonPreloader=function(a){this.$el=$(a),this.$progress=this.$el.find(".button__progress"),this.x=0},f.Utils.ButtonPreloader.prototype.start=function(){this.$el.addClass("button_in-progress"),this.interval=setInterval(_.bind(function(){this.x++,this.$progress.css("background-position",this.x+"px 0px")},this),100)},f.Utils.ButtonPreloader.prototype.stop=function(){clearInterval(this.interval),this.$el.removeClass("button_in-progress")},f.Utils.Button2Preloader=function(a){this.$el=$(a)},f.Utils.Button2Preloader.prototype.start=function(){this.$el.addClass("button_inprogress")},f.Utils.Button2Preloader.prototype.stop=function(){this.$el.removeClass("button_inprogress")},f.Utils.getElementsPosition=function(a,b){var c;return a&&a.length?(!b&&(b={}),c=a.offset(),{top:c.top-(b.verticalMargin||0),bottom:c.top+(b.verticalMargin||0)+(b.verticalSquare||0),left:c.left+b.horizontMargin||0}):{}},f.Utils.getElementsDimensions=function(a){return a&&a.length?a.outerWidth?{width:a.outerWidth(),height:a.outerHeight()}:{width:a.width(),height:a.height()}:{}},f.Utils.getUrlParam=function(a){var b={};return _.each(e.search.replace("?","").split("&"),function(a){var c=a.split("="),d=c[0],e;try{e=c[1]?decodeURIComponent(c[1].replace(/\+/g,"%20")):""}catch(g){e="",f.console.error(g)}b[d]?("string"==typeof b[d]&&(b[d]=[b[d]]),b[d].push(e)):b[d]=e}),b[a]},f.Utils.addUrlParam=function(a,b,c){var d=a||"",e,f={},g;return a&&"undefined"!=typeof b&&""!=b&&"undefined"!=typeof c&&(e=a.split("?"),e[1]&&_(e[1].split("&")).each(function(a){a.indexOf("=")<0||(g=a.split("="),f[g[0]]=g[1])}),f[b]=c,d=e[0]+_.reduce(f,function(a,b,c){return a+(a?"&":"?")+c+"="+b},"")),d},f.Utils.parseUrl=function(){var a={params:{}};return _.each(e.search.replace("?","").split("&"),function(b){var c=b.split("="),d=c[0],e;try{e=c[1]?decodeURIComponent(c[1].replace(/\+/g,"%20")):""}catch(g){e="",f.console.error(g)}a.params[d]=e}),a.pathname=_.compact(e.pathname.split("/")),a},f.Utils.getBreadcrumbs=function(){return $(".breadcrumbs__item").map(function(){var a=$(this);if("/"!=a.attr("href"))return a.text()})},f.Utils.getUrlParts=function(a){return _.compact(a.split("/"))},f.Utils.cookie=function(){return{get:function(a){var b=[],c=document.cookie.split(";"),d=0,e=c.length;for(a=RegExp("^\\s*"+a+"=\\s*(.*?)\\s*$");e>d;d++){var f=c[d].match(a);f&&b.push(f[1])}return b.join(",")},set:function(a,b,c){var c=c||"Fri, 31 Dec 9999 23:59:59 GMT";document.cookie=a+"="+b+";expires="+c+";path=/;"}}}(),f.Utils.url=function(){return{open:function(b,c){return a.setTimeout(function(){e.href=b},50),!0},contains:function(a){return a?!(-1===e.href.indexOf(a)):!1},getParam:function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(e.href);return c&&c[1]||""},haveUTMmarks:function(b){return b=b||a.location.search,b&&_.isString(b)?(b=b.split("?"),b.length&&b[1]?/(utm_source|utm_medium|utm_campaign|utm_content|utm_term)/gi.test(b[1]):!1):!1},isSelfReferrer:function(){return new RegExp(".*"+a.location.host.replace("www.","")).test(document.referrer.replace("http://","").replace("https://","").split("/")[0])}}}(),f.Utils.isObjectContains=function(a,b){return _.isString(b)&&(b=[b]),_.size(_.pick(a,b))==b.length},f.Utils.format=function(){function a(a){return a?a.replace(/^\s+|\s+$/g,""):""}function b(a){return a?a&&a.charAt(0).toUpperCase()+a.slice(1):""}function c(a,b){for(var c in b)a=a.replace(new RegExp("{(s*?)"+c+"(s*?)}","ig"),b[c]);return a}return{trim:a,mTmpl:c,cfl:b}}(),f.Utils.scrollElementTo=function(b,c,d){function e(){return b.scrollTop()}function f(a){return b.scrollTop(a)}d=d||.001;var g=e(),h=g-c,i=Math.round(h*d),j=Math.round(.25*h),k=0,l=g,m=g>c;!function n(){if(m){if(c>=l)return}else if(l>=c)return;f(l-=j),a.setTimeout(n,k*i),k++}()},f.Utils.scrollToTop=function(b){function c(){return self.pageYOffset?self.pageYOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop?document.body.scrollTop:0}function d(b){return a.scrollTo(0,b)}b&&b.preventDefault();var e={start:c(),stop:0},f=e.start-e.stop;if(100>f)return void d(e.stop);var g=Math.round(.001*f),h=Math.round(.25*f),i=0,j=e.start;return function k(){j<=e.stop||(d(j-=h),a.setTimeout(k,i*g),i++)}(),!0},f.Utils.Share=function(){var b=encodeURIComponent,c=function(b){var c=626,d=436;a.open(b,"","width="+c+",height="+d+",left="+(a.innerWidth-c)/2+",top="+(a.innerHeight-d)/2)};return{vk:function(a){var d="https://vkontakte.ru/share.php?";d+="url="+b(a.url),d+="&title="+b(a.title),d+="&description="+b(a.description),d+="&image="+b(a.img),d+="&noparse=true",c(d)},fb:function(a){var d="https://www.facebook.com/dialog/feed?app_id=1450367758571438&redirect_uri=http://www.facebook.com&display=popup";d+="&name="+b(a.title),d+="&description="+b(a.description),d+="&link="+b(a.url),d+="&picture="+b(a.img),c(d)},tw:function(a){var d=""+a.title+" "+a.description,e="https://twitter.com/share?url="+a.url;e+="&text="+b(d),c(e)},gp:function(a){var b="https://plus.google.com/share?url="+a.url;c(b)}}}(),f.Utils.intCircle=function(a){return function(b){return(a+b%a)%a}},f.Utils.intLimit=function(a){return function(b){return Math.max(0,Math.min(b,a))}},f.Utils.arrayMoveItem=function(a,b,c){return a.splice(c,0,a.splice(b,1)[0])},f.Utils.eventStop=function(b){return b=b||a.event,b&&(b.preventDefault?b.preventDefault():b.returnValue=!1),b},f.Utils.curry=function(a){var b=f.Utils.slice.call(arguments,1);return function(){return a.apply(this,b.concat(f.Utils.slice.call(arguments,0)))}},f.Utils.getEventsNamesMap=function(a){var b={NAMESPACE:"",blur:"blur",change:"change",click:"click",focus:"focus",focusin:"focusin",focusout:"focusout",input:"input",keydown:"keydown",keypress:"keypress",keyup:"keyup",mousedown:"mousedown",mouseenter:"mouseenter",mouseleave:"mouseleave",mousemove:"mousemove",mouseout:"mouseout",mouseup:"mouseup",mousewheel:"mousewheel",paste:"paste",resize:"resize",scroll:"scroll",submit:"submit"};return f.isTouch&&(b.keypress="input",b.mousedown="touchstart",b.mouseenter="touchstart",b.mouseleave="touchcancel",b.mousemove="touchmove",b.mouseup="touchend",b.mousewheel="touchmove",b.scroll="touchmove",a&&"MenuView"===a&&(b.mousemove="tap")),_.isEmpty(a)?b:_.reduce(b,function(b,c,d){return b[d]=[c,a].join("."),b},{})},f.Utils.onScreenChange=function(){function b(){return k?void 0:(i.on("resize.onScreenChange orientationchange.onScreenChange",_.throttle(g.check,h)),k=!0,!0)}function e(){o=m,p=n;for(var a=0,b=l.length;b>a;a++)l[a](m,n);return!0}function g(a){return k||b(),l.push(a),g}var h=5e3,i=f.isOldbrowser?f.$body||$("body"):f.$window||$(a),j=f.$html||$("html"),k=!1,l=[],m=0,n=0,o=-1,p=-1;if(g.check=function(b){m=c.clientWidth||a.innerWidth||d.clientWidth,n=c.clientHeight||a.innerHeight||d.clientHeight,!l.length||o===m&&p===n||e()},g.off=function(a){return g},f.widescreen){var q="widescreen",r=1246,s=f.isWidescreen||j.hasClass(q);g(function(a){var b=a>=r;s!==b&&(f.isWidescreen=b,f.Events.trigger(f.Events.SCREEN_CHANGE,b),s=b),j.toggleClass(q,b)}).check()}return g}(),f.Utils.getWindowScrollXY=function(){return{x:a.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,y:a.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop}},f.Utils.onScroll=function(){function b(){r=!0,e(function(){if(v())return void(r=!1);var a=f.Utils.getWindowScrollXY(),b=a.x,c=a.y,d;if(c!==p){for(d=o.y.length;d--;)o.y[d](c);p=c}if(b!==q){for(d=o.x.length;d--;)o.x[d](b);q=b}for(d=o.any.length;d--;)o.any[d]([b,c]);for(d=t.length;d--;)t[d]();t=[],r=!1,s(),s=$.noop})}function c(a){(o.x.length||o.any.length||o.y.length||o.any.length)&&(r?s=b:b())}function d(a,b){return l||(f.$window.on("scroll.onScroll",c),f.$body.on("touchmove.onScroll",c),l=!0),"function"==typeof a?(b=a,void o.y.push(b)):void("function"==typeof b&&(-1!==_.indexOf(m,a)?o.x.push(b):-1!==_.indexOf(n,a)?o.any.push(b):o.y.push(b)))}for(var e=a.requestAnimationFrame,g=a.cancelAnimationFrame,h=["ms","moz","webkit","o"],i=0,j=h.length,k=0;j>i&&!e;++i)e=a[h[i]+"RequestAnimationFrame"],g=a[h[i]+"CancelAnimationFrame"]||a[h[i]+"CancelRequestAnimationFrame"];e=e||function(b){var c=(new Date).getTime(),d=Math.max(16,16-(c-k)),e=a.setTimeout(function(){b(c+d)},d);return k=c+d,e},g=g||function(b){a.clearTimeout(b)};var l=!1,m=["x"],n=["any"],o={x:[],y:[],any:[]},p,q,r=!1,s=$.noop,t=[],u=f.Utils.getWindowScrollXY();q=u.x,p=u.y;var v=function(){var a=$(".page");return function(){return a.hasClass("page_unscrollable")||f.$body.hasClass("blocked")}}();return d.check=function(){p=-1,q=-1,b()},d.paint=function(a){t.push(a),r||b()},d.off=function(a,b){var c="y",d,e;if("string"!=typeof a)b=a;else{if("function"!=typeof b)return;-1!==_.indexOf(m,a)?c=m[0]:-1!==_.indexOf(n,a)&&(c=n[0])}d=o[c],e=_.lastIndexOf(d,b),e>-1&&d.splice(e,1)},f.$window.one("load.onScroll",d.check),d}(),f.Utils.getScrollBarsSizes=function(){var b=$("body"),c=$(a),d=document.createElement("div"),e=document.createElement("div"),f,g,h;return d.style.visibility="hidden",d.style.width="100px",document.body.appendChild(d),f=d.offsetWidth,d.style.overflow="scroll",e.style.width="100%",d.appendChild(e),g=e.offsetWidth,d.parentNode.removeChild(d),h=Math.max(0,f-g),function(){return{v:b.height()<=c.height()?0:h,h:b.width()<=c.width()?0:h}}}(),f.Utils.getViewportBounds=function(){var b=f.Utils.getScrollBarsSizes(),e=f.Utils.getWindowScrollXY(),g={left:e.x,top:e.y};return g.right=g.left+(a.innerWidth||c.clientWidth||d.clientWidth)-b.v,g.bottom=g.top+(a.innerHeight||c.clientHeight||d.clientHeight)-b.h-b.v,g},f.Utils.getElementBounds=function(a){a=a.get?a.get(0):a,a=a.getBoundingClientRect();var b=a.left,c=a.top,d=a.width,e=a.height,g=.5*d,h=.5*e,i=f.Utils.getWindowScrollXY();return b+=i.x,c+=i.y,{width:d,height:e,hWidth:g,hHeight:h,left:b,top:c,right:b+d,bottom:c+e,hCenter:b+g,wCenter:c+h}},f.Utils.getHiddenElementSizes=function(){var a={display:"block",visibility:"hidden"};return function(b){var c={display:b.css("display"),visibility:b.css("visibility")},d,e;return b.css(a),d=b.width(),e=b.height(),b.css(c),{width:d,height:e,hWidth:.5*d,hHeight:.5*e}}}(),f.Utils.eventBinder=function(c){var d={bind:function(){},unbind:function(){}},e=function(b){var c=a.event;return c.target=c.target||c.srcElement||b,c};return c.addEventListener?d.bind=function(a,b,c){a.addEventListener(b,c,!1)}:c.attachEvent&&(d.bind=function(a,b,c){a[b+c]=c.handleEvent?function(){var b=e(a);c.handleEvent.call(c,b)}:function(){var b=e(a);c.call(a,b)},a.attachEvent("on"+b,a[b+c])}),c.removeEventListener?d.unbind=function(a,b,c){a.removeEventListener(b,c,!1)}:c.detachEvent&&(d.unbind=function(a,c,d){a.detachEvent("on"+c,a[c+d]);try{delete a[c+d]}catch(e){a[c+d]=b}}),d}(document.documentElement),f.Utils.resourceManager=function(){function a(a){function c(a){return g.isReady=!0,e(a)}function d(a){return g.isReady=!1,e(a)}function e(a){return f.Utils.eventBinder.unbind(a.target,"load",c),f.Utils.eventBinder.unbind(a.target,"error",d),g.img.complete&&g.img.naturalWidth!==b&&(g.isReady=0!==g.img.naturalWidth),h(g)}var g={},h=function(){};return g.img=document.createElement("img"),g.isReady=!1,g.get=function(b){return h=b||h,f.Utils.eventBinder.bind(g.img,"load",c),f.Utils.eventBinder.bind(g.img,"error",d),g.img.src=a,g},g}var c={};return{loadImage:function(b,d){var e=c[b]=c[b]||new a(b);return e.isReady?d(e):e.get(d)},loadImages:function(a,b){var c=this,d=a.length;return _.each(a,function(a){c.loadImage(a.src,function(){--d||b()})}),d}}}(),f.Utils.getPointerPageXY=function(){return f.isTouch?function(a){var b=a.originalEvent.changedTouches[0];return[b.pageX,b.pageY]}:function(b){return[b.clientX+a.pageXOffset,b.clientY+a.pageYOffset]}}(),f.Utils.loadCssFile=function(a){var b=document.getElementsByTagName("head")[0],c={},d=f.country.staticRoot;return 0===d.indexOf("//")&&(d=[location.protocol,d].join("")),function(a){if(_.isUndefined(a)||c[a])return!1;0===a.indexOf("/")&&(a=a.substring(1)),a=[d,a].join("");var e=document.createElement("link");return e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href",a),b.appendChild(e),c[a]=e,!0}}(),f.Utils.pageManager=function(){var a="html_noscroll",b=101,c=!1,d=function(){var a=document.createElement("div"),b=document.createElement("div"),c,d;return a.style.visibility="hidden",a.style.width="100px",document.body.appendChild(a),c=a.offsetWidth,a.style.overflow="scroll",b.style.width="100%",a.appendChild(b),d=b.offsetWidth,a.parentNode.removeChild(a),Math.max(0,c-d)}(),e={currentZindex:b};return e.isNeeded=function(){return 0!==$(".modal_visible, .popup_visible").length},e.isBlocked=function(){return c},e.maintainZindex=function(a){return f.Events&&f.Events.trigger(f.Events.CLOSE_TOOLTIPS),e.currentZindex+=a?1:-1},e.block=function(){return c?this:(c=!0,j.css({"padding-right":parseInt(j.css("padding-right"),10)+d+"px"}),g.addClass(a),f.Events.trigger(f.Events.PAGE_STATE,!0),this)},e.unblock=function(){return!c||e.isNeeded()?this:(c=!1,j.css({"padding-right":0}),g.removeClass(a),f.Events.trigger(f.Events.PAGE_STATE,!1),this)},e}(),f.Utils.ModalsStack=function(){function a(){this.current=null,this._stack=[]}return a.prototype.get=function(){return this._stack[this.current]},a.prototype.getLength=function(){return this._stack.length},a.prototype.pop=function(){return this._stack.pop(),f.Utils.pageManager.maintainZindex(!1),this.current-=1},a.prototype.push=function(){return f.Utils.pageManager.maintainZindex(!0),this.current=this._stack.push.apply(this._stack,arguments)-1},a}(),f.Utils.RequestManager=function(a){var b=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,c;return{ajax:function(d,e){return c&&c.abort(),-1===d.indexOf("ajax=")&&(d+=-1!==d.indexOf("?")?"&":"?",d+="ajax=1"),c=f.ajax({url:d,type:"get",dataType:"html",beforeSend:a.onBeforeRequest}).always(function(){if(a.onAfterRequest(c),4!==c.readyState||200!==c.status)return a.onRequestFail(c),void(c=null);var d=c.responseText.match(b).join(""),f=$("<div/>").html([c.responseText.replace(b,""),d].join(""));e&&(f=f.find(e)),a.onRequestDone(c,f.contents()),c=null})},stop:function(){c&&c.abort()}}},f.Utils.getUniqueID=function(){var a=0;return function(b){return b.uniqueID||(b.uniqueID="UI_"+a++)}}()}(window),LMDA.Validators={},LMDA.Validators.nospecsymbols={validator:function(a){return/^[^\d\/*&()±§!?@#№%\\$\/;_:<>"}{\]\^.,+=\[|]+$/i.test(a)},message:"В поле введены некорректные символы. Можно вводить буквы и символы: ` ~ - '"},LMDA.Validators.nowhitespace={validator:function(a){return/^\S+$/i.test(a)},message:"В поле присутствуют некорректные символы: пробелы"},LMDA.Validators.norusymbols={validator:function(a){return/^[0-9A-Za-z!@#$%^&*()_+]+$/i.test(a)},message:"Вы ввели недопустимые символы. Пароль должен содержать цифры и буквы латинского алфавита."},LMDA.Validators.digitsonly={validator:function(a){return/^\d+$/.test(a)},message:"Можно вводить только цифры"},LMDA.Validators.phone={validator_ua:function(a){return/^\+?380\d{9}$/g.test(a)},validator_by:function(a){return/^\+?\d{12}$/g.test(a)},validator_ru:function(a){var b=0===a.indexOf("+")?a.substr(1):a;return/^\d{11}$/g.test(b)},message:["Пожалуйста, укажите номер Вашего мобильного телефона. Например,",LMDA.country.phone.code,LMDA.country.phone.maskSample].join(" ")},LMDA.Validators.email={validator:function(a){return/^\s*[a-z0-9+_-]+(?:\.[a-z0-9+_-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+(?:ac|ad|ae|aero|af|ag|ai|al|am|an|ao|aq|ar|arpa|as|asia|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|biz|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cat|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|com|coop|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|edu|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gov|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|info|int|io|iq|ir|is|it|je|jm|jo|jobs|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mil|mk|ml|mm|mn|mo|mobi|mp|mq|mr|ms|mt|mu|museum|mv|mw|mx|my|mz|na|name|nc|ne|net|nf|ng|ni|nl|no|np|nr|nu|nz|om|one|org|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|pro|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sy|sz|tc|td|tel|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|travel|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw)\s*$/i.test(a)},message:"Пожалуйста, введите действительный адрес электронной почты. Например, johndoe@domain.com"},function(){var a=LMDA.Utils.getUrlParam("callcenter_operator"),b=LMDA.Utils.getUrlParam("callcenter_call"),c=LMDA.Utils.getUrlParam("callcenter_type"),d=LMDA.Utils.getUrlParam("utm_source"),e;e=function(a,b,c){var d;b+="",c&&(d=new Date,d.setDate(d.getDate()+c)),document.cookie=[encodeURIComponent(a),"=",encodeURIComponent(b),c?"; expires="+d.toUTCString():"","; path=/;"].join("")},void 0==a||void 0==b||void 0==c&&void 0==d||(e("callcenter_operator",a,1),e("callcenter_call",b),c?e("callcenter_type",c,1):e("callcenter_type",d,1))}(),LMDA.CrossDomainStorage=function(a,b){this.origin=a,this.path=b,this._iframe=null,this._iframeReady=!1,this._queue=[],this._requests={},this._id=0},LMDA.CrossDomainStorage.prototype={constructor:LMDA.CrossDomainStorage,init:function(){var a=this;if(!this._iframe){if(!(window.postMessage&&window.JSON&&window.localStorage))throw new Error("Unsupported browser.");this._iframe=document.createElement("iframe"),this._iframe.style.cssText="position:absolute;width:1px;height:1px;left:-9999px;",document.body.appendChild(this._iframe),window.addEventListener?(this._iframe.addEventListener("load",function(){a._iframeLoaded()},!1),window.addEventListener("message",function(b){a._handleMessage(b)},!1)):this._iframe.attachEvent&&(this._iframe.attachEvent("onload",function(){a._iframeLoaded()}),window.attachEvent("onmessage",function(b){a._handleMessage(b)}))}this._iframe.src=this.origin+this.path},setItem:function(a,b,c){this._request({action:"set",key:a,value:JSON.stringify(b),callback:c})},getItem:function(a,b){this._request({action:"get",key:a,callback:b})},removeItem:function(a,b){this._request({action:"remove",key:a,callback:b})},_request:function(a){var b={request:a,callback:a.callback||function(){}};a.id=++this._id,this._iframeReady?this._sendRequest(b):this._queue.push(b),this._iframe||this.init()},_sendRequest:function(a){this._requests[a.request.id]=a,this._iframe.contentWindow.postMessage(JSON.stringify(a.request),this.origin)},_iframeLoaded:function(){var a,b;if(this._iframeReady=!0,this._queue.length){for(a=0,b=this._queue.length;b>a;a++)this._sendRequest(this._queue[a]);this._queue=[]}},_handleMessage:function(a){var b;if(a.origin==this.origin){if(b=JSON.parse(a.data),"localstorage"!==b.type)return;this._requests[b.id]&&this._requests[b.id].callback(b.value&&JSON.parse(b.value)),delete this._requests[b.id]}}},function(){var a=function(){};LMDA.sessionStorage=function(){try{return 0!==window.localStorage.length&&window.sessionStorage.setItem("trySessionStorage",!0),window.sessionStorage.removeItem("trySessionStorage"),window.sessionStorage}catch(b){return LMDA.console.error(b),{setItem:a,getItem:a,removeItem:a}}}(),LMDA.localStorage=function(){var b="https:",c={},d;try{0!==window.localStorage.length&&window.localStorage.setItem("trySessionStorage",!0),window.localStorage.removeItem("trySessionStorage")}catch(e){return LMDA.console.error(e),{setItem:a,getItem:a,removeItem:a,setItemCrossDomain:a,getItemCrossDomain:a}}return c.setItem=function(a,b,c){window.localStorage.setItem(a,JSON.stringify(b)),c&&c()},c.getItem=function(a,b){var c=window.localStorage.getItem(a),d;return c&&"undefined"!=c?(d=JSON.parse(c),b&&b(d),d):void(b&&b())},c.removeItem=function(a,b){window.localStorage.removeItem(a),b&&b()},window.location.protocol===b?(c.setItemCrossDomain=c.setItem,c.getItemCrossDomain=c.getItem,c.removeItemCrossDomain=c.removeItem):(d=new LMDA.CrossDomainStorage(b+"//"+window.location.hostname,"/static/"+window.LMDA.country.gitRevision+"/js/localstorage.html"),c.setItemCrossDomain=_.bind(d.setItem,d),c.getItemCrossDomain=_.bind(d.getItem,d),c.removeItemCrossDomain=_.bind(d.removeItem,d)),c}()}(),function(){"use strict";function a(){var a=window.location.hash,d;void 0!==a&&""!==a||!f||window.history.replaceState("",document.title,window.location.pathname+window.location.search),e!==a&&(d=b(a),c(d,g),g=d,e=a)}function b(a){var b={},c=a.substring(1).split("&");return _(c).each(function(a){if(a){var c=a.split("=");b[c[0]]=c[1]}}),b}function c(a,b){_(b).each(function(c,d){a.hasOwnProperty(d)?b[d]!==a[d]&&LMDA.Events.trigger("pushStater:"+d,{action:"change",newValue:a[d]}):LMDA.Events.trigger("pushStater:"+d,{action:"disappear"})}),_(a).each(function(c,d){b.hasOwnProperty(d)||LMDA.Events.trigger("pushStater:"+d,{action:"appear",value:a[d]})})}function d(){var a=_(g).map(function(a,b){return a?b+"="+a:b});e="#"+a.join("&"),window.location.hash=e}var e="",f=!(!window.history||!window.history.pushState),g={};LMDA.Utils||(LMDA.Utils={}),LMDA.Utils.pushStater={},"onhashchange"in window?$(window).on("hashchange",a):window.setInterval(a,200),LMDA.Utils.pushStater.set=function(a,b){g[a]="undefined"!=typeof b&&null!==b?b.toString():b,d()},LMDA.Utils.pushStater.remove=function(a){delete g[a],d()},LMDA.Utils.pushStater.get=function(a){return g[a]},LMDA.Utils.pushStater.isInHash=function(a){return g.hasOwnProperty(a)}}(),function(a,b,c){"use strict";function d(a){return this.DICT={DEFAULT_MESSAGE:"Что-то пошло не так. Пожалуйста, попробуйте еще раз."},a&&this.updateDict(a),this}a.LMDA=a.LMDA||{},d.prototype.get=function(a,b,c){if(!a)return c?this.DICT.DEFAULT_MESSAGE:"";a+="",a=a.toUpperCase(),b?(this.DICT[b]=this.DICT[b]||{},b=this.DICT[b]):b=this.DICT;var d=b[a]||b.DEFAULT_MESSAGE||this.DICT.DEFAULT_MESSAGE;return _.isObject(d)&&(d=this.format(d)),d},d.prototype.updateDict=function(a,b){b?(this.DICT[b]=this.DICT[b]||{},b=this.DICT[b]):b=this.DICT;for(var c in a)b[c]=a[c];return this},d.prototype.format=function(a){var b=[];return a.title&&b.push('<div class="message-title">',a.title,"</div>"),a.text&&b.push('<div class="message-text">',a.text,"</div>"),a.info&&b.push('<div class="message-info">',a.info,"</div>"),b.join("")},a.LMDA.Utils=LMDA.Utils||{},a.LMDA.Utils.Messenger=d}(window,document),LMDA=LMDA||{},LMDA.Utils=LMDA.Utils||{},LMDA.Utils.viewportWatcher=function(a){"use strict";function b(){return this.evtCollide="collide.viewportWatcher",this.evtInside="inside.viewportWatcher",this.evtOutside="outside.viewportWatcher",this.propWatched="viewportWatcherBinded",this.cnLazyload="lazy",this.behaviours={},this.commonWindowOffsets=this.getCommonWindowOffsets(),this.LAZY_FALLBACK_IMAGE=" ",this.EVENT_CATALOG_REDRAW="catalog:redrawBefore",this.watchedElements=[],this.init(),this}function c(a){return[function(b){var c=new Date-10,d=_.findIndex(a,function(a){return a.t>c});a=-1!==d?a.slice(d):[];var e=_.findWhere(a,{u:b});return e&&e.r},function(b,c){return a.push({t:new Date-0,r:c,u:b}),c}]}b.prototype.init=function(){var a=this;return LMDA.Events.once(LMDA.Events.APP_READY,function(){a.LAZY_FALLBACK_IMAGE=LMDA.DATA.assets.get("transparent")}),this.$popups=$(".popup"),LMDA.Utils.onScroll("y",function(b){a.check(b)}),!0},b.prototype.isElVisible=function(a){return"none"!=a.css("display")},b.prototype.isPopupActive=function(){return this.$popups.hasClass("popup_visible")},b.prototype.check=function(a){if(this.watchedElements.length&&!this.isPopupActive()){var b=_.reduce(this.watchedElements,function(a,b){var c,d;return this.isElVisible(b.$el)&&(c=this.isInViewport(b.el,b.params),b.lastState={inside:c.inside&&b.lastState.inside!==c.inside,collide:c.collide&&b.lastState.collide!==c.collide,outside:c.outside&&b.lastState.outside!==c.outside},a.push(b)),a},[],this);_.each(b,function(a){var b=a.lastState;b.collide&&(a.counters.collide++,a.$el.triggerHandler(this.evtCollide,a)),b.inside&&(a.counters.inside++,a.$el.triggerHandler(this.evtInside,a)),b.outside&&a.$el.triggerHandler(this.evtOutside,a)},this)}},b.prototype.getCommonWindowOffsets=function(){var a={top:0,right:0,bottom:0,left:0},b=$(".footer-sticky");return a.bottom+=b.length?b.height():0,a},b.prototype.watchElement=function(a,b){if(!a||a[this.propWatched])return!1;var c=$(a),d=null;return a[this.propWatched]=!0,b=b||{},b.offset=b.offset||{},c.hasClass(this.cnLazyload)&&(d=c.data("lazy")||c.data("src"),c.one(LMDA.Utils.viewportWatcher[b.inside?"evtInside":"evtCollide"],LMDA.Utils.viewportWatcher.behaviours.lazyLoad)),this.watchedElements.push({el:a,$el:c,params:b,src:d,counters:{collide:0,inside:0},lastState:{collide:0,inside:0}}),!0},b.prototype.watchElements=function(a,b){return _.reduce(a,function(a,c){return this.watchElement(c,b),!0},!1,this)},b.prototype.unsetWatcher=function(a){return a.hasClass&&(a=a.get(0)),delete a[this.propWatched],this.watchedElements=_.without(this.watchedElements,{el:a}),!0},function(d){var e=c([]),f=e[0],g=e[1];b.prototype.isInViewport=function(b,c){if(!b)return{};b.hasClass&&(b=b.get(0));var d=LMDA.Utils.getUniqueID(b),e=f(d);if(e)return e;var h=b.getBoundingClientRect();if(!(h.left&&h.top&&h.bottom&&h.right)||h.top<0&&h.bottom<0)return g(d,{inside:!1,collide:!1,outside:!0});c=c||{};var i,j,k;i={viewport:c.collide&&c.collide.viewport||a,offset:c.collide&&c.collide.offset||0},j={viewport:c.inside&&c.inside.viewport||a,offset:c.inside&&c.inside.offset||0},i.vR=this._getViewportRect(i.viewport,i.offset),j.vR=this._getViewportRect(j.viewport,j.offset),k=this.isRectInside(h,j.vR);var l={collide:k||this.isRectCollide(h,i.vR),inside:k};return l.outside=!l.collide,g(d,l)}}([]),b.prototype._getViewportRect=function(b,c){b=b||a,b.hasClass&&(b=b.get(0));var d=this.getViewportRect(b);return c&&(d={top:d.top-(c.top||0),right:d.right-(c.right||0),bottom:d.bottom-(c.bottom||0),left:d.left-(c.left||0)}),b==a&&(d.top-=this.commonWindowOffsets.top,d.right-=this.commonWindowOffsets.right,d.bottom-=this.commonWindowOffsets.bottom,d.left-=this.commonWindowOffsets.left),d},function(){var d=c([]),e=d[0],f=d[1];b.prototype.getViewportRect=function(b){b=b||a,b.hasClass&&(b=b.get(0));var c=LMDA.Utils.getUniqueID(b),d=e(c);return d?d:b!==a&&document.contains(b)?f(c,b.getBoundingClientRect()):b.innerWidth?f(c,{left:0,top:0,bottom:b.innerHeight,right:b.innerWidth}):"CSS1Compat"==document.compatMode?f(c,{left:0,top:0,bottom:document.documentElement.clientHeight,right:document.documentElement.clientWidth}):f(c,{left:0,top:0,bottom:document.body.clientHeight,right:document.body.clientWidth})}}(),b.prototype.isRectInside=function(a,b){return b.top<=a.top&&a.top<=b.bottom&&b.top<=a.bottom&&a.bottom<=b.bottom&&b.left<=a.left&&a.left<=b.right&&b.left<=a.right&&a.right<=b.right},b.prototype.isRectCollide=function(a,b){return!(a.top>b.bottom||a.right<b.left||a.bottom<b.top||a.left>b.right)},b.prototype.triggerScrollEvent=function(){LMDA.Utils.onScroll.check()};var d=new b,e=function(){var a,b=function(){};return _.extend(b.prototype,Backbone.Events),a=new b,a.eventsStack=[],a.reportEvents=_.debounce(function(){for(var b={},c;a.eventsStack.length;)c=a.eventsStack.pop(),b[c.message]=b[c.message]||[],b[c.message].push(c.data);_.each(b,function(a,b){var c="";_.each(a,function(a){c+=a.pos+":"+a.sku+":"+a.tag+(a.actionId?"/"+a.actionId:"")+";"}),LMDA.z(b,{sku:c})})},1e3),a.on("all",function(b,c){a.eventsStack.push({message:b,data:c}),a.reportEvents()}),a}();return $.fn.viewportWatcher=function(a){return this.length?(d.watchElements(this,a),d.check(),this):this},d.behaviours={lazyLoad:function(a,b){function c(){LMDA.page&&LMDA.page.off(d.EVENT_CATALOG_REDRAW,c),f.onabort=f.onerror=f.onload=$.noop,LMDA.Utils.onScroll.paint(function(){b.$el.attr("src",d.LAZY_FALLBACK_IMAGE)})}function e(){LMDA.page&&LMDA.page.off(d.EVENT_CATALOG_REDRAW,c),LMDA.Utils.onScroll.paint(function(){b.$el.attr("src",g).removeClass(d.cnLazyload)})}var f=document.createElement("img"),g;f.onerror=f.onabort=c,"readyState"in f?f.onreadystatechange=function(){"complete"==f.readyState&&(f.complete&&0!==f.width?e():c())}:f.onload=function(){f.complete&&0!==f.naturalWidth?e():c()},f.src=g=b.src,LMDA.page&&LMDA.page.once(d.EVENT_CATALOG_REDRAW,c)},skuCount:function(b,c){c.$el.off(d.evtInside,d.behaviours.skuCount),c._catalogTimer&&a.clearTimeout(c._catalogTimer),c._catalogTimer=a.setTimeout(function(){var a=d.isInViewport(c.el,c.params),b;a.inside&&a.collide?(b=c.$el.parent().data("sku"),b&&e.trigger("item_viewed",{pos:parseInt(c.$el.parent().parent().data("position")||0,10),sku:b,tag:c.$el.parent().data("property")||0,actionId:c.$el.parent().find(".js-cd-discount").data("action-id")||""})):c.$el.one(d.evtInside,d.behaviours.skuCount)},1e3)},indexPage:function(){var a,b,c;return function(e,f){return c=$(".main-collection").not(".hidden").data("for"),!c||a&&b?(f.$el.off(d.evtCollide,d.behaviours.indexPage),void d.unsetWatcher(f.el)):void("woman"==c?b||(b=!0,LMDA.z("show_popular",{gender:"F"})):a||(a=!0,LMDA.z("show_popular",{gender:"M"})))}}()},d}(window),LMDA=LMDA||{},LMDA.Utils=LMDA.Utils||{},LMDA.Utils.delayedLoader=function(a){"use strict";
function b(){return c=this,LMDA.Statistics&&LMDA.Statistics._ready?(c.init(),this):(LMDA.Events.once(LMDA.Events.STAT_READY,function(){c.init()}),this)}var c;return b.prototype.config={selDelayed:"iframe[data-delayed]",dataDelayed:"delayed",cnDelayed:"delayed",cnJsDefined:"js-defined-src",reKeywords:/(brands|collections|is_new|is_sale|labels|seasons|sizes|size_values|print|styles|price|brand_group|kids)/,strKeywords:"KW_VALUE"},b.prototype.init=function(){if(!c.config.selDelayed)return this;var a=$(c.config.selDelayed);if(a.length){var b=[],d=function(a,b){return a.attr("src")||a.attr("src",b).removeClass(c.config.cnDelayed),!0};a.each(function(a,e){var f=$(e),g=f.data(c.config.dataDelayed);if(g){if(g.indexOf(-1!==c.config.strKeywords)){var h=LMDA.Utils.parseUrl(),i=h.pathname.join("+").replace(/-/g,"+");i+=_.map(h.params,function(a,b){return c.config.reKeywords.test(b)?"+"+b+a.replace(/,/g,"%2C"):""}).join(""),g=g.replace(c.config.strKeywords,i)}f.hasClass(c.config.cnJsDefined)?(b.push([f,g]),f.data("src",g)):d(f,g)}});try{b.length&&LMDA.page._setSrc()}catch(e){_.each(b,function(a){d.apply(null,a)}),LMDA.console.error(e)}}return this},new b}(window),function(a,b,c){"use strict";a.LMDA=a.LMDA||{};var d=a.LMDA;d.Utils=d.Utils||{},d.Utils.verboseDate={},d.Utils.verboseDate.WEEKDAYS_IM=["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],d.Utils.verboseDate.MONTHS_RD=["Января","Февраля","Марта","Апреля","Мая","Июня","Июля","Августа","Сентября","Октября","Ноября","Декабря"],d.Utils.verboseDate_v1=function(a){var b=new Date(a);if(!b.getTime())return a;var c=[];return c.push(d.Utils.verboseDate.WEEKDAYS_IM[b.getDay()]),c.push(", "),c.push(b.getDate()),c.push(" "),c.push(d.Utils.verboseDate.MONTHS_RD[b.getMonth()].toLowerCase()),c.join("")}}(window,document),$(function(){$(".turing-part").each(function(a,b){var c;b.firstChild&&8==b.firstChild.nodeType&&(c=b.firstChild.textContent,c||(c=b.firstChild.text,c=c.slice(4,c.length-3)),$(b).replaceWith(c))})}),function(a,b,c){"use strict";var d=a.LMDA||{};d.API={Cart:{}}}(window,document),function(a,b,c){"use strict";function d(a,b,c,d){var e=function(a){var c=_.any(a.data.packages,function(a){return _.find(a.items,function(a){return a.sku12===b||a.sku16===b})});return"ADD__STOCK_IS_NOT_ENOUGH"==a.code&&c?k.ADD__LAST_ITEM_IN_CART:k[a.code]||k.DEFAULT_ERROR};return l[b]?(a.reject({status:"ERROR",code:"JS__SKU_ALREADY_ADDING",message:k.DEFAULT_ERROR}),a):(f(b,!0),LMDA.ajax({type:"POST",url:"/cart/add/"+b,dataType:"json",success:function(i){var j;if("OK"==i.status){try{/^mp/i.test(b)&&(document.cookie="cart2=1; path=/")}catch(k){}j={sku:b,product:g(i.data.packages,b),cart:i.data,upselling:i.upselling,charity:i.charity},c&&(j=_.extend(j,c)),h(j,d),a.resolve(j)}else a.reject({status:i.status,code:i.code,message:e(i),sku:b});f(b,!1)},error:function(){a.reject({status:"ERROR",code:"AJAX_FAILED",message:k.DEFAULT_ERROR,sku:b}),f(b,!1)}}),a)}function e(a,b){var c=[];return _.each(b,function(a){l[a]||(c.push(a),f(a,!0))}),c.length?(LMDA.ajax({type:"POST",url:"/cart/add_skus/",data:{skus:c},success:function(b){"OK"==b.status?(_.each(c,function(a){h({sku:a,cart:b.data,product:g(b.data.packages,a)})}),LMDA.Events.trigger("cart_add_group",b),a.resolve(b)):a.reject(b),f(c,!1)},error:function(b){a.reject(b),f(c,!1)}}),a):(a.reject({status:"ERROR",code:"JS__GROUP_ALREADY_ADDING",message:k.DEFAULT_ERROR}),a)}function f(a,b){_.isArray(a)?_.each(a,function(a){l[a]=b}):l[a]=b}function g(a,b){var c={};return a.length&&b&&_.find(a,function(a){return c=_.find(a.items,function(a){return a.sku12===b||a.sku16===b}),c&&(c.sellerId=a.seller.id),c}),c}function h(a,b){a&&a.cart&&(LMDA.PAGEDATA&&LMDA.PAGEDATA.push({cart:a.cart}),a.quickviewOpenerTypeIndex=b||0,LMDA.Events.trigger(LMDA.Events.CART_ADD,a))}try{if("/checkout/cart/"!=document.location.pathname){var i=!1;$.each(LMDA.user.cart.items,function(a,b){$.each(b,function(a,b){/^mp/i.test(b.sku)&&(i=!0)})}),document.cookie=i?"cart2=1; path=/":"cart2=0; path=/"}}catch(j){}var k={DEFAULT_ERROR:"Что-то пошло не так, попробуйте еще раз",ADD__PRODUCT_NOT_FOUND:"Что-то пошло не так, попробуйте еще раз",ADD__STOCK_IS_NOT_ENOUGH:"Данного размера нет в наличии",ADD__CART_ITEM_ERROR:"Данного размера нет в наличии",ADD__LAST_ITEM_IN_CART:"Последний экземпляр уже у вас в корзине"},l={};LMDA.API.Cart={addToCart:function(a,b,c){var f=new $.Deferred;return a?_.isArray(a)&&a.length?f=a.length>1?e(f,a):d(f,a[0],b,c):"string"==typeof a?f=d(f,a,b,c):f.reject({status:"ERROR",code:"JS__INVALID_ARGUMENTS",message:k.DEFAULT_ERROR}):f.reject({status:"ERROR",code:"JS__ARGUMENTS_ARE_UNDEFINED",message:k.DEFAULT_ERROR}),f},getCart:function(){return $.ajax({type:"get",url:"/cart/json?flat="+Math.round(1e4*Math.random())})}},LMDA.Events.on(LMDA.Events.CART_UPDATE,function(){LMDA.API.Cart.getCart().done(function(a){a.data&&(LMDA.API.Cart.data=a.data)})})}(window,document),function(a,b,c){"use strict";function d(a,b,c){return c.message=g.get(c.code),LMDA.Statistics.report("subscription","newsletter:fail",{location:b.location||"unknown",code:c.code,message:c.message}),a.reject({status:c.status,code:c.code,message:c.message})}function e(a,b,c,d){var d=d||{};if(!c.code){var e=c.email_confirmed,f=_.any(c.subscriptions,function(a){return a.subscribed}),h=[];h.push(e?"CONFIRMED":"NOT_CONFIRMED"),h.push(f?"SUBSCRIBED":"NOT_SUBSCRIBED"),c.code=h.join("_")}return c.message=g.get(c.code),LMDA.Statistics.report("subscription","newsletter:done",{location:b.location||"unknown",code:c.code,message:c.message,filters:b.filters,email:b.email,source:d.source}),c.customer_id&&(LMDA.DATA.user.set("cid",c.customer_id),LMDA.PAGEDATA&&LMDA.PAGEDATA.push({user:{cid:c.customer_id}})),a.resolve(c)}function f(a){var b={};return b.url=a.url||window.location.pathname,b.email=a.email||"",b.location=a.location||"",b.is_from_partner=a.is_from_partner||LMDA.Statistics.API.get("user.isFromPartner",!1)+"",b.source=a.source||LMDA.Statistics.API.get("user.affiliates.source",""),b.gender=function(a){return(a=a||"F").toUpperCase()}(a.gender),b.subscription_type=a.subscription_type||function(){var a=["DEFAULT","SMS"];switch(b.location){case"reg_sub":case"checkout_sub":break;default:a=b.gender&&"M"===b.gender?["DEFAULT","MEN_TRENDS","MEN_PREMIUM_BRANDS","MEN_SPORT","MEN_BEAUTY"]:["DEFAULT","WOMEN_TRENDS","WOMEN_PREMIUM_BRANDS","WOMEN_SPORT","WOMEN_BEAUTY"]}return a.join(",")}(),b}LMDA.API=LMDA.API||{},LMDA.API.subscribe=LMDA.API.subscribe||{};var g=new LMDA.Utils.Messenger({CONFIRMED_SUBSCRIBED:{title:"Спасибо за подписку"},CONFIRMED_NOT_SUBSCRIBED:{title:"Вы уже подписаны"},NOT_CONFIRMED_SUBSCRIBED:{title:"Спасибо!",text:"Вам на e-mail отправлено письмо со ссылкой для подтверждения.",info:"Eсли письмо не пришло, поищите его в папке со спамом или повторите подписку"},NOT_CONFIRMED_NOT_SUBSCRIBED:{title:"Ваш email уже подписан!",text:"Вам отправлено письмо со ссылкой для подтверждения"},DEFAULT_MESSAGE:{title:"Что-то пошло не так"}});LMDA.API.subscribe.newsletter=function(a,b){var c=new $.Deferred;if(_.isEmpty(a))d(c,a,{status:"WRONG_ARGUMENTS",code:"WRONG_ARGUMENTS"});else{a=f(a);var g=LMDA.ajax({url:"/subscribe/newsletter/",type:"post",dataType:"json",data:a}).always(function(){try{var f=JSON.parse(g.responseText);return"OK"===f.status&&200===g.status?e(c,a,f,b):d(c,a,{status:f.status||"ERROR",code:f.code||g.status})}catch(h){return d(c,a,{status:"ERROR",code:g.status})}})}return c}}(window,document),function(a,b,c){"use strict";LMDA.mixins=function(){function a(b,c){return b.parentNode===c?!0:null===b.parentNode?!1:a(b.parentNode,c)}function b(a){return a&&a.get&&(a=a.get(0)),a}var c=LMDA.Utils.getEventsNamesMap("MIXINS");return{OutsideClick:function(){var d=[];return{_offOutsideClick:function(a,e,f){var g=_.indexOf(d,b(a));-1!==g&&LMDA.$window.off(c.click,d[g+1])},_onOutsideClick:function(e,f,g){e=b(e);var h=_.indexOf(d,e);if(-1===h){var i=function(b){b.target===e||a(b.target,e)||(LMDA.$window.off(c.click,i),f.apply(g||null,f,arguments))};return d.push(e,i),void window.setTimeout(function(){LMDA.$window.on(c.click,i)},0)}window.setTimeout(function(){LMDA.$window.on(c.click,d[h+1])},0)}}}()}}(),LMDA.Mixins.initProductPage=function(){function b(a){a&&a.length&&(e.view3D=new LMDA.Views.View3D({el:d.$(".product-zoom")}),e.productImages.on("setimage:3d",function(a){d.activeViewTool instanceof LMDA.Views.View3D||(d.activeViewTool.hold(),e.view3D.lift(a),d.activeViewTool=e.view3D)}))}function c(a){function b(){}if(a&&a.length){var c=$("iframe.product-photos__video");b.prototype.hold=function(){};var f=new b;e.productImages.on("itemchanged",function(){d.activeViewTool instanceof b||c.attr("src","")}),e.productImages.on("setimage:video",function(a,e,g){d.activeViewTool instanceof b||c.attr("src")!=a&&(c.attr("src","/static/"+window.LMDA.country.gitRevision+"/i/video/index.html?video="+a+"&poster="+e+(g?"&width="+g.width+"&height="+g.height:"")),d.activeViewTool.hold(),d.activeViewTool=f)})}}var d=this,e=this.views,f=function(a){return{el:d.$(a)}},g,h;this.productData=f(".product").el.data("json")||{},this.productData.size_table_link=this.$(".product-actions").data("size-table"),LMDA.DATA.page.set("product",this.productData),LMDA.DATA.user.get("wishlist")[this.productData.sku]&&this.$(".js-to-favorites").addClass("to-favorites_on"),this.lastViewedCollection=new LMDA.Collections.LastViewed({onReady:function(){this.addItem(d.productData)}}),e.buyWidget=new LMDA.Views.BuyWidget({el:this.$(".buy-widget"),product:this.productData}),e.socialShare=new LMDA.Views.SocialShare(f(".social-share")),e.productImages=new LMDA.Views.ProductImages(f(".product-photos")),e.zoom=new LMDA.Views.Zoom(f(".zoom")),e.zoom.on("show",e.buyWidget.hideInformer,e.buyWidget),e.zoom.setImage(e.productImages.getDataOrig()),e.productImages.on("setimage:zoom",function(a){return this.activeViewTool instanceof LMDA.Views.Zoom?void e.zoom.setImage(a):(this.activeViewTool.hold(),e.zoom.lift(),e.zoom.setImage(a),this.activeViewTool=e.zoom,void 0)},this),this.activeViewTool=e.zoom,this.$photos=this.$(".product-photos .photos-list__item"),b(this.$photos.filter('[data-type="3d"]')),c(this.$photos.filter('[data-type="video"]')),e.sliderProductPhotos=new(LMDA.isTouch&&LMDA.iScroll?LMDA.Views.SliderTouch:LMDA.Views.Slider)(_.extend(f(".photos-list"),{context:this.context,animation:{duration:200}})),LMDA.DATA.isExperimentOn("UI5774_cobrandcard_PP")&&(h=this.$(".price__mastercard-ico"),h.on("mouseover.mastercard",function(b){g=a.setTimeout(function(){g=!1,LMDA.z("cobrandcard_PP_popup_view"),h.off("mouseover.mastercard mouseout.mastercard")},2e3)}),h.on("mouseout.mastercard",function(b){g&&a.clearTimeout(g)}))},LMDA.Mixins.renderRecommendations=function(a){function b(){var b=c.$(a.selContainer);if(!b.length)return!1;if(c.views.sliderProductRecommendations=new LMDA.Views[e?"SliderTouch":"Slider"]({el:b,context:"recommendations",type:"carousel",mode:"keepButtons",animation:{duration:300}}),LMDA.Utils&&LMDA.Utils.viewportWatcher){var d=c.views.sliderProductRecommendations,f=d.$el.find(".js-slider-arrow");if(d.$list.find(".products-list__item-img").viewportWatcher({inside:{viewport:d.$viewport}}).one(LMDA.Utils.viewportWatcher.evtInside,LMDA.Utils.viewportWatcher.behaviours.skuCount),f.length){var g=null,h=function(){g&&window.clearTimeout(g),g=window.setTimeout(function(){LMDA.Utils.viewportWatcher.check&&LMDA.Utils.viewportWatcher.check()},d.animateDuration+100)};d.on("change",h).on("scrollEnd",h)}}return!0}if(LMDA.DATA.isExperimentOn("recommendations_off"))return!1;a=a||{};var c=this,d=this.$("div[data-recommendataions]"),e=LMDA.isTouch&&LMDA.iScroll,f=a.selContainer&&a.type&&"slider"===a.type;return d.length?(d.each(function(){var a=$(this),c=a.attr("data-recommendataions");c&&LMDA.ajax({url:c,dataType:"html",timeout:5e3,success:function(c){$.trim(c).length?(a.replaceWith(c),f&&b()):a.remove()},error:function(){a.remove()}})}),!0):(f&&b(),!1)}}(window,document),function(a,b,c){"use strict";var d=a.LMDA||{},e=d.Modules={},f=d.SubModules={};d.Module=function(a){function b(){var a=this;if(this.options=this.options||{},this.o=this.options,f[this.name]){var b,a=this,c=f[this.name];this.subModules=this.subModules||{};for(b in c)!function(b){a.once("inited",function(){_.extend(c[b].prototype,{parent:a}),a[b]=new c[b],a.subModules[b]=a[b],a.subModules[b].init()})}(b)}this.defaults&&this.updateOptions(this.defaults),this.prepare&&this.prepare();var e=a.parent?function(b,c){a.parent.trigger(this.name+":"+b,c)}:function(a,b){d.Events.trigger(this.name+":"+a,b)};this.on("all",e)}if(!a)throw"LMDA.Module :: ERROR > constructorParams object required";if(!a.name)throw"LMDA.Module :: ERROR > name string required";if(!a.init)throw"LMDA.Module :: ERROR > init function required";if(a.parent&&!e[a.parent])throw["LMDA.Module :: ERROR > ",a.name," trying to extend not existed module: ",a.parent].join("");if(a.parent&&f[a.parent]&&f[a.parent][a.name])throw["LMDA.Module :: ERROR > ",a.name," submodule already exists in ",a.parent].join("");if(!a.parent&&e[a.name])throw["LMDA.Module :: ERROR > ",a.name," already exists"].join("");var c=a.init;return a.init=function(){return this._enabled?(c.apply(this,arguments),this._inited=!0,void this.trigger("inited")):!1},_.extend(b.prototype,Backbone.Events,{_inited:!1,_muted:!1,_enabled:!0,mute:function(){this._muted=!0},unmute:function(){this._muted=!1},disable:function(){this._enabled=!1},enable:function(){this._enabled=!0},updateOptions:function(a){return a?(this.options=$.extend(!0,this.options,a),this):this}},a),a.parent?(f[a.parent]=f[a.parent]||{},void(f[a.parent][a.name]=b)):e[a.name]=b}}(window,document),function(a,b,c){"use strict";function d(a,b){var c;return b&&(a.initialize=b),a.update=function(){b&&this.set(b())},new(c=Backbone.Model.extend(a))}function e(){var a=i.user||{},c=this,d=function(){var a=_.clone(c.get("cart")),b;_.isEmpty(a)||(b=a.quantity||a.itemsCount||a.itemsTotal||0,0===a.total&&(b=0),a.quantity=b,a.itemsCount=b,a.itemsTotal=b,a.totalString=""+parseFloat(a.total||0).toFixed(2),c.set("cart",a,{silent:!0}))};d(),this.on("change:cart",d),i.Events.on(i.Events.CART_ADD,function(a){c.set("cart",{quantity:a.cart.quantity,total:a.cart.total})}),i.Events.once(i.Events.APP_READY,function(){if(i.page&&i.page.collection&&i.page.context&&"cart"===i.page.context){var a=i.page.collection;a.on("recalc",function(){var b=_.clone(c.get("cart"));b.items=a.toJSON(),b.quantity=a.getItemsCount(),b.discount=a.discountSum||0,b.subtotal=a.subtotalSum||0,b.total=a.totalSum||0,c.set("cart",b)})}}),a.isInBlacklist=i.user&&!!i.user.blacklist,a.isFromPartner=/(utm_medium|utm_source|utm_term)/gi.test(j.search),a.isFromYandexSearch=!!(b.referrer&&b.referrer.match("yandex")&&b.referrer.match("text=")),a.isLoggedIn=i.user&&i.user.isLogon,a.isNew=function(){var a=b.cookie.match(/__utma=([0-9\.]+)/),c;return null===a?!0:a.length>1?(c=a[1].split("."),"1"===c[c.length-1]):!1}(),a.lid=a.lid||i.Utils.cookie.get("lid")||i.uidAny||"",a.segment=a.segment||"";var e={source:""};try{_.each(["affiliate_nl_not_affected","affiliate_base","affiliate_seo_affected","subscriber_base"],function(a){i.localStorage.getItemCrossDomain(a,function(b){b&&(e[a]=b,"affiliate_base"==a&&(e.source=_.toArray(_.pick(b,["date","medium","source","campaign","term","content"])).join(";")))})})}catch(f){i.console.error(f)}finally{this.set({affiliates:e},{silent:!0})}return a.status=a.isLoggedIn?"customer":"visitor",this.set(a),this}function f(){var a=i.pageData||{};return a&&"cart"===a.type&&a.products&&(a.productsTotal=a.products.length,a.productsShort=_.map(a.products,function(a,b){return{id:a.sku16||a.sku12,cnt:a.quantity||0}})),this.set(a,{silent:!0}),this}function g(){return this.set(i.experiments,{silent:!0}),this}function h(){return this.set({locale:i.site,fullUrl:j.pathname+j.search+j.hash},{silent:!0}),i.country&&this.set({currency:i.country.currency},{silent:!0}),this}var i=a.LMDA||{},j=a.location,k={1:!0,"true":!0,TRUE:!0},l;i.Module({name:"DATA",defaults:{},prepare:function(){l=this,this.user=d({},e),this.page=d({},f),this.assets=d({}),this.site=d({},h),this.experiments=d({},g),this.vendors=d({}),this.app=d({}),this.catalog=d({})},init:function(){i.Events.once(i.Events.APP_READY,function(){l.app.set("ready",!0)})},toJSON:function(){var a={};return _.each(["user","page","site","experiments","vendors"],function(b){a[b]=l[b].toJSON()}),a},isExperimentOn:function(a){return a?k[this.experiments.get(a)]||!1:!1}}),i.DATA=new i.Modules.DATA,i.DATA.init(),i.Events.once(i.Events.APP_INIT,function(){if(i.PARAMS)for(var a in i.PARAMS)i.DATA[a]&&i.DATA[a].set(i.PARAMS[a])})}(window,document),function(a){"use strict";var b={csrftoken:1,lid:1,LM_REMAIL:1,LMDA:1,overlay_exit:1,overlay_showcount:1,session_id:1,sid:1,_ga:1,_gat:1,sv:1,user_transaction_ids:1,cart2:1,wt3_eid:1},c=/^(?:wt|_ga|_ym|_dc_gtm_UA\-|overlay|split|_dy|UI(?:\d+$))/;LMDA.cookie=LMDA.cookie||function(){function d(a,b,c){if(!a||typeof a!==h)return{};for(var d={},f=a?a.split(b||"; "):[],g=0,i=[];g<f.length;g++){if(i=e(f[g]),c&&i[0]===c)return i[1];d[i[0]]=i[1]}return d}function e(a){var b=["",""],c;if(decodeURIComponent){b=a.split("="),b=[b.shift(),b.join("=")];try{for(c=b.length;c--;)b[c]=decodeURIComponent(b[c])}catch(d){b=[null,null]}}return b}function f(a){var b=";expires="+new Date(0).toUTCString(),c,d,e,f=!0;d=[""].concat(location.hostname.split("."));do{c=location.pathname.split("/");do c.pop(),e=a+"="+(c.length>0?";path="+c.join("/")+"/":"")+(2===d.length&&f?"":";domain="+d.join("."))+b,document.cookie=e;while(c.length>0);d.shift(),f=!f,f&&(d=[""].concat(d))}while(d.length>=2)}function g(){var a=3072,d=45,e=document.cookie,g=e.length,h,i,j,k=[],l={},m;for(e=e.split("; "),h=e.length,j=e.length;j--;)m=e[j].split("=",1)[0],c.test(m)||m in b||(m in l||(k.push(m),l[m]=[0,0]),l[m][0]+=e[j].length+2,l[m][1]++);for(i=["/error/cookie/?cnt="+h+"&sz="+g+"&url="+encodeURIComponent(location.href)+"&rm="],j=k.length;j--&&(g>a||h>d);)m=k[j],i.push(encodeURIComponent(m)),g-=l[m][0],h-=l[m][1],f(m);i.length>1&&setTimeout(function(){(new Image).src=i[0]+i.slice(1).join(";")},500)}var h="string";return g(),{options:{name:"LMDA",path:"/",domain:"."+location.hostname.split(".").slice(-2).join("."),expires:new Date("Fri, 31 Dec 2099 23:59:59 UTC"),secure:null},data:{},get:function(b,c){return b===a?_.isEmpty(this.data)?this.renew():this.data:this.data[b]?this.data[b]:c},set:function(a,b){return a&&b&&typeof a===h?(a=a.replace(/[^#$&+\^`|]/g,encodeURIComponent).replace(/\(/g,"%28").replace(/\)/g,"%29"),b=(b+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent),this.data[a]=b,this.update()):this},update:function(){var a="",b=[],c;return a=_.reduce(this.data,function(a,b,c){return a.push([c,b].join("=")),a},[]).join(":"),b.push([this.options.name,a].join("=")),this.options.path&&b.push(";path="+this.options.path),this.options.domain&&b.push(";domain="+this.options.domain),this.options.expires&&b.push(";expires="+this.options.expires.toUTCString()),this.options.secure&&b.push(";secure"),document.cookie=b.join(""),this},drop:function(a){return a&&this.data[a]?(delete this.data[a],this.update()):this},renew:function(){return this.data=d(d(document.cookie,null,this.options.name),":",null),this}}}(),LMDA.cookie&&LMDA.cookie.renew()}(),function(a,b){"use strict";function c(a){a=a||{},this.views={},this.defaults=this.defaults||{},this.o=_.extend({},this.defaults,a),Backbone.View.call(this,a)}_.extend(c.prototype,Backbone.View.prototype,{context:null,log:function(a,b,c){var d=c&&c.context||this.context;b=b||{},this.trigger(a,b),LMDA.Events.trigger(d+":"+a,b)},die:function(){return this}}),c.extend=Backbone.View.extend,LMDA.Views.BaseView=c}(window),LMDA.Models.SuggestData=Backbone.Model.extend({url:"/catalogsearch/suggest/",defaults:{searchStr:"",hints:[]},initialize:function(a){"1"==LMDA.experiments.UI3049_1&&(this.url="/catalogsearch/suggest_clusterized/"),this.on("change:searchStr",this.handleChanges)},handleChanges:function(){var a=this,b=this.get("searchStr");b.length>1?this.fetch({url:this.url+"?q="+encodeURIComponent(b)+"&l=7&s=y",error:function(){a.set("hints",[])}}):a.set("hints",[])},parse:function(a){return _.isEmpty(a.suggest)?{hints:{}}:"1"==LMDA.experiments.UI3049_1?{hints:a.suggest}:(LMDA.Events.trigger("suggest:open",{searchStr:this.get("searchStr"),list:a.suggest}),{hints:{ordinary:a.suggest}})}}),LMDA.Models.Product=Backbone.Model.extend({defaults:{sizes:"-some-size-"},initialize:function(){},mapSizes:function(a){var b=_.map(a,function(a){return $(a).find(".button__title").eq(0).text()}).join(";"),c=_.map(a.not(".button_disabled"),function(a){return $(a).find(".button__title").eq(0).text()}).join(";");this.set({sizes:b,avail_sizes:c},{silent:!0})},getShortSku:function(){return this.get("sku")},getLongSku:function(){return this.getShortSku()+this.get("sizes")}}),function(a,b,c,d){"use strict";LMDA.Models.SizeSystems=new(Backbone.Model.extend({defaults:{INT:{name:"Международный",abbr:"INT"},RUS:{name:"Российский",abbr:"RUS"},USA:{name:"Американский",abbr:"US"},UK:{name:"Британский",abbr:"UK"},IT:{name:"Итальянский",abbr:"IT"},FR:{name:"Французский",abbr:"FR"},GER:{name:"Немецкий",abbr:"GER"},EUR:{name:"Европейский",abbr:"EUR"},UKR:{name:"Украинский",abbr:"UKR"}},initialize:function(){}}))}(window,document,document.body),function(a,b,c,d){"use strict";LMDA.Models.Size=Backbone.Model.extend({idAttribute:"sku16",defaults:{sku:"",disabled:!1,selected:!1,size:"",size_system:"",size_system_name:"",size_system_abbr:"",brand_size:"",brand_size_system:"",brand_size_system_name:"",brand_size_system_abbr:""},initialize:function(){this.on({"change:size_system":function(a,b){this.updateSizeSystemInfo("size_system",b)},"change:brand_size_system":function(a,b){this.updateSizeSystemInfo("brand_size_system",b)}},this),this.set("size_system",LMDA.country.size),this.init()},init:function(){},updateSizeSystemInfo:function(a,b){var c=LMDA.Models.SizeSystems.get(b);this.set(a+"_name",c?c.name:b),this.set(a+"_abbr",c?c.abbr:b)}})}(window,document,document.body),function(a,b,c,d){"use strict";LMDA.Models.SizeChooser=LMDA.Models.Size.extend({idAttribute:"",defaults:{title:"",title_css_modirier:"",type:"",size_table_link:"",selected_sku:"",items:[],size_system:"",size_system_name:"",size_system_abbr:"",brand_size_system:"",brand_size_system_name:"",brand_size_system_abbr:"",active_size_system:""},init:function(){this.set("active_size_system",LMDA.country.size,{silent:!0})}})}(window,document,document.body),LMDA.Collections.LastViewed=Backbone.Collection.extend({model:Backbone.Model.extend({idAttribute:"sku"}),initialize:function(a){this._ready=!1,this._currentSKU="",a=a||{},LMDA.localStorage.getItemCrossDomain("viewsHistory",_.bind(function(b){this.set(b),this._ready=!0,this.length>20&&this.reset(this.first(20)),a.onReady&&a.onReady.apply(this),this.trigger("ready")},this))},addItem:function(a){Backbone.Collection.prototype.remove.apply(this,arguments),Backbone.Collection.prototype.unshift.apply(this,arguments),this._currentSKU=a.sku,LMDA.localStorage.setItemCrossDomain("lastviewed",this.toJSON())},getItemsForRender:function(){return this.filter(function(a){return this._currentSKU!==a.id},this)}}),function(a,b,c,d){"use strict";LMDA.Collections.Sizes=Backbone.Collection.extend({model:LMDA.Models.Size,initialize:function(){},flush:function(){this.remove(this.models)}})}(window,document,document.body),function(){LMDA.Templates.Controls.Select=function(a){var b=_.template(['<div class="widget__control select" data-form-control="<%= name %>">','<input type="hidden" name="<%= name %>" value=""/>','<span class="button">','<span class="button__title"></span>',"</span>",'<ul class="dropdown"></ul>',"</div>"].join(""));return function(a){var c={};return _.extend(c,{name:""},a),b(c)}}()}(),function(){LMDA.Templates.Controls.SizeButton=function(a){var b=_.template(['<span class="button<% if (disabled) { %> button_disabled<% } %>" data-sku="<%= sku %>">',"<% if (size_system !== brand_size_system) { %>",'<div class="hint size-chooser__hint">','<span class="size-chooser__hint-base"><%= size_system_name %> размер: <%= size %> <%= size_system_abbr %></span>','<span class="size-chooser__hint-brand">Размер производителя: <%= brand_size %> <%= brand_size_system_abbr %></span>',"</div>","<% } %>",'<span class="button__title size-chooser__size-base" data-size-system="<%= size_system %>"><%= size %></span>','<span class="button__title size-chooser__size-brand" data-size-system="<%= brand_size_system %>"><%= brand_size %></span>','<div class="hint size-chooser__error"></div>',"</span>"].join(""));return function(a){var c={};return _.extend(c,{sku:"",disabled:!1,size:"",size_system:"",size_system_name:"",size_system_abbr:"",brand_size:"",brand_size_system:"",brand_size_system_abbr:""},a),b(c)}}()}(),function(){LMDA.Templates.SizeChooser=function(){var a=_.template(['<div class="size-chooser<% if (css_modifier) { %> <%= css_modifier %><% } %>">','<div class="size-chooser__title<% if (title_css_modifier) { %> <%= title_css_modifier %><% } %><% if (!title) { %> hidden<% } %>"><%= title %></div>','<div class="size-chooser__help">','<div class="size-chooser__system">','<div class="size-chooser__system-select" data-form-widget="sizesystem">','<% LMDA.Templates.Controls.Select({"name": "sizesystem"}) %>',"</div>",'<div class="size-chooser__system-single">',"Размер: <%= size_system_name %> (<%= size_system %>)","</div>","</div>",'<a data-link="/about/guides/" class="size-chooser__table-link" target="_blank">Таблица размеров</a>',"</div>",'<div class="size-chooser__list"></div>',"</div>"].join(""));return function(b){var c={};return _.extend(c,{css_modifier:"",title:"",title_css_modifier:"",size_system:"",size_system_name:""},b),a(c)}}()}(),function(){LMDA.Templates.CartPopupItem=function(){var a=_.template(['<div class="cart-itemii cart-item<% if (css_modifier) { %> <%= css_modifier %><% } %><% if (!is_in_stock || is_not_sellable) { %> cart-item_out<% } %>" data-sku="<%= sku %>" data-sku16="<%= full_sku %>" data-stock="<% if (last < 4) { %><%= last %><% } else { %>+<% } %>"<% if (last == 1) { %> data-laststock="1"<% } else if (last == 2 || last == 3) { %> data-23stock="1"<% } %>>','<a href="<%= url %>" class="cart-item__cell cart-item__cell_photo" data-popup-close="" data-quick="<%= sku %>" data-quick-type="cart">','<img src="<%= img %>" class="cart-item__photo<% if (img_size) { %> cart-item__photo_<%= img_size %><% } %>">',"</a>",'<div class="cart-item__cell cart-item__cell_description">','<div class="cart-item__name">',"<%= title %> <b><%= brand %></b>","</div>",'<% if (size !== "unisize") { %>','<div class="cart-item__size">',"<% if (!size_system || brand_size_system == size_system) { %>","Размер: <%= size %>","<% } else { %>","Размер производителя: <%= brand_size %> (<%= brand_size_system %>)","<br>","Соответствует: <%= size %> (<%= size_system %>)","<% } %>","</div>","<% } %>","<% if (!is_gift) { %>",'<div class="cart-item__extra-info">','<span class="product-stock product-stock_wrapper">',"<% if (!is_in_stock) { %>","нет в наличии","<% } else if (last != 0 && last < 4) { %>",'<span class="product-stock__left">',"Осталось в наличии: ",'<span class="product-stock__left-amount"><%= last %></span>',"</span>","<% } %>","</span>","</div>","<% } %>","</div>",'<div class="cart-item__cell cart-item__cell_total">','<div class="cart-item__price"><% if (original_price) { %> <span class="cart-item__old-price"><%= original_price %></span><% } %>',"<% if (!original_price) { %>","<%= price %>","<% } else { %>",'<span class="cart-item__new-price">',"<%= price %>","</span>","<% } %>","</div>","<% if (!is_gift && last == 1) { %>",'<div class="cart-item__last-stock">','<div class="cart-item__last-stock-text">Последний</div>','<div class="cart-item__last-stock-corner"/>',"</div>","<% } %>","<% if (is_in_stock) { %>",'<div class="cart-item__cell_number"><%= quantity %> шт.</div>',"<% } %>","</div>","</div>"].join(""));return function(b){var c={};return _.extend(c,{sku:"",img_size:"",css_modifier:"",full_sku:"",title:"",brand:"",last:0,is_in_stock:!1,quantity:0,brand_size_system:"",brand_size:"",size_system:LMDA.sizeSystem,size:"",is_not_sellable:!1,is_gift:!1,product_url:"",category_url:"",price:0,original_price:0,sum:0},b),a(c)}}()}(),function(){LMDA.Templates.PostCartAddPopup=function(){var a=_.template(['<div class="post-cart-add__header">','<div class="h2 post-cart-add__title">Товар добавлен в корзину</div>','<div class="post-cart-add__cart-info">','Всего в вашей корзине <%= quantity_string %>. <a class="link post-cart-add__view-cart" data-link="/checkout/cart/">Просмотреть</a>',"</div>","</div>",'<div class="post-cart-add__cart js-popup__adapt-height" data-min-height-for-popup="186" data-scroll-padding-for-popup="0px">',"<%= items_list %>","</div>",'<div class="post-cart-add__footer">','<span class="button button_outline link post-cart-add__close" data-popup-close="">Продолжить покупки</span>','<a class="button button_blue button_big post-cart-add__basket" href="/checkout/cart/?add=<%= sku %>&popup=y">',"Оформить заказ","</a>","</div>"].join(""));return function(b){var c={};return _.extend(c,{sku:"",quantity_string:"",items_list:""},b),a(c)}}()}(),LMDA.Templates.PostCartUpsellingBlock=_.template('    <div class="post-cart-add__animation-wrapper">        <div class="post-cart-add__cart-attention">            <div class="post-cart-add__in-stock-title">Рекомендуем приобрести</div>        </div>        <div class="cart-item_added">            <div class="cart-item">                <a href="<%= url %>" class="cart-item__cell cart-item__cell_photo">                    <img class="cart-item__photo cart-item__photo_small" src="<%= image %>">                </a>                <div class="cart-item__cell cart-item__cell_description">                    <div class="cart-item__name cart-item__name_upselling"><%= name %> <b><%= brand %></b></div>                    <div class="button button_blue js-button-upselling-buy" data-sku="<%= sku %>">                        <span class="button__progress"></span>                        Добавить в корзину                    </div>                </div>                <div class="cart-item__cell cart-item__cell_total">                    <div class="cart-item__price"><%= price %></div>                </div>            </div>        </div>    </div>'),LMDA.Templates.PostCartCharityUpsellingVars=function(a,b){function c(a,b){return a.value+" "+("ua"===b?"UKR":"RUS")}function d(a){return a.brand_size+" "+j}function e(a,b){var e="",f=c(a);return e+=1===b?"<b>"+f+"</b>":f,e+" "+d(a)}function f(a){a=a||{};var b=a.sizes||[],e="";return e+='data-notify-options="[',_.each(b,function(a,f){e+="[",e+=(a.is_available?"true":"false")+", ",e+=a.sku+", ",e+=c(a)+", ",e+=d(a),e+="]",e+=f!==b.length-1?", ":""}),e+=']" ',e+='data-full-skull="'+(a.no_size||"")+'"'}function g(a,b){return['<div class="ii-select__option',a.is_available?"":" ii-select__option_disabled",a.is_last?' ii-select__option_last"':'"',' data-value="'+a.sku+'" data-display="'+e(a)+'"',"value"===b?' data-bss="'+d(a)+'"':"","brand_size"===b?' data-nss="'+c(a)+'"':"",">","value"===b?c(a):"","brand_size"===b?d(a):"","</div>"].join("")}var h=a&&a.sizes;if(!h||0===h.length)return{};var i=b||"ru",j=a.brand_size_system||"",k=a.no_size||a.last_available_sku||"",l="RUS"===j?1:"";return{COUNTRY:i,presettedValue:k,ctxIsOnlyColumn:l,getSizeNative:c,getSizeBrand:d,getSizeAll:e,getNotifyOptions:f,fakeSelect:g}};var dropdownSizesTemplate=["<% function product__select_notes (sizes) { %>","<% var sizes = sizes || [] %>","<% if (COUNTRY === 'ru') { %>",'<div class="ii-select__note js-widget-fitanalytics" title="Узнайте, какой размер вам подойдет" data-dict-filled="Вам подойдет {size}" data-dict-empty="Как выбрать размер">','<span class="ii-select__note-icon">','<i class="i_ruler"></i>',"</span>",'<span class="ii-select__note-text">Как выбрать размер</span>',"</div>",'<div class="ii-select__note js-sizetable" title="Узнайте, какой размер вам подойдет">','<span class="ii-select__note-icon">','<i class="i_ruler"></i>',"</span>",'<span class="ii-select__note-text">Как выбрать размер</span>',"</div>","<% } else { %>",'<a class="ii-select__note js-sizetable" target="_blank" title="Узнайте, какой размер вам подойдет">','<span class="ii-select__note-icon">','<i class="i_ruler"></i>',"</span>",'<span class="ii-select__note-text">Таблица размеров</span>',"</a>","<% } %>","<% if (_.find(sizes, { is_available: false })) { %>",'<div class="ii-select__note js-widget-notify" title="При поступлении товара на склад, вам будет отправлено письмо" <% print(getNotifyOptions(sizes)) %> >','<span class="ii-select__note-icon">','<i class="i_notify"></i>',"</span>",'<span class="ii-select__note-text">Уведомить о поступлении товара</span>',"</div>","<% } %>","<% } %>",'<div class="product__sizes-select-container">','<div class="ii-select product__sizes-select-fake<% if (presettedValue) { %>ii-select_selected<% } %>">','<div class="ii-select__wrapper">',"<!-- value -->",'<div class="ii-select__value">',"<% if (presettedValue) { %>","<% _.each(product.sizes, function (size) { %>","<% if (size.is_available) { %>","<% print(getSizeAll(size, 1)) %>","<% } %>","<% }) %>","<% } else { %>","Выберите размер","<% } %>","</div>","<!-- is last badge -->",'<div class="ii-select__badge">Последний</div>',"<!-- options -->",'<div class="ii-select__dropdown">','<div class="ii-select__options">','<div class="<% if (ctxIsOnlyColumn) {%>',"ii-select__columns ii-select__columns_single","<% } else { %>",'ii-select__columns <% } %> ">','<div class="ii-select__column ii-select__column_native">','<div class="ii-select__label">',"<% if (COUNTRY === 'ua') { %>Украинский размер<% } else { %>Российский размер<% } %>","</div>","<% _.each(product.sizes, function (size) {%>","<% print(fakeSelect(size, 'brand_size')) %>","<% }) %>","</div>","<!-- Hide column, if brand_size and native size equal -->","<% if (!ctxIsOnlyColumn) { %>",'<div class="ii-select__column">','<div class="ii-select__label">Размер производителя</div>',"<% _.each(product.sizes, function (size) {%>","<% print(fakeSelect(size, 'brand_size')) %>","<% }) %>","</div>","<% } %>","</div>","</div>","<!-- footer -->",'<div class="ii-select__notes">',"<% product__select_notes(product.sizes) %>","</div>","</div>","</div>","</div>","</div>"].join("");
LMDA.Templates.PostCartCharityUpselling=_.template(['<div class="post-cart-add__recommended_wrapper <% if (isCharity) { %>charity<% }%>">','<div class="post-cart-add__cart-attention">','<div class="post-cart-add__in-stock-title">',"<% if (!isCharity) {%>","Рекомендуем приобрести","<%} else {%>",'<div class="post-cart-add__charity_header popup__charity"></div>','<div class="post-cart-add__charity_header_titles post-cart-add__big">',"Купите, чтобы помочь детям","</div>",'<div class="post-cart-add__charity_header_titles post-cart-add__small">','<a class="inline-link" target="_blank" href="/charity">',"Описание программы","</a>","</div>",'<div class="clearfix"></div>',"<%}%>","</div>",'<div class="clearfix"></div>',"</div>",'<div class="cart-itemii cart-item">','<a href="<%= url %>" class="cart-item__cell cart-item__cell_photo">','<img class="cart-item__photo cart-item__photo_small" src="<%= img %>">',"</a>",'<div class="cart-item__cell cart-item__cell_description">','<div class="cart-item__name cart-item__name_upselling"><%= title %> <b><%= brand %></b>',"<% if (product.sizes.length > 0) {%>",dropdownSizesTemplate,"<%}%>","</div>","</div>",'<div class="cart-item__cell cart-item__cell_total">','<div class="cart-item__price"><%= price %></div>','<div data-sku="<%= sku %>" class="button button_blue post-cart-add__basket">',"Добавить в корзину","</div>",'<div class="hidden button button_green button_disabled post-cart-add__basket post-cart-add__added">','<div class="post-cart-add_daw"></div>В корзине',"</div>","</div>","</div>","</div>"].join("")),LMDA.mixins.CaptchaMixin=function(){function a(b){var c=jQuery.Deferred();return(a=function(a){return a&&c.resolve(a),c.promise()})(b)}var b="captchaNotRequired",c=!1,d="onCaptchaLoaded";return window[d]=function(){a(!0)},{CAPTCHA_ERROR:"Защита не пройдена",CAPTCHA_EXPIRED:"Пройдите защиту снова",captchaInitialize:function(){this.apixRequest()},apixRequest:function(e){var f=this;(e||!this.isRequestedOnce)&&$.getJSON("/apix/captcha/?action="+this.apixAction).then(function(e,g,h){return e&&e.sitekey?(f.isRequestedOnce=!0,f.captchaSiteKey=e.sitekey,c||(c=$.getScript("https://www.google.com/recaptcha/api.js?hl=ru&render=explicit&onload="+d)),c.then(_.bind(f.captchaReport,f,"loaded"),_.bind(f.captchaReport,f,"failed")),c.then(a())):$.Deferred().resolve(b)}).then(function(a,c,d){a==b?f.trigger(b):f.captchaID>-1||f.renderCaptcha()},function(a,b,c){})},whenCaptchaRendered:function(a){var b=jQuery.Deferred();return(this.whenCaptchaRendered=function(a){return a&&b.resolve(a),b.promise()})(a)},renderCaptcha:function(){this.captchaSiteKey&&(this.captchaReport("show"),this.captchaID=window.grecaptcha.render(this.recaptchaElementId,{size:this.isCompactCaptcha?"compact":"normal",theme:this.isDarkCaptcha?"dark":"light",sitekey:this.captchaSiteKey,callback:_.bind(this.captchaComplete,this),"expired-callback":_.bind(this.captchaExpired,this)}),this.whenCaptchaRendered(!0))},captchaReset:function(){this.captchaID>-1&&window.grecaptcha.reset(this.captchaID)},captchaComplete:function(){this.captchaReport("complete"),this.trigger("captchaComplete",this.recaptchaElementId)},captchaExpired:function(){this.captchaReport("expired"),this.trigger("captchaExpired",this.recaptchaElementId)},captchaReport:function(a){LMDA.Statistics.report("captcha",a,{place:this.apixAction})}}}(),function(a,b,c){"use strict";LMDA.Views.PageView=LMDA.Views.BaseView.extend({el:"body",context:"page",pageEvents:{"mousedown .button":"buttonActiveIn","mousedown .checkbox":"checkboxActiveIn",mouseup:"controlActiveOut","click [data-quick]":"openQuickViewLink","mouseover a[data-link]":"_showLink","mouseover area[data-link]":"_showLink","click a[data-link]":"_showLink","click area[data-link]":"_showLink","mouseover .js-user-nav":"_renderUserMenu","click .js-venture-link":"goToVenture",click:"bodyClick",touchstart:"bodyTouch"},additionalEvents:{"click .midget__link":function(a){var b=$(a.currentTarget),c="rec_click";LMDA.z(c,{sku:b.data("sku"),pos:b.parents(".slider__list").find(".midget__link").index(b),source:LMDA.pageData.section})}},events:function(){return _.extend({},this.pageEvents,this.additionalEvents)},initialize:function(){var a=this;if(this.activeControl={$el:0,"class":""},this.activeDropdown={$el:0,"class":"button-dropdown_open"},this.dropdownPressed=!1,this.views={},this.pageData=LMDA.pageData||{},this.$el.removeClass("not-touch").addClass(LMDA.isTouch?"touch":"not-touch"),this.quickViewPageSource="",this.$outletSlider=this.$(".js-outlet-slider"),this.$outletIconsSlider=this.$(".js-outlet-icons-slider"),this.init(),this.initGlobalViews(),this.initPageViews(),this.$el.addClass(LMDA.user&&LMDA.user.isLogon?"user-authorized":"user-unauthorized"),LMDA.$window.on("keydown",function(a){LMDA.Events.trigger("window:keydown",a.keyCode)}),LMDA.Events.on("dropdown:outside-toggle",function(){this.activeDropdown.$el.removeClass(this.activeDropdown["class"]),this.activeDropdown.$el=0},this),this.zData=this.zData||{},this.zDataMultifilters&&(this.zData.filters=this.zDataMultifilters()),this.zData.screen_resolution=screen.width+","+screen.height,this.zData.viewport_size=$(window).width()+","+$(window).height(),LMDA.user&&LMDA.user.id&&(this.zData.customer_id=LMDA.user.id),LMDA.pageData&&"cart"===LMDA.pageData.section&&document.forms.checkout){var b=LMDA.pageData.sellers;this.zData.mp_crossborder=_.reduce(LMDA.pageData.products,function(a,c){return a[b[c.sellerId].isCrossborder]++,a},[0,0]).join(";"),this.zData.type="checkout_page",this.zData.interface=document.forms.checkout.getAttribute("data-type")}LMDA.Statistics.report("page","view",this.zData),function(b){var c={};a.$el.on("mouseover.Rollover",b.selItem,function(a){var d=$(a.currentTarget).find(b.selImage);if(d.length&&d.attr(b.attrRollover)){var e=$(a.target).closest("[data-sku]").attr("data-sku");c[e]||(c[e]=!0,LMDA.Statistics.report("catalogItem","rolloverSwitch",{sku:e})),d.attr("src",d.attr(b.attrRollover))}}).on("mouseout.Rollover",b.selItem,function(a){var c=$(a.currentTarget).find(b.selImage);c.length&&c.attr(b.dataSrc)&&c.attr("src",c.attr(b.dataSrc))})}({selItem:".products-list-item",selImage:".products-list-item__img",attrRollover:"src-rollover",dataSrc:"data-src"}),this.$outletSlider.length&&this.initOutletSlider(),this.$outletIconsSlider.length&&this.initOutletIconsSlider(),this.listenTo(LMDA.Events,LMDA.Events.SCREEN_CHANGE,function(){_.delay(a.reinitSlick,500)})},init:function(){},initGlobalViews:function(){var a=this.views,b=this;a.menu=new(LMDA.isTouch?LMDA.Views.MenuTouch:LMDA.Views.Menu),LMDA.isTouch&&(a.smartbanner=new LMDA.Views.SmartBanner),a.search=new LMDA.Views.Search({el:this.$(".js-search")}),a.sizeChooserDropdown=new LMDA.Views.SizeChooserDropdown,this.$el.append(a.sizeChooserDropdown.$el),a.addToWishList=new LMDA.Views.AddToWishlist,a.headerUser=new LMDA.Views.HeaderUser,LMDA.user&&!LMDA.user.isLogon&&(a.authPopup=new LMDA.Views.AuthPopup,LMDA.Events.on(LMDA.Events.OPEN_AUTH_FORM,function(){a.authPopup.open()})),require(["ii/page/page"],function(){LMDA.DATA.page&&LMDA.DATA.page.get("type").toString().indexOf("cart:")<0&&(b.views.postCartAdd=new LMDA.Views.PostCartAdd,_.extend(LMDA.Views.PostCartAdd.prototype,LMDA.mixins.Upselling))}),this.$(".overlay-popup")&&(a.marketingOverlay=new LMDA.Views.MarketingPopup),this.$headerFeedback=this.$(".header__feedback-menu"),this.$headerFeedback.length&&(this.views.headerFeedback=new LMDA.Views.HeaderFeedback({el:this.$headerFeedback})),this.$(".js-ibanner-video-popup").length&&this.videoPopupBanners(),this.$(".js-ibanner-copy-code").length&&this.initPromoCodeCopy(),this.initSplitDesignViews(),LMDA.Views.Breadcrumbs&&(this.views.breadcrumbs=new LMDA.Views.Breadcrumbs),this.initAutoGender()},initPageViews:function(){},reinitSlick:function(){$(".js-outlet-slider .outlet-gallery-item").length<=3&&$(".js-outlet-slider").slick("reinit")},buttonActiveIn:function(a){this.activeControl.$el=$(a.currentTarget),this.activeControl["class"]="button_active",this.activeControl.$el.addClass("button_active")},checkboxActiveIn:function(a){this.activeControl.$el=$(a.currentTarget),this.activeControl["class"]="checkbox_active",this.activeControl.$el.addClass("checkbox_active")},controlActiveOut:function(){this.activeControl.$el&&(this.activeControl.$el.removeClass(this.activeControl["class"]),this.activeControl.$el=0)},openQuickViewLink:function(a){if(!(a.shiftKey||a.ctrlKey||a.metaKey||2===a.which)){var b=$(a.target).closest(d.join(","));b=b.length>0?_(d).findIndex(function(a){return b.hasClass(a.slice(1))})+1:LMDA.Views.PageView.QUICKVIEW_OPENER_TYPES.DEFAULT,a.preventDefault(),this.openQuickView($(a.currentTarget).data("quick"),{type:$(a.currentTarget).data("quick-type")||"",source:this.quickViewPageSource||"",openerTypeIndex:b})}},openQuickView:function(a,b){require(["ii/product/views/quick"],function(c){c.show(a,b)})},USER_MENU:{history:{link:"/sales/order/history/",text:"Мои заказы",show:!0},edit:{link:"/customer/account/",text:"Мои данные",show:!0},subscriptions:{link:"/customer/account/subscriptions/",text:"Подписки",show:!0},loyalty_program:{link:"/customer/account/loyalty_program/",text:"Lamoda<br/>Friends&Family",show:!0},logout:{link:"/customer/account/logout/",text:"Выйти",show:!0}},_renderUserMenu:_.once(function(a){$(a.currentTarget).append('<ul class="dropdown">'+_.reduce(this.USER_MENU,function(a,b){return a+(b.show?'<li class="dropdown__item"><a class="link dropdown__link" data-link="'+b.link+'">'+b.text+"</a></li>":"")},"",this)+"</ul>")},this),_toggleDropdown:function(a){var b=$(a.target),c,d,e,f=!1;this.dropdownPressed=!0,b.closest(".dropdown").length||(c=$(a.currentTarget),d=c.data("dropdown"),c.hasClass(this.activeDropdown["class"])?(c.removeClass(this.activeDropdown["class"]),this.activeDropdown.$el=0):(c.addClass(this.activeDropdown["class"]),this.activeDropdown.$el&&(e=this.activeDropdown.$el.data("dropdown"),this.activeDropdown.$el.removeClass(this.activeDropdown["class"]),e&&LMDA.Events.trigger("dropdown:toggle",{name:e,toggle:!1})),this.activeDropdown.$el=c,f=!0),d&&LMDA.Events.trigger("dropdown:toggle",{name:d,toggle:f}))},bodyClick:function(a){var b;this.dropdownPressed?this.dropdownPressed=!1:this.activeDropdown.$el&&!$(a.target).closest(this.activeDropdown.$el).length&&(b=this.activeDropdown.$el.data("dropdown"),this.activeDropdown.$el.removeClass(this.activeDropdown["class"]),this.activeDropdown.$el=0,b&&LMDA.Events.trigger("dropdown:toggle",{name:b,toggle:!1})),LMDA.Events.trigger("body:click",a)},bodyTouch:function(a){LMDA.Events.trigger("body:tap",a)},_showLink:function(a){var b=$(a.currentTarget);b.attr("href",b.data("link")+""),b.removeAttr("data-link")},goToVenture:function(a){window.open("http://www."+$(a.currentTarget).attr("data-name")+"."+LMDA.DATA.site.get("locale"),"_blank")},getPageScroll:function(){var a=document.documentElement;return(window.pageYOffset||a.scrollTop)-(a.clientTop||0)},initMarketingParts:function(a){},videoPopupBanners:function(){$(".js-ibanner-video-popup").on("click",function(a){a.preventDefault();var b=new LMDA.Views.Popup({el:'<div class="popup hidden js-video-popup"><div class="popup__inner"><span class="popup__close" data-popup-close=""></span><div class="popup__content" style="width: 800px;height: 450px;"></div></div></div>'}),c=$(a.target).data("video-link");b.on("close",function(){return b.$el.remove(),!1}),b.$(".popup__content").html('<iframe width="100%" height="100%" src="https://www.youtube.com/embed/'+c+'?rel=0" frameborder="0" allowfullscreen></iframe>'),$("body").append(b.$el),b.open()})},initPromoCodeCopy:function(){require(["libs/zeroclipboard/2.2.0/zeroclipboard.min"],function(a){a.isFlashUnusable()||(a.config({swfPath:"http://www.lamoda.ru/files/dc-banners/flash/ZeroClipboard2.swf"}),_.each($(".js-ibanner-copy-code"),function(b){var c=b.querySelector(".js-ibanner-promo-button"),d=b.querySelector(".js-promo-code").innerHTML,e=b.querySelector(".js-hint"),f=e.innerHTML,g=new a(c);$(c).removeClass("promo-button_flash-disabled"),g.on("ready",function(){g.on("copy",function(a){a.clipboardData.setData("text/plain",d),e.innerHTML="Код скопирован",c.onmouseout=function(){e.innerHTML=f}})}),g.on("error",function(){a.destroy()})}))})},initAutoGender:function(){var a=LMDA.apix&&LMDA.apix.prism&&LMDA.apix.prism.lidinfo&&LMDA.apix.prism.lidinfo.gender?LMDA.apix.prism.lidinfo.gender:"",b=LMDA.cookie.get("headerLastGender"),c=LMDA.user&&LMDA.user.gender?LMDA.user.gender:"";"women"==b?a="w":"men"==b&&(a="m"),"F"==c?a="w":"M"==c&&(a="m"),a&&LMDA.cookie.set("autoGender",a)},initSplitDesignViews:function(){var a=this;this.views.seoMenu=new LMDA.Views.SeoMenu;var b=$(".usp_top");b.length&&b.one("click.usp",".usp__close",function(){LMDA.cookie.set("uspTopHidden",(new Date).getTime()),b.remove(),LMDA.Events.trigger("usp:close")});var c=$(".subscription_ii-top");c.length&&(this.views.subscriptionTop=new LMDA.Views.Subscription({el:c})),function(b){var c=a.$el.find(b.sel.genderTrigger);c.length&&c.on(b.evt.click,function(a){LMDA.cookie.set(b.cookie.lastGender,$(this).data(b.data.gender))})}({evt:LMDA.Utils.getEventsNamesMap("header"),sel:{genderTrigger:".gender-menu .link"},cookie:{lastGender:"headerLastGender"},data:{gender:"genders"}}),$(".footer__sticky-action-button").on("click.Statistics",function(){LMDA.Statistics.report("footerActions","click",{})})},initOutletSlider:function(){this.$outletSlider.html().trim()&&(this.$(".js-width-wrapper-breadcrumb").wrap('<div class="width-wrapper-outlet width-wrapper-outlet_breadcrumb"></div>'),this.$(".js-width-wrapper-banner-catalog").wrap('<div class="width-wrapper-outlet width-wrapper-outlet_banner-slider"></div>'),this.$outletSlider.removeClass("hidden").slick({arrows:!0,dots:!0,infinite:!0,speed:300,slidesToShow:3,slidesToScroll:3,centerMode:!1,autoplay:!0,autoplaySpeed:4e3,variableWidth:!1}).on("beforeChange",function(a,b,c,d,e){LMDA.Statistics.report("outlet_slider","scroll",{line:"auto"===e?"banners_auto":"banners"})}))},initOutletIconsSlider:function(){this.$outletIconsSlider.html().trim()&&(this.$outletIconsSlider.parent().removeClass("hidden"),this.$outletIconsSlider.slick({dots:!1,infinite:!0,speed:300,slidesToShow:7,slidesToScroll:2,centerMode:!1}).on("beforeChange",function(a,b,c,d){LMDA.Statistics.report("outlet_slider","scroll",{line:"categories"})}))}});var d=[".ii-product__lastviewed",".ii-product__recommendations",".ii-product__colors",".js-recomendation",".products-list-item__qv",".some_never_existing_class_name_DEFAULT",".post-cart-add",".ii-cart"];LMDA.Views.PageView.QUICKVIEW_OPENER_TYPES=_.reduce(["LASTVIEWED","PP_RECOMMENDATIONS","RECOMMENDATIONS","COLORS","CATALOG_QV","DEFAULT","POPUP","CART"],function(a,b,c){return a[b]=c+1,a},{})}(window,document),function(a,b,c){"use strict";var d={email:{type:LMDA.Forms.Types.EMAIL,required:!0,max:255,errorMessages:{type:"Пожалуйста, введите действительный адрес электронной почты. Например, johndoe@domain.com",required:"Поле электронной почты обязательно для заполнения",max:"Максимальная длина поля 255 символов"}},checkbox:{type:LMDA.Forms.Types.CHECKBOX},radio:{type:LMDA.Forms.Types.RADIO_GROUP},radioButtons:{type:LMDA.Forms.Types.TEXT}},e={footer:[{type:"email",name:"email"},{type:"radio",name:"gender"}],"catalog-sidebar":[{type:"email",name:"email"},{type:"checkbox",name:"filters"}],standalone:[{type:"email",name:"email"},{type:"radioButtons",name:"gender"}],overlay:[{type:"email",name:"email"},{type:"radioButtons",name:"gender"}]};LMDA.Views.Subscription=LMDA.Views.BaseView.extend({el:null,context:"subscription",initialize:function(){if(this.$el.length){var a=this,b={selDescription:".subscription__description",selForm:".subscription__form",selMessages:".subscription__messages",selMessageDone:".subscription__message-done",selMessageFail:".subscription__message-fail",selTitle:".subscription__title"};if(this.options=_.extend(b,this.options),this.$description=this.$el.find(this.options.selDescription),this.$form=this.$el.find(this.options.selForm),this.$messages=this.$el.find(this.options.selMessages).hide(),this.$messageDone=this.$el.find(this.options.selMessageDone).hide(),this.$messageFail=this.$el.find(this.options.selMessageFail).hide(),this.$title=this.$el.find(this.options.selTitle),!this.$form.length)return!1;this.isDisabled=!1,this.preset=this.$form.data("preset"),this.location=this.$form.data("location"),this.context+=":"+this.location,this.formConfig={el:this.$form,mustValidate:!0,widgets:{}},_.each(e[this.preset],function(b){a.formConfig.widgets[b.name]=d[b.type]}),this.form=new LMDA.Forms.FormView(this.formConfig);var c=this.form.getAllWidgets(),f=c.gender,g=c.email;g&&g.set(LMDA.DATA.user.get("email")),f&&(f.set(LMDA.DATA.user.get("gender")),f.type&&"text"===f.type&&f.$el.on("click.Subscription","[data-gender]",function(a){f.set($(this).data("gender")),LMDA.cookie.get("autoGender")||LMDA.cookie.set("autoGender",$(this).data("gender").toLowerCase().replace("f","w"))})),this.$submit=this.form.$el.find('[type="submit"]'),this.form.on("submit",function(){a.onFormSubmit.apply(a,arguments)})}},onFormSubmit:function(a,b){if(b.preventDefault(),this.isDisabled||!this.form.isValid())return!1;var c=this,d=this.form.serialize();if(d.location=this.location,d.filters){var e=[window.location.pathname];LMDA.page&&LMDA.page.getCatalogRequestParams&&e.push("?",$.param(LMDA.page.getCatalogRequestParams())),d.url=e.join("")}this.$messages.hide(),this.disable(),$.when(LMDA.API.subscribe.newsletter(d,{source:"overlay"})).done(function(){c.enable(),(c.options.done||c.onDone).apply(c,arguments)}).fail(function(){c.enable(),(c.options.fail||c.onFail).apply(c,arguments)})},onDone:function(a){this.$title.hide(),this.$description.hide(),this.$form.hide(),this.$messages.show(),this.$messageFail.hide().html(""),this.$messageDone.html(a.message).show()},onFail:function(a){this.$title.hide(),this.$description.hide(),this.$form.hide(),this.$messages.show(),this.$messageDone.hide().html(""),this.$messageFail.html(a.message).show()},disable:function(){this.isDisabled=!0,this.$submit.addClass("button_disabled"),this.preloader=this.preloader||new LMDA.Utils.ButtonPreloader(this.$submit),this.preloader.start()},enable:function(){this.isDisabled=!1,this.preloader&&(this.$submit.removeClass("button_disabled"),this.preloader.stop())}}),LMDA.Views.SubscriptionPopup=LMDA.Views.BaseView.extend({el:null,context:"subscriptionPopup",initialize:function(){if(!this.$el.length)return!1;if(this.$trigger=this.options.$trigger,!this.$trigger.length)return!1;var a=this,b={up:"subscription_visible animated animated__fadeInUp",down:"subscription_visible animated animated__fadeInDown"};this.cnVisible=this.options.cnVisible||b[this.options.direction]||b.down,new LMDA.Views.Subscription({el:this.$el}),this.$el.on("click.SubscriptionPopup",this.stopPropagation),this.$trigger.on("click.SubscriptionPopup",function(b){a.stopPropagation(b),a.toggle.apply(a,arguments)}),this.hide()},stopPropagation:function(a){a&&a.stopPropagation()},toggle:function(){return this.$el.hasClass(this.cnVisible)?this.hide():this.show()},show:function(){var a=this;this.$el.addClass(this.cnVisible),LMDA.$window.on("click.SubscriptionPopup",function(){a.hide()}),this.trigger("show",this)},hide:function(){this.$el.removeClass(this.cnVisible),LMDA.$window.off("click.SubscriptionPopup"),this.trigger("hide",this)}})}(window,document),function(){LMDA.Views.HeaderFeedback=LMDA.Views.BaseView.extend({context:"header_feedback",events:{"click .js-header-ask-question":"_openHelpPopup","click .link":"_close"},initialize:function(){},_openHelpPopup:function(a){a.preventDefault(),LMDA.Events.trigger("header:ask-question")},_close:function(){LMDA.Events.trigger("dropdown:outside-toggle")}})}(),function(a,b,c,d){"use strict";LMDA.Views.HeaderUser=LMDA.Views.BaseView.extend({el:".user-nav",context:"header",events:{"click .js-auth-button":"_openAuthPopup"},initialize:function(){this._initDOM(),LMDA.DATA.user.on("change:isLoggedIn",this.updateView,this),LMDA.Events.on(LMDA.Events.CART_ADD,this.updateBasket,this)},_initDOM:function(){this.$basketTitle=this.$(".js-basket-button-title"),this.$userNav=this.$(".js-user-nav"),this.$userNav.on("click.Statistics",function(a){LMDA.Statistics.report("headerUserProfile","show")}),this.$userNav.on("click.Statistics",".dropdown__link",function(a){LMDA.Statistics.report("headerUserProfile","click",{href:$(this).attr("href")})})},_openAuthPopup:function(){LMDA.Events.trigger(LMDA.Events.OPEN_AUTH_FORM,{place:"topbar"})},updateView:function(){LMDA.DATA.user.get("isLoggedIn")&&(this.$el.addClass("user-nav_signed"),this.$userNav.removeClass("hidden"),this.$(".user-nav__link_wishlist").removeClass("hidden"),this.$(".js-auth-button").addClass("hidden"),this.updateBasket({cart:{quantity:LMDA.DATA.user.get("cartItemsCount"),total:LMDA.DATA.user.get("cartTotal")}}))},updateBasket:function(a){var b;parseInt(a.cart.quantity)?(b=a.cart.quantity+" "+LMDA.Utils.pluralize(a.cart.quantity,"товар","товара","товаров")+" в корзине",this.$basketTitle.removeClass("user-nav__link_cart"),this.$basketTitle.addClass("user-nav__link_cart-not-empty")):(b="Корзина",this.$basketTitle.removeClass("user-nav__link_cart-not-empty"),this.$basketTitle.addClass("user-nav__link_cart")),this.$basketTitle.html(b)}})}(window,document,document.body),function(a,b,c){"use strict";LMDA.Views.Menu=LMDA.Views.BaseView.extend({el:".header .menu",context:"header",mainEvents:{},additionalEvents:{"mouseenter .menu-new__item":"showMenu","mouseleave .menu-new__item":"hideMenu","mouseenter .menu-new__sub-item":"showSubMenu","click .menu-new__item-link, .menu-new__sub-item-link":"_showLink"},events:function(){return _.extend({},this.mainEvents,this.additionalEvents)},initialize:function(){this.timeout=0,this.timeoutFlag=!1},_showLink:function(a){var b=$(a.currentTarget);b.data("menu-link")&&b.attr("href",b.data("menu-link")+""),b.removeAttr("data-menu-link")},showMenu:function(a){var b=$(a.currentTarget);b.hasClass("menu-new__item_active")||(this.timeoutFlag&&this.timeoutStop(),this.timeoutStart(function(){b.siblings(".menu-new__item_active").removeClass("menu-new__item_active"),b.addClass("menu-new__item_active").find(".menu-new__sub-item_open, .menu-new__sub-item_empty").removeClass("menu-new__sub-item_active").first().addClass("menu-new__sub-item_active")}))},hideMenu:function(a){var b=this;this.timeoutFlag&&this.timeoutStop(),$(a.relatedTarget).closest(".menu-new__item").length||this.timeoutStart(function(){b.$(".menu-new__item_active").removeClass("menu-new__item_active")})},showSubMenu:function(a){var b=$(a.currentTarget),c=function(){b.toggleClass("menu-new__sub-item_active",!0).siblings(".menu-new__sub-item_active").removeClass("menu-new__sub-item_active")};b.hasClass("menu-new__sub-item_title")||(this.timeoutFlag&&this.timeoutStop(),b.find(".dropdown").length?this.timeoutStart(c):c())},timeoutStart:function(a){this.timeoutFlag=!0,this.timeout=setTimeout(_.bind(function(){this.timeoutStop(),a()},this),100)},timeoutStop:function(){clearTimeout(this.timeout),this.timeoutFlag=!1}})}(window,document),function(a){"use strict";a.SeoMenu=a.BaseView.extend({el:".seo-menu",context:"seo_menu",events:{"click .button:not(.button_toggled)":"showSection","click .seo-menu__section-item:not(.seo-menu__section-item_active)":"showSubSection"},initialize:function(){return this.$el&&this.$el.length?(this.$sections=this.$(".seo-menu__section"),this.$activeTab=this.$(".button_toggled"),this.$activeSection=this.$sections.filter('[data-for="'+this.$activeTab.data("for")+'"]'),this.$activeSectionItem=this.$activeSection.find(".seo-menu__section-item_active"),void(this.$activeSectionItem.length&&(this.$activeSubSection=this.$activeSection.find('.seo-menu__level-2 [data-for="'+this.$activeSectionItem.data("for")+'"]')))):this},showSection:function(a){var b=$(a.currentTarget);this.$activeTab.removeClass("button_toggled"),b.addClass("button_toggled"),this.$activeTab=b,this.$activeSection.hide(),this.$activeSection=this.$sections.filter('[data-for="'+b.data("for")+'"]'),this.$activeSection.show(),this.$activeSectionItem=this.$activeSection.find(".seo-menu__section-item_active"),this.$activeSectionItem.length&&(this.$activeSubSection=this.$activeSection.find('.seo-menu__level-2 [data-for="'+this.$activeSectionItem.data("for")+'"]'))},showSubSection:function(a){var b=$(a.currentTarget);this.$activeSectionItem.removeClass("seo-menu__section-item_active"),b.addClass("seo-menu__section-item_active"),this.$activeSectionItem=b,this.$activeSubSection.hide(),this.$activeSubSection=this.$activeSection.find('.seo-menu__level-2 [data-for="'+b.data("for")+'"]'),this.$activeSubSection.show()}})}(LMDA.Views),function(a){LMDA.Views.MenuTouch=LMDA.Views.Menu.extend({additionalEvents:{"click .menu-new__item-link, .menu-new__sub-item-link":"showSubMenu","click .menu-new__sub-item_empty":"emptySubMenu"},initialize:function(){LMDA.Events.on("body:click",function(a){$(a.target).closest(".menu").length||this.closeMenu()},this)},showSubMenu:function(a){var b=$(a.currentTarget),c=b.hasClass("menu-new__item-link")?0:1,d=c?".menu-new__sub-item":".menu-new__item",e=c?"menu-new__sub-item_active":"menu-new__item_active",f=b.parent(d);f.hasClass("menu-new__sub-item_empty")||(!f.length||f.hasClass(e)?this._showLink({currentTarget:b}):(f.addClass(e).siblings(d).removeClass(e),0==c&&f.find(".menu-new__sub-item_open").first().addClass("menu-new__sub-item_active").siblings(".menu-new__sub-item_active").removeClass("menu-new__sub-item_active"),a.originalEvent.preventDefault()))},closeMenu:function(){this.$el.find(".menu-new__item").removeClass("menu-new__item_active")},emptySubMenu:function(a){this._showLink({currentTarget:$(a.currentTarget).find(".menu-new__sub-item-link")})}})}(LMDA.Views.Menu),LMDA.Views.SmartBanner=Backbone.View.extend({el:".smartbanner",initialize:function(){function a(){var a=new Date;a.setDate(a.getDate()+1),document.cookie="smartbanner_exit=1; path=/; expires="+a.toUTCString(),b.$el.remove()}if(1==LMDA.Utils.cookie.get("smartbanner_exit"))return void this.$el.remove();var b=this;$(".smartbanner__close").on("click",a),$(".smartbanner-button").on("click",a)}}),function(){"use strict";LMDA.Views.DropUp=Backbone.View.extend({initialize:function(){this.$trigger=$(this.options.triggerElement),this.$dropup=$(this.options.dropupElement);var a=this;this.$trigger.on("click",function(){a.isShown?a.hide():a.show()}),this.$dropup.on("click",function(a){a.stopPropagation()}),this.init()},init:function(){},show:function(){this._onOutsideClick(this.$dropup,this.hide,this),this.$dropup.show(),this.isShown=!0,this.trigger("show")},hide:function(){this.$dropup.hide(),this.isShown=!1,this.trigger("hide")}}),_.extend(LMDA.Views.DropUp.prototype,LMDA.mixins.OutsideClick),new LMDA.Views.DropUp({triggerElement:".footer__local-country-switcher",dropupElement:".footer__local-country-switcher .dropup"}),new LMDA.Views.DropUp({triggerElement:".footer__local-delivery",dropupElement:".footer__local-delivery .dropup"});var a=new LMDA.Views.DropUp({triggerElement:".footer__sticky-help .js-dropup-trigger",dropupElement:".footer__sticky-help .js-footer-help"});a.on("show",function(){LMDA.Statistics.report("footerHelp","show"),LMDA.Statistics.report("phone","view",{source:"bbar_questions"})}),a.$dropup&&a.$dropup.length&&a.$dropup.on("click.Statistics",".dropup-item_link",function(a){LMDA.Statistics.report("footerHelp","click",{href:$(this).attr("href")})})}(),function(){"use strict";LMDA.Views.HelpPhones=Backbone.View.extend({initialize:function(){var a=this;this.$cityList=this.$(".dropup-geolocation"),this.$cityList.length&&(this.$phone8800=this.$(".js-phone-8800"),this.$forCityName=this.$(".js-for-city-name"),this.$phone=this.$(".js-phone"),this.$changeButton=this.$(".dropup-item_change"),this.$changeButton.on("click",function(){a.$cityList.show(),a.$changeButton.hide()}),this.$cityList.on("click",".dropup-geolocation__item",function(){a.$cityList.hide(),a.$changeButton.show();var b=$(this).data("geo-id");a.updatePhones(b),b?LMDA.localStorage.setItemCrossDomain("footer.geoLocation",b):LMDA.localStorage.removeItemCrossDomain("footer.geoLocation")}),LMDA.localStorage.getItemCrossDomain("footer.geoLocation",function(b){b=b||LMDA.geo.regionId,a.updatePhones(b)}))},updatePhones:function(a){var b=this.$cityList.find('[data-geo-id="'+a+'"]');b.length?this.$phone8800.hide():(b=this.$cityList.find('[data-name="Москвы"]'),this.$phone8800.show()),this.$phone.html(b.data("phone")),this.$forCityName.html(b.data("name"))}}),new LMDA.Views.HelpPhones({el:".js-footer-help"})}(),function(a,b,c){"use strict";var d="hidden",e="popup_visible",f=new LMDA.Utils.ModalsStack;LMDA.Views.Popup=LMDA.Views.BaseView.extend({pageEvents:{click:"outSideCLick","click [data-popup-close]":"close","click .js-popup-reload":"_reload"},additionalEvents:{},events:function(){return _.extend({},this.pageEvents,this.additionalEvents)},_errorTemplate:_.template('<div class="popup__load-error">Не удалось получить информацию.<br/><br/><span class="button js-popup-reload" data-url="<%= url %>">Обновить</span></div>'),initialize:function(){this.$popup=this.$(".popup__inner"),this.$content=this.$(".popup__content"),this.lastScrollTop=0,this.init.apply(this,arguments)},init:function(){},outSideCLick:function(a){$(a.target).hasClass("popup")&&this.close(a)},keyDownListener:function(a){27!=a||this.$el.hasClass(d)||this.close()},close:function(){LMDA.Events.off("window:keydown",this.keyDownListener),this.trigger("close",{isOpened:!1}),LMDA.Statistics.report("popup","close",{isOpened:!1}),LMDA.Events.trigger("popup:toggle",!1),this.$el.addClass(d).removeClass(e).css({zIndex:"",display:"none"}),this.$popup&&this.$popup.attr("style",""),this._ajax&&this._ajax.abort(),f.pop(),LMDA.Utils.pageManager.unblock()},open:function(){this.$el.css("z-index",LMDA.Utils.pageManager.currentZindex+1).removeClass(d).addClass(e).css("display","block"),LMDA.Events.trigger("popup:toggle",!0),this.adaptSize(),this.trigger("open",{isOpened:!0}),LMDA.Statistics.report("popup","open",{isOpened:!0}),LMDA.Events.on("window:keydown",this.keyDownListener,this),f.push(this),LMDA.Utils.pageManager.block()},load:function(a){this._ajax&&this._ajax.abort(),this._ajax=LMDA.ajax({url:a,dataType:"html",context:this,beforeSend:function(){this.$el.addClass("popup_loading")},success:function(a){this.$el.removeClass("popup_loading"),this.$content.html(a),this.trigger("load"),this.adaptSize()},error:function(){this.$el.removeClass("popup_loading"),this.$content.html(this._errorTemplate({url:a})),this.trigger("error")}})},_reload:function(a){this.load($(a.currentTarget).data("url"))},adaptSize:function(){var a=this.$content.find(".js-popup__adapt-height"),b,c,d;a.length&&(b=LMDA.$window.height()-this.$popup.height()-10,c=a.data("min-height-for-popup")||100,0>b&&(d=Math.max(a.height()+b,c),a.css({height:d+"px","overflow-y":"scroll","padding-right":a.data("scroll-padding-for-popup")||"10px"})))},isActive:function(){return!this.$el.hasClass(d)&&"none"!=this.$el.css("display")}})}(window,document),LMDA.Views.HelpPopup=LMDA.Views.Popup.extend({el:".help-popup",additionalEvents:{"change .help-popup__row-file":"_changedFile","click .help-popup__row-reset-file":"_resetFile"},_messages:{FEEDBACK_NOT_VALID_EMAIL:"Неверный электронный адрес.",FEEDBACK_ATTACHMENT_IS_TOO_BIG:"Слишком большой размер файла.",FEEDBACK_SEND_ERROR:"Извините, что-то пошло не так.",FEEDBACK_FORM_ERROR:"Неправильно заполнена форма."},template:_.template('<div class="popup__inner">            <span class="popup__close" data-popup-close=""></span>            <div class="popup__content">                <form class="help-popup__form" method="POST" action="/feedback/" data-form="help" enctype="multipart/form-data" target="help_popup">                    <div class="help-popup__title">Спросите нас</div>                    <div class="popup__error hidden"></div>                    <div class="help-popup__row help-popup__row_theme" data-form-widget="theme"><span class="hidden"><input type="text" name="url" class="text-field" data-form-control="url"/></span>                        <span class="help-popup__row-label">Выберите тему</span>                        <div class="select" data-form-control="theme">                            <input class="js-help-form__theme" type="hidden" name="theme" value="0" />                            <span class="button button_outline button_s">                                <span class="button__title">tplData.themes[0]</span>                            </span>                            <ul class="dropdown">                                <% _.each(tplData.themes, function(themeName, i) { %>                                    <li class="select__item <% if (!i) { %> select__item_current <% } %>" data-option-value="<%= i %>">                                        <span class="select__item-label"><%= themeName %></span>                                        <i class="select__tick"></i>                                    </li>                                <% }) %>                            </ul>                        </div>                    </div>                    <div class="help-popup__row help-popup__row_question" data-form-widget="question">                        <span class="help-popup__row-label">Введите вопрос</span>                        <textarea class="text-field text-field_textarea" name="question" data-form-control="question" placeholder="Пожалуйста, подробно опишите свою проблему. Наиболее полная информация поможет нам ответить на ваше обращение в кратчайшие сроки. Вы можете также приложить файл со снимком экрана."></textarea>                        <div class="help-popup__row-error" data-form-error="question"></div>                    </div>                    <div class="help-popup__row help-popup__row_file" data-form-widget="file">                        <input class="help-popup__row-file" type="file" name="file"/>                        <span class="help-popup__row-reset-file hidden">Удалить</span>                        <div class="help-popup__row-error"></div>                    </div>                    <div class="help-popup__row" data-form-widget="order">                        <span class="help-popup__row-label">Номер заказа</span>                        <input class="text-field" type="text" name="order" data-form-control="order"/>                        <div class="help-popup__row-error" data-form-error="order"></div>                    </div>                    <div class="help-popup__row" data-form-widget="name">                        <div class="help-popup__row-label">Представьтесь,<br/>пожалуйста</div>                        <input class="text-field" type="text" name="name" data-form-control="name" placeholder="Ваше имя"/>                        <div class="help-popup__row-error" data-form-error="name"></div>                    </div>                    <div class="help-popup__row" data-form-widget="email">                        <input class="text-field" type="text" name="email" data-form-control="email" placeholder="Эл. почта"/>                        <div class="help-popup__row-error" data-form-error="email"></div>                    </div>                    <div class="help-popup__row">                        <div class="help-popup__row-label"></div>                        <div id="help-popup__captcha"></div>                        <div class="help-popup__captcha-error"></div>                    </div>                    <div class="help-popup__actions">                        <button class="button button_big button_blue help-popup__actions-submit" type="submit">                            <span class="button__title">Задать вопрос</span>                        </button>                        <span class="button button_outline help-popup__actions-cancel" data-popup-close="">                            <span class="button__title">Отмена</span>                        </span>                    </div>                </form>                <iframe name="help_popup" style="display:none"></iframe>            </div>        </div>'),initialize:function(){this.initialArguments=arguments
},init:function(){this._initDOM(),this.views={},this.views.helpForm=new LMDA.Views.HelpForm,LMDA.exports.helpCallback=_.bind(this.iframeHelpCallback,this)},_initDOM:function(){this.$error=this.$(".popup__error"),this.$file=this.$(".help-popup__row_file"),this.$fileInput=this.$file.find(".help-popup__row-file"),this.$fileReset=this.$file.find(".help-popup__row-reset-file"),this.$fileError=this.$file.find(".help-popup__row-error")},_changedFile:function(){this.$fileReset.toggleClass("hidden",!this.$fileInput.val().length),this.$fileError.hide().text("")},_resetFile:function(){this.$fileInput.val(""),this.$fileReset.toggleClass("hidden",!0)},iframeHelpCallback:function(a){this.$error.toggleClass("hidden",!0),"OK"==a.status?(this.trigger("form:success"),this.views.helpForm.trigger("success"),this.close()):this._handleErrors(a.error)},_handleErrors:function(a){"FEEDBACK_NOT_VALID_EMAIL"==a?this.views.helpForm.getWidget("email").handleErrors([{type:a,result:!1}],this._messages):"FEEDBACK_ATTACHMENT_IS_TOO_BIG"==a?this.$fileError.show().text(this._messages[a]):this.$error.toggleClass("hidden",!1).text(this._messages[a]||this._messages.FEEDBACK_SEND_ERROR)},render:function(){var a={themes:["Получить информацию по акции/скидке/промокоду","Уточнить характеристики товара","Подтвердить заказ","Изменить контактные данные","Уточнить информацию по доставке заказа","Узнать номер почтового идентификатора","Отменить заказ","Уточнить условия возврата товара","Отписать от рассылки","Сообщить о некорректной работе сайта","Оставить отзыв о работе магазина"]};this.$el.html(this.template({tplData:a})),this.rendered=!0},open:function(){this.rendered||(this.render(),LMDA.Views.Popup.prototype.initialize.apply(this,this.initialArguments)),LMDA.Views.Popup.prototype.open.apply(this,arguments)}}),LMDA.Views.HelpForm=LMDA.Forms.FormView.extend({el:".help-popup__form",errors:{required:"Это поле необходимо заполнить.",max:"Можно ввести не более 50 символов",type:"Пожалуйста, введите действительный адрес электронной почты. Например, johndoe@domain.com"},formSettings:{mustValidate:!0,widgets:{theme:{type:LMDA.Forms.Types.SELECT},question:{type:LMDA.Forms.Types.TEXT,required:!0,max:1e3,errorMessages:this.errors},order:{type:LMDA.Forms.Types.TEXT,required:!0,max:20,errorMessages:this.errors},name:{type:LMDA.Forms.Types.TEXT,required:!0,max:50,errorMessages:this.errors},email:{type:LMDA.Forms.Types.EMAIL,required:!0,errorMessages:this.errors}}},apixAction:"feedback",recaptchaElementId:"help-popup__captcha",initialize:function(){var a;this.captchaInitialize(),this.$captchaMessage=this.$(".help-popup__captcha-error"),this.on("captchaComplete",this.renderCaptchaComplete),this.on("captchaError",this.renderCaptchaError),this.on("success",this.resetCaptchaState),this._initDOM(),LMDA.Forms.FormView.prototype.initialize.call(this,this.formSettings),a=new LMDA.Forms.Dependencies(this,{order:{theme:[2,3,4,5,6]}}),this.getWidget("theme").on("change:widget",this._correctThemeValue,this),this._correctThemeValue()},_initDOM:function(){this.$theme=this.$(".help-popup__row_theme"),this.$themeInput=this.$theme.find(".js-help-form__theme")},_correctThemeValue:function(){this.$themeInput.val(this.$theme.find('.select__item[data-option-value="'+this.$themeInput.val()+'"]').text())},renderCaptchaComplete:function(){this.$captchaMessage.html("")},renderCaptchaError:function(){this.$captchaMessage.html(this.CAPTCHA_ERROR),this.captchaReset()},resetCaptchaState:function(){this.$captchaMessage.html(""),this.captchaReset()}}),_.extend(LMDA.Views.HelpForm.prototype,LMDA.mixins.CaptchaMixin),function(a,b,c){"use strict";var d;require(["ii/widget/tip"],function(a){d=new a({preset:"auth"})}),LMDA.Views.AuthPopup=LMDA.Views.Popup.extend({el:".auth-popup",context:"authPopup",template:_.template('<div class="popup__inner">                <span class="popup__close" data-popup-close=""></span>                <img class="popup__add-to-wishlist-pictire" />                <div class="popup__content">                    <div class="popup__content-wrapper">                        <% if (tplData.isDdos) { %>                            <div class="ddos"><div>Извините, регистрация/авторизация в данный момент недоступна</div></div>                        <% } else { %>                            <form class="form login-form" method="post" action="<%= tplData.formActionLogin %>" novalidate="novalidate" target="auth_transport" data-form="login">                                <% if (tplData.socialAuthLinks.length) { %>                                    <div class="popup__header auth-social">                                        <div class="auth-social__title">Вход</div>                                        <div class="auth-social__list">                                            <% _.each(tplData.socialAuthLinks, function(linkItem) { %>                                                <span class="link auth-social__item auth-social__item_<%= linkItem.id %>" data-social-title="<%= linkItem.title %>" data-social-link="<%= linkItem.link %>" data-social-id="<%= linkItem.id %>"/>                                            <% }); %>                                        </div>                                        <div class="auth-social__description">                                            Мы не будем делать публикации</br> от вашего имени                                        </div>                                        <div class="auth-social__description auth-social__description_adding">                                            Чтобы сохранить в избранное,</br>войдите с свой аккаунт                                        </div>                                        <div class="popup__error"></div>                                        <fieldset class="auth-social__fieldset">                                            <legend class="auth-social__legend" align="center">или</legend>                                         </fieldset>                                    </div>                                <% } %>                                <div class="form__widget" data-form-widget="email">                                    <div class="form__widget-content">                                        <input type="email" name="email" class="text-field" data-form-control="email" maxlength="50" placeholder="E-mail"/>                                        <div class="i_help hint-wrap">                                            <div class="hint hint_white hint_left">                                                E-mail, который вы указываете при оформлении заказов на Lamoda.<%= LMDA.site %>, является логином для входа на сайт, доступа к бонусам и истории заказов.                                             </div>                                        </div>                                        <div class="form__error" data-form-error="email"></div>                                    </div>                                </div>                                <div class="form__widget" data-form-widget="password">                                    <div class="form__widget-content">                                        <input type="password" name="password" class="text-field" data-form-control="password" placeholder="Пароль"/>                                        <span class="login-form__lost link">Не помните?</span>                                        <div class="form__error" data-form-error="password"></div>                                    </div>                                </div>                                <div class="form__captcha-wrap">                                    <div id="login_recaptcha" class="form__captcha-inner"></div>                                    <div class="form__captcha-error" id="login_recaptcha_error"></div>                                </div>                                <div class="form__controls">                                    <button type="submit" class="button button_blue">Войти</button>                                </div>                                <div class="form__footer">                                    <span class="login-form__register link">Регистрация нового пользователя</span>                                </div>                            </form>                            <form class="form register-form" method="post" action="<%= tplData.formActionRegister %>" novalidate="novalidate" target="auth_transport" data-form="register">                                <input type="hidden" name="is_partner" value="" />                                <input type="hidden" name="source"     value="" />                                <input type="hidden" name="location"   value="" />                                <div class="auth-social__title">Регистрация</div>                                <div class="form__widget" data-form-widget="email">                                    <div class="form__widget-content">                                        <input type="email" name="email" class="text-field" data-form-control="email" maxlength="50" placeholder="E-mail"/>                                        <div class="form__error" data-form-error="email"></div>                                    </div>                                </div>                                <div class="form__widget form__widget_subscribed" data-form-widget="subscribed">                                    <span class="widget__control checkbox" data-form-control="subscribed">                                        <i class="checkbox__tick"></i>                                        <input type="checkbox" name="subscribe" id="auth_subscribed_checkbox" class="checkbox__native" value="subscribe" checked="checked" />                                    </span>                                    <label for="auth_subscribed_checkbox" class="widget__label">Подписаться на новости</label>                                </div>                                <div class="form__widget" data-form-widget="password">                                    <div class="form__widget-content">                                        <input type="password" name="password" class="text-field" data-form-control="password" placeholder="Придумайте пароль"/>                                        <div class="form__error" data-form-error="password"></div>                                    </div>                                </div>                                <div class="form__widget" data-form-widget="password2">                                    <div class="form__widget-content">                                        <input type="password" name="password2" class="text-field" data-form-control="password2" placeholder="Повторите пароль"/>                                        <div class="form__error" data-form-error="password2"></div>                                    </div>                                </div>                                <div class="form__widget" data-form-widget="first_name">                                    <div class="form__widget-content">                                        <input type="text" name="first_name" class="text-field" data-form-control="first_name" placeholder="Ваше имя"/>                                        <div class="form__error" data-form-error="first_name"></div>                                    </div>                                </div>                                <div class="form__captcha-wrap">                                    <div id="registration_recaptcha" class="form__captcha-inner"></div>                                    <div class="form__captcha-error" id="registration_recaptcha_error"></div>                                </div>                                <div class="form__controls">                                    <button type="submit" class="button button_blue">Зарегистрироваться</button>                                </div>                                <% if (tplData.socialAuthLinks.length) { %>                                    <div class="form__footer">                                        Войти :                                         <div class="auth-social__list">                                            <% _.each(tplData.socialAuthLinks, function(linkItem) { %>                                                <span class="link auth-social__item auth-social__item_<%= linkItem.id %>" data-social-title="<%= linkItem.title %>" data-social-link="<%= linkItem.link %>" data-social-id="<%= linkItem.id %>"/>                                            <% }); %>                                            <span class="link register-form__login auth-social__item auth-social__item_login"/>                                        </div>                                    </div>                                <% } %>                            </form>                            <form class="form lost-form" method="post" action="<%= tplData.formActionLost %>" novalidate="novalidate" target="auth_transport" data-form="lost">                                <% if (tplData.socialAuthLinks.length) { %>                                    <div class="popup__header auth-social">                                        <div class="auth-social__title">Вход</div>                                        <div class="auth-social__list">                                            <% _.each(tplData.socialAuthLinks, function(linkItem) { %>                                                <span class="link auth-social__item auth-social__item_<%= linkItem.id %>" data-social-title="<%= linkItem.title %>" data-social-link="<%= linkItem.link %>" data-social-id="<%= linkItem.id %>"/>                                            <% }); %>                                        </div>                                        <div class="auth-social__description">                                            Мы не будем делать публикации</br> от вашего имени                                        </div>                                        <div class="popup__error"></div>                                        <fieldset class="auth-social__fieldset">                                            <legend class="auth-social__legend" align="center">или</legend>                                         </fieldset>                                    </div>                                <% } %>                                <div class="lost-form__info">Восстановление пароля</div>                                <div class="popup__info"></div>                                <div class="form__widget" data-form-widget="email">                                    <div class="form__widget-content">                                        <input type="email" name="email" class="text-field" value="" data-form-control="email" maxlength="50" placeholder="E-mail" />                                        <div class="i_help hint-wrap">                                            <div class="hint hint_white hint_left">                                                Укажите e-mail, который вы<br/> использовали при оформлении<br/> заказов на lamoda.<%= LMDA.site %>. Мы вышлем<br/> вам инструкцию для восстановления<br/> пароля.                                             </div>                                        </div>                                        <div class="form__error" data-form-error="email"></div>                                    </div>                                </div>                                <div class="form__captcha-wrap">                                    <div id="restore_recaptcha" class="form__captcha-inner"></div>                                    <div class="form__captcha-error" id="restore_recaptcha_error"></div>                                </div>                                <div class="form__controls">                                    <span class="lost-form__login link">Помню пароль</span>                                    <button type="submit" class="button button_blue">Восстановить</button>                                </div>                                <div class="form__footer">                                    <span class="lost-form__register link">Регистрация нового пользователя</span>                                </div>                            </form>                        <% } %>                    </div>                </div>                <iframe frameborder="0" name="auth_transport" id="auth_transport" class="auth-popup__transport"></iframe>            </div>'),initialize:function(){this.initialArguments=arguments},messengerSettings:{social:{SN__CUSTOMER_NOT_ACTIVE:"Ваша учетная запись неактивна. Пожалуйста, обратитесь в службу поддержки.",SN_ERROR:"Произошла ошибка при получении данных от социальной сети. Пожалуйста, попробуйте позднее.",SN_MADMIN_ERROR:"Произошла ошибка при создании учетной записи. Пожалуйста, попробуйте позднее.",SN_UNKNOWN:"Социальная сеть не поддерживается. Пожалуйста, попробуйте еще раз.",USER_IS_AUTH:"Вы уже авторизованы."},errors:{CAPTCHA_ERROR:"Неправильно введен защитный код (reCAPTCHA)",SERVER_ERROR:"Извините, что-то пошло не так. Пожалуйста, попробуйте позже.",LOGIN__CAPTCHA_ERROR:"Неправильно введен защитный код (reCAPTCHA)",LOGIN__CUSTOMER_NOT_ACTIVE:"Ваша учетная запись неактивна. Пожалуйста, обратитесь в службу поддержки.",LOGIN__SERVER_ERROR:"Что-то пошло не так. Пожалуйста, попробуйте еще раз.",FORGOT__CUSTOMER_NOT_FOUND:'Данный адрес электронной почты не найден в нашей базе данных. <a class="lost-form__register">Зарегистрируйтесь сейчас</a>',FORGOT__EMAIL_REQUIRED:"Пожалуйста, введите действительный адрес электронной почты. Например, johndoe@domain.com",LOGIN__INVALID_PASSWORD_OR_USERNAME:"Неверный логин или пароль.",REGISTER__NEWPASSWORDS_CONTAINS_SPACES:"В пароле присутствуют некорректные символы: пробелы",REGISTER__NEWPASSWORDS_CONTAINS_WRONG_SYMBOLS:"В пароле присутствуют некорректные символы. Допустимые символы: латинские буквы, цифры, символы: !@#$%^&*()_+",REGISTER__NEWPASSWORDS_DOESNOT_MATCH:"Пожалуйста, убедитесь, что Ваши пароли совпадают.",REGISTER__PASSWORD_LEN_LONGER_MAX:"Максимальная длина пароля 30 символов.",REGISTER__PASSWORD_LEN_SHORTER_MIN:"Минимальная длина пароля 6 символов.",REGISTER__USER_ALREADY_EXIST:"Другая учетная запись зарегистрирована на указанный адрес электронной почты.",REGISTER__WRONG_EMAIL:"Пожалуйста, введите действительный адрес электронной почты. Например, johndoe@domain.com",REGISTER__WRONG_PHONE:LMDA.Validators.phone.message},info:{CUSTOMER__PW_RESET_DONE:'<div class="popup__info">                                                    <span class="form__success"></span>                                                    <span class="form__description">                                                        Ссылка для восстановления пароля</br>отправлена на ваш e-mail.</br>Проверьте почту.                                                    </span>                                                </div>'},wishlist:{ADD_DONE:"Товар добавлен в ваше Избранное. Теперь вы всегда легко можете найти его, кликнув соответствующую кнопку вверху страницы, рядом с Корзиной.",ADD_FAIL:"Вы успешно авторизовались, но добавить товар в избранное не удалось. Попробуйте позже."}},init:function(){var b=this;LMDA.DATA.isExperimentOn("ddos")||(this.messenger=new LMDA.Utils.Messenger(this.messengerSettings),this.authForm=new LMDA.Views.AuthForm,this.lostForm=new LMDA.Views.LostForm,this.registerForm=new LMDA.Views.RegisterForm,this.formRoutes={login:this.authForm,lost:this.lostForm,register:this.registerForm},this.activeForm=this.authForm,this.authForm.on("forms:route",this.formRoute,this),this.registerForm.on("forms:route",this.formRoute,this),this.lostForm.on("forms:route",this.formRoute,this),this.$socialAuth=this.$(".auth-social"),this.$addToWishlistButtoneDone=this.$(".popup__add-to-wishlist-buttone-done"),LMDA.Events.on("body:click",function(a){$(a.target).closest(".form__hint").length||b.activeForm.$(".form__hint").hide()}),this.$el.on("click.AuthPopup",".auth-social__item",function(a){var c=$(a.currentTarget),d=c.data("social-link"),e=c.data("social-title"),f=c.data("social-id");c&&d&&(b.log("social:attempt",{type:"social",href:d,name:f}),b.socialAuthWindow=window.open(d,e,"width=700, height=550, menubar=no, resizeable=yes, status=no, scrollbars=yes"))}),this.$submit=this.$('button[type="submit"]').on("click.AuthPopup",function(a){var c=b.activeForm===b.registerForm?"registration":b.activeForm===b.lostForm?"restore":"login";b.log([c,":attempt"].join(""),{type:c,form:b.activeForm}),_.each(["email","password"],function(a){var c=b.activeForm.getWidget(a),d=c&&c.getControl();d&&(d.set(d.$el.val()),"email"===a&&d.set($.trim(d.get()+"")))})}),this.$addToWishlistButtoneDone.on("click",function(a){return function(){a.close()}}(this)),this.on("close",function(){b.socialAuthWindow&&b.socialAuthWindow.close&&b.socialAuthWindow.close(),delete b.addingToWishlist,b.hideErrorMessage(),b.registerForm.hide(),b.lostForm.hide(),b.authForm.show(),b.$socialAuth.toggleClass("auth-social_error",!1).show(),b.activeForm=b.authForm,LMDA.DATA.user.get("isLoggedIn")&&LMDA.DATA.page.get("needReloadOnAuth")&&a.location.reload()}),LMDA.$window.on("message",_.bind(this.postMessageDispatcher,this)))},postMessageDispatcher:function(a){var b,c,d,e={"auth_social.user":"social","password.recover":"restore","auth.user":"login","reg.user":"registration"},f={"auth.user":"authForm","reg.user":"registerForm","password.recover":"lostForm"},g;!a.data&&a.originalEvent&&(a=a.originalEvent);try{b=JSON.parse(a.data)}catch(h){b={}}if(b.name&&-1!==_.indexOf(["auth.user","auth_social.user","reg.user","password.recover"],b.name)){if(d=b.data||{},d.status=b.result?b.result.status:d.status,c="ERROR"===d.status?"fail":"done",this.log([e[b.name],c].join(":"),d),"auth_social.user"===b.name)return this.socialAuthShowResult(b);if("ERROR"===d.status)return g=f[b.name],void("LOGIN__CAPTCHA_ERROR"===d.code?g&&this[g].trigger("captchaError"):(g&&this[g].captchaReset(),this.showErrorMessage(d.code)));if("password.recover"===b.name)return"OK"===d.status&&($("#restore_recaptcha").toggleClass("hidden",!0),this.lostForm.captchaReset()),this.hideErrorMessage(),this.showInfoMessage(d.code),this.lostForm.getWidget("email").hide(),void this.lostForm.$el.find(".form__controls").hide();if("reg.user"===b.name)try{this.registerForm.getWidget("subscribed").get()&&LMDA.API.subscribe.newsletter({email:this.registerForm.getWidget("email").get(),location:"reg_sub"})}catch(h){LMDA.console.error(h)}this.hideErrorMessage(),this.hideInfoMessage(),this.authSuccess(b.data)}},authSuccess:function(a){if(LMDA.DATA.user.set("cartItemsCount",a.cart_quantity),LMDA.DATA.user.set("cartTotal",a.cart_total),LMDA.DATA.user.set("isLoggedIn","1"),LMDA.DATA.user.set("cid",a.info&&a.info.cid),LMDA.PAGEDATA&&LMDA.PAGEDATA.push({user:{cid:a.info&&a.info.cid}}),LMDA.Events.trigger("auth:success"),this.addingToWishlist){var b=this;_.each(this.formRoutes,function(a){a.hide()}),this.$socialAuth.hide(),function c(a){var c=b.$el.find(".popup__content-wrapper");c.length&&c.html(['<div class="popup__info">','<div class="popup__title">Успешно</div>','<span class="form__success"></span>','<span class="form__description">',b.messenger.get("OK"===a?"ADD_DONE":"ADD_FAIL","wishlist"),"</span>",'<button type="submit" class="button button_blue button_close" data-popup-close>Продолжить покупки</button>',"</div>"].join(""))}(a&&a.status),this.addingToWishlist.successCallback&&this.addingToWishlist.successCallback()}else this.close();LMDA.Events.trigger(LMDA.Events.AUTH_SUCCESS)},showErrorMessage:function(a){this.hideInfoMessage(),this.hideErrorMessage(),_.each(this.activeForm.getAllWidgets(),function(a,b,c){a.$el.addClass("widget_invalid"),c.password&&(c.password.flush(),c.password2&&c.password2.flush())}),d.error(this.activeForm.$el.find('[data-form-widget="email"]'),this.messenger.get(a,"errors"),"right")},showInfoMessage:function(a){var b=this.messenger.get(a,"info");b&&(this.hideInfoMessage(),this.hideErrorMessage(),this.activeForm.$infoMessage.html(b).removeClass("hidden"))},hideErrorMessage:function(){d.close()},hideInfoMessage:function(){this.activeForm.$infoMessage&&this.activeForm.$infoMessage.addClass("hidden")},formRoute:function(a,b){if(_.each(this.formRoutes,function(a){a.hide()}),this.formRoutes[b].show(),this.activeForm=this.formRoutes[b],this.hideInfoMessage(),"register"===b&&this.registerForm.captchaInitialize(),"lost"===b){var c=this.authForm.getWidget("email"),d=this.lostForm.getWidget("email");this.lostForm.captchaInitialize(),$("#restore_recaptcha").toggleClass("hidden",!1),d.show(),this.lostForm.$el.find(".form__controls").show(),c.isValid()&&d.set(c.get()),this.$socialAuth.show()}this.log("changeTab",{tab:b}),this.activeForm.focusFirstInput()},socialAuthShowResult:function(a){this.socialAuthWindow&&this.socialAuthWindow.close(),"OK"==a.result.status?this.authSuccess(a.data):d.error(this.activeForm.$el.find(".auth-social__list"),this.messenger.get(a.result.msg,"social",!0),"bottom")},render:function(){var a={isDdos:LMDA.DATA.isExperimentOn("ddos"),socialAuthLinks:LMDA.PARAMS.socialAuthLinks,formActionLogin:this.$el.data("form-action-login"),formActionLost:this.$el.data("form-action-lost"),formActionRegister:this.$el.data("form-action-register"),monthNames:LMDA.Utils.verboseDate.MONTHS_RD,phoneCode:LMDA.country.phone.code,phoneLength:LMDA.country.phone.length,phoneMask:LMDA.country.phone.mask,currentYear:(new Date).getFullYear()};this.$el.html(this.template({tplData:a})),this.rendered=!0},open:function(a){this.rendered||(this.render(),LMDA.Views.Popup.prototype.initialize.apply(this,this.initialArguments)),LMDA.Views.Popup.prototype.open.apply(this,arguments),LMDA.DATA.isExperimentOn("ddos")||(this.activeForm.focusFirstInput(),a=a||{},a.wishlist?(this.registerForm.location="wishlist",this.addingToWishlist=a.wishlist,this.$el.find(".popup__add-to-wishlist-pictire").attr("src",a.wishlist.image),this.$el.addClass("adding-to-wishlist")):(this.registerForm.location=null,this.$el.removeClass("adding-to-wishlist")))}})}(window,document),LMDA.Views.AuthForm=LMDA.Forms.FormView.extend({el:".login-form",events:{"click .login-form__register":function(){this.trigger("forms:route","register")},"click .login-form__lost":function(){this.trigger("forms:route","lost")}},formSettings:{mustValidate:!0,widgets:{email:{type:LMDA.Forms.Types.EMAIL,required:!0,placeholder:"E-mail",errorMessages:{type:"Пожалуйста, введите действительный адрес электронной почты. Например, johndoe@domain.com",required:"Это поле обязательно для заполнения"}},password:{type:LMDA.Forms.Types.TEXT,required:!0,placeholder:"Пароль",min:6,errorMessages:{min:"Пожалуйста, введите 6 или более символов.",required:"Это поле обязательно для заполнения"}}}},apixAction:"login",recaptchaElementId:"login_recaptcha",isCompactCaptcha:!0,initialize:function(){LMDA.Forms.FormView.prototype.initialize.call(this,this.formSettings),this.captchaInitialize(),this.$externalErrorMessage=this.$(".popup__error"),this.$captchaMessage=this.$(".form__captcha-error"),this.on("captchaComplete",this.renderCaptchaComplete),this.on("captchaError",this.renderCaptchaError),this.on("invalid:widget",this.onInvalidWidget)},renderCaptchaComplete:function(){this.$captchaMessage.html("")},renderCaptchaError:function(){this.$captchaMessage.html(this.CAPTCHA_ERROR),this.captchaReset()},onInvalidWidget:function(a,b){var c=_(b).map(function(a){return!a||a.result||a.result===!1?a.type:""}).compact().first()}}),_.extend(LMDA.Views.AuthForm.prototype,LMDA.mixins.CaptchaMixin),LMDA.Views.RegisterForm=LMDA.Forms.FormView.extend({el:".register-form",formConfig:{mustValidate:!0,widgets:{first_name:{type:LMDA.Forms.Types.TEXT,required:!0,placeholder:"Ваше имя",max:50,errorMessages:{required:"Это поле необходимо заполнить.",max:"Можно ввести не более 50 символов",nospecsymbols:LMDA.Validators.nospecsymbols.message}},email:{type:LMDA.Forms.Types.EMAIL,required:!0,placeholder:"E-mail",errorMessages:{required:"Это поле необходимо заполнить.",type:"Пожалуйста, введите действительный адрес электронной почты. Например, johndoe@domain.com"}},subscribed:{type:LMDA.Forms.Types.CHECKBOX},password:{type:LMDA.Forms.Types.TEXT,required:!0,placeholder:"Придумайте пароль",min:6,max:30,errorMessages:{required:"Это поле необходимо заполнить.",min:"Минимальная длина пароля 6 символов",max:"Максимальная длина пароля 30 символов",nowhitespace:LMDA.Validators.nowhitespace.message,norusymbols:LMDA.Validators.norusymbols.message}},password2:{type:LMDA.Forms.Types.TEXT,required:!0,placeholder:"Повторите пароль",min:6,errorMessages:{required:"Это поле необходимо заполнить.",min:"Минимальная длина пароля 6 символов",equal:"Пожалуйста, убедитесь, что Ваши пароли совпадают"}}}},apixAction:"registration",recaptchaElementId:"registration_recaptcha",isCompactCaptcha:!0,initialize:function(){var a=this;this.$goLogin=this.$el.find(".register-form__login").on("click.RegisterForm",function(){a.trigger("forms:route","login")}),this.$externalErrorMessage=this.$el.find(".popup__error"),this.$captchaMessage=this.$(".form__captcha-error"),this.on("captchaComplete",this.renderCaptchaComplete),this.on("captchaError",this.renderCaptchaError);var b,c,d,e,f;LMDA.Forms.FormView.prototype.initialize.call(this,this.formConfig),b=this.getWidget("password"),c=this.getWidget("password2"),d=this.getWidget("first_name"),e=this.getWidget("email"),f=e.getControl(),d.addValidation("nospecsymbols",LMDA.Validators.nospecsymbols.validator),b.addValidation("nowhitespace",LMDA.Validators.nowhitespace.validator),b.addValidation("norusymbols",LMDA.Validators.norusymbols.validator),f.on("change",function(){/^\s|\s$/g.test(this.get())&&this.set($.trim(this.get()))},f),c.addValidation("equal",function(a){return b.get()===a}),this.on("show:widget",function(a){void 0===a.widgetName&&LMDA.Events.trigger("show-register:stat")}),this.getWidget("subscribed").on("change:widget",function(a,b){LMDA.Events.trigger("subscribe-register:stat",b.value)}),this.on("submit",function(b,c){a.$el.find('[name="location"]').val(this.location||"reg_sub"),a.$el.find('[name="source"]').val(LMDA.DATA.user.get("affiliates").source),a.$el.find('[name="is_partner"]').val(LMDA.DATA.user.get("isFromPartner")+"");var d=this.getWidget("first_name").getControl();d.set($.trim(d.get()+""))})},renderCaptchaComplete:function(){this.$captchaMessage.html("")},renderCaptchaError:function(){this.$captchaMessage.html(this.CAPTCHA_ERROR),this.captchaReset()}}),_.extend(LMDA.Views.RegisterForm.prototype,LMDA.mixins.CaptchaMixin),LMDA.Views.LostForm=LMDA.Forms.FormView.extend({el:".lost-form",events:{"click .lost-form__login":function(){this.trigger("forms:route","login")},"click .lost-form__register":function(){this.trigger("forms:route","register")}},formSettings:{mustValidate:!0,widgets:{email:{type:LMDA.Forms.Types.EMAIL,required:!0,placeholder:"E-mail",errorMessages:{type:"Пожалуйста, введите действительный адрес электронной почты. Например, johndoe@domain.com",required:"Это поле обязательно для заполнения"}}}},apixAction:"resetpassword",recaptchaElementId:"restore_recaptcha",isCompactCaptcha:!0,initialize:function(){var a,b;LMDA.Forms.FormView.prototype.initialize.call(this,this.formSettings),this.$externalErrorMessage=this.$(".popup__error"),this.$infoMessage=this.$(".popup__info"),this.$captchaMessage=this.$(".form__captcha-error"),this.on("captchaComplete",this.renderCaptchaComplete),this.on("captchaError",this.renderCaptchaError),this.on("captchaHide",this.captchaHide),a=this.getWidget("email"),b=a.getControl(),b.on("change",function(){/^\s|\s$/g.test(this.get())&&this.set($.trim(this.get()))},b)},renderCaptchaComplete:function(){this.$captchaMessage.html("")},renderCaptchaError:function(){this.$captchaMessage.html(this.CAPTCHA_ERROR),this.captchaReset()}}),_.extend(LMDA.Views.LostForm.prototype,LMDA.mixins.CaptchaMixin),function(){"use strict";
LMDA.Views.AddToWishlist=LMDA.Views.BaseView.extend({el:"body",context:"wishlist",clickEvents:{"click .js-to-favorites":"handleClick"},touchEvents:{"touchstart .js-to-favorites":"handleClick"},events:function(){return _.extend({},this[LMDA.isTouch?"touchEvents":"clickEvents"])},initialize:function(){LMDA.user&&LMDA.user.wishlist&&this.updateChecked(),LMDA.DATA.user.on("change:wishlist",this.updateChecked,this)},updateChecked:function(){this.$(".js-to-favorites").removeClass("to-favorites_on"),_.each(LMDA.DATA.user.get("wishlist"),function(a,b){this.$('.js-to-favorites[data-sku="'+b+'"]').addClass("to-favorites_on")},this)},handleClick:function(a){a.preventDefault();var b=$(a.currentTarget),c=b.data("sku"),d,e={sku:b.data("sku"),price:parseInt(b.data("price"))},f=this;c&&(LMDA.DATA.user.get("isLoggedIn")?(d=LMDA.DATA.user.get("wishlist")[c+""])?this._remove(c,d):this._add(e):LMDA.page.views.authPopup.open({wishlist:{sku:c,successCallback:function(a){f._add(e,a)},image:b.data("image")}}))},_add:function(a,b){var c=a.sku;LMDA.ajax({url:"/wishlist/add/"+c,dataType:"json",success:function(d){if("OK"==d.status){var e={};e[c]=d.wish_id,LMDA.DATA.user.set("wishlist",_.extend(d.wish_list,e)),this.updateChecked(),LMDA.Events.trigger(LMDA.Events.WISH_LIST_ADD,{sku:c,wishlist:d.wish_list,price:a.price})}b&&b(d.status)},context:this})},_remove:function(a,b){LMDA.ajax({url:"/wishlist/remove/"+b,dataType:"json",success:function(b){"ERROR"!=b.status&&(LMDA.DATA.user.set("wishlist",b.wish_list),LMDA.Events.trigger(LMDA.Events.WISH_LIST_REMOVE,{sku:a,wishlist:b.wish_list}))},context:this})}})}(),function(){"use strict";LMDA.Views.Search=LMDA.Views.BaseView.extend({context:"search",events:function(){var a={};return a["click ."+this.suggestItemClass]="submit",a["click .js-search-button"]="onSearch",a["mouseenter ."+this.suggestItemClass]="selectHint",a["mouseleave ."+this.suggestItemClass]="unselectHint",a},initialize:function(){if(this.el&&this.$el.length&&(this.suggestItemClass="suggest__item",this.elSelector=".search",this.expanded=LMDA.isWidescreen,LMDA.Events.on(LMDA.Events.SCREEN_CHANGE,function(a){this.expanded=a},this),this.suggestItemActiveClass=this.suggestItemClass+"_active",this.hintTemplate=_.template('<div href="<%= link %>" data-suggest-type="<%= type %>" data-suggest-num="<%= num %>" class="'+this.suggestItemClass+'"><%= hint %></div>'),this.clusterTitleTemplate=_.template('<div class="suggest__cluster-title"><%= title %></div>'),this.recent=[],this.getReсent(),this.initDOM(),this.$field.length)){var a=LMDA.Utils.getUrlParam("q");a&&!this.$field.val()&&this.$field.val(a),LMDA.Events.on("body:click",function(a){!$(a.target).closest(this.elSelector).size()&&this.close()},this),this.$field.on("focus",_.bind(this.open,this)),this.$field.on("keydown",_.bind(this.navigate,this)),this.$field.on("keyup",_.bind(this.inputHandler,this)),this.$field.one("keyup.Statistics",function(){LMDA.Statistics.report("menuSearch","inputStart")}),this.model=new LMDA.Models.SuggestData,this.model.on("change",this.updateList,this),this.inputHandler(),this.focused=!1,this.suggesting="",this.selectedHint=-1}},initDOM:function(){this.$list=this.$(".js-suggest-list"),this.$field=this.$(".js-search-field"),this.$button=this.$(".js-search-button"),this.$hints=this.$("."+this.suggestItemClass)},"getReсent":function(){var a=this;LMDA.localStorage.getItemCrossDomain("reсentSearchQueries",function(b){_.isArray(b)&&(a.recent=b),LMDA.Events.on("Statistics:ready",function(){a.handleRecent()})})},handleRecent:function(){function a(a){return"string"!=typeof a?"":a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}if("y"===LMDA.Utils.getUrlParam("submit")){var b;if(LMDA.Statistics.API){var c=LMDA.Statistics.API.getPageSource();"catalog"===c?b=LMDA.Utils.getUrlParam("redirect_search_value"):"search"===c&&LMDA.Statistics.API.getProducts().items&&LMDA.Statistics.API.getProducts().items.total&&(b=LMDA.Utils.getUrlParam("q"))}b=a(b),b&&-1===this.recent.indexOf(b)&&(this.recent.unshift(b),this.recent.length>10&&this.recent.pop(),LMDA.localStorage.setItemCrossDomain("reсentSearchQueries",this.recent))}},updateList:function(){if(this.focused){var a=this.model.get("hints");_.isEmpty(a)?_.isEmpty(this.recent)?this.$list.hide():(this.$list.show(),this.setHints({recent:this.recent})):(this.$list.show(),this.setHints(a))}},setHints:function(a){var b=[],c=0;_.each(a,function(a,d){if(!_.isEmpty(a))switch(d){case"brands":b.push(this.clusterTitleTemplate({title:"Бренды"})),_.each(a,function(a,e){b.push(this.hintTemplate({type:d,num:c++,hint:a,link:e+"?redirect=search&from=suggest&submit=y"}))},this);break;case"brand_groups":b.push(this.clusterTitleTemplate({title:"Группы брендов"})),_.each(a,function(a,e){b.push(this.hintTemplate({type:d,num:c++,hint:a,link:e+"?redirect=search&from=suggest&submit=y"}))},this);break;case"categories":b.push(this.clusterTitleTemplate({title:"Категории"})),_.each(a,function(a,e){b.push(this.hintTemplate({type:d,num:c++,hint:a,link:e+"?redirect=search&from=suggest&submit=y"}))},this);break;case"ordinary":"1"==LMDA.experiments.UI3049_1&&b.push(this.clusterTitleTemplate({title:"Популярные запросы"})),_.each(a,function(a){b.push(this.hintTemplate({type:d,num:c++,hint:this.highlight(a),link:"/catalogsearch/result/?q="+encodeURIComponent(a)+"&from=suggest&submit=y"}))},this);break;case"recent":b.push(this.clusterTitleTemplate({title:"Ранее вы искали"})),_.each(a,function(a){b.push(this.hintTemplate({type:d,num:c++,hint:a,link:"/catalogsearch/result/?q="+encodeURIComponent(a)+"&from=suggest_recent&submit=y"}))},this)}},this),this.$list.html(b.join("")),this.$hints=this.$("."+this.suggestItemClass)},highlight:function(a){var b=this.model.get("searchStr"),c,d;return b=b.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&"),c=a.toLowerCase().indexOf(b),-1!==c?(d=c+b.length,a.substring(0,c)+"<b>"+a.substring(c,d)+"</b>"+a.substring(d)):a},navigate:function(a){var b=a.which;if(40==b||38==b){if(!this.$hints.length)return;a.preventDefault(),this.selectedHint+=b-39,this.selectedHint==this.$hints.length?this.selectedHint=-1:this.selectedHint<-1&&(this.selectedHint=this.$hints.length-1),this.selectHint()}else 13==b?this.submit():9==b?(a.preventDefault(),this.$hints.length&&!this.suggesting&&(this.selectedHint=0,this.selectHint())):37==b||39==b||16==b||17==b||18==b||91==b||93==b||(this.suggesting=!1,this.selectedHint=-1,this.$hints.removeClass(this.suggestItemActiveClass))},unselectHint:function(){this.selectedHint=-1,this.selectHint()},selectHint:function(a){var b;this.$hints.removeClass(this.suggestItemActiveClass),a?(b=$(a.currentTarget),this.selectedHint=parseInt(b.data("suggest-num"))):b=this.$hints.eq(this.selectedHint),-1==this.selectedHint?(this.suggesting="",this.$field.val(this.model.get("searchStr"))):(b=this.$hints.eq(this.selectedHint),this.suggesting=b.attr("href"),b.addClass(this.suggestItemActiveClass),this.$field.val(["brands","brand_groups","categories"].indexOf(b.data("suggest-type"))>-1?this.model.get("searchStr"):b.text()))},submit:function(){var a,b;this.suggesting?(LMDA.Events.trigger("click:suggest",this.$field.val()),this.submitted=!0,window.location.href=this.suggesting):(a=this.model.get("searchStr"),b=$(".gender-menu a.menu_und__link_active").attr("data-genders")||"women","children"===b&&(b="girls"),a.length>2&&(this.submitted=!0,LMDA.Events.trigger("submit:search",a),window.location.href="/catalogsearch/result/?q="+encodeURIComponent(a)+"&gender_section="+b+"&from=button&submit=y"))},onSearch:function(){this.expanded?this.submit():this.expand()},open:function(){this.focused=!0,this.updateList(),LMDA.Events.trigger("focus:search",{history:this.recent})},close:function(){var a=this;setTimeout(function(){a.focused=!1,a.$list.hide(),a.collapse()},500)},inputHandler:function(){this.suggesting||this.model.set("searchStr",this.$field.val().replace(/^\s*/,"").replace(/\s*$/,"").replace(/\s{2,}/g," ").toLowerCase())},collapse:function(){this.submitted||(this.$el.removeClass("search_expanded"),this.expanded=!1)},expand:function(){this.expanded=!0,this.$el.addClass("search_expanded"),this.$field.focus()}})}(),LMDA.Views.SizeTableLink=Backbone.View.extend({el:".size-chooser__table-link",events:{click:"showTable"},defaultLink:"/about/guides/",initialize:function(a){var b=a.parentModel.get("size_table_link")||this.$el.closest(".product-actions").data("size-table");this.parentModel=a.parentModel,b&&b.length&&this.$el.data("link",b).addClass("js-defined-table")},update:function(a){a?(this.$el.data("link")?this.$el.data("link",a):this.$el.attr("href",a),this.$el.toggleClass("js-defined-table",!0)):(this.$el.data("link")?this.$el.data("link",this.defaultLink):this.$el.attr("href",this.defaultLink),this.$el.toggleClass("js-defined-table",!1))},showTable:function(a){var b=$(a.currentTarget),c=b.data("link")||b.attr("href");b.hasClass("js-defined-table")&&(a.preventDefault(),b.parents(".popup, .size-chooser-dropdown").length?window.open(c+"?new_window=1","size_table","width=716, height=620, menubar=no, resizeable=1, status=no, scrollbars=yes"):LMDA.Events.trigger("sizetablelink:click",c))}}),function(a,b,c,d){"use strict";LMDA.Views.Size=LMDA.Views.BaseView.extend({context:"size-button",events:{click:"select"},INFORMER_DELAY:1500,initialize:function(a){this.model=a.model,a.el||this.setElement(this.template(this.model.attributes)),this.model.on({"change:selected":function(a,b){this.$el.toggleClass("button_pressed",b)},"change:disabled":function(a,b){this.$el.toggleClass("button_disabled",b),this.trigger("size_disabled",this.model.get("sku"))}},this)},get:function(a){return this.model.get(a)},select:function(a){var b=$(a.currentTarget);this.model.get("selected")||this.model.get("disabled")||this.trigger("size_selected",b.data("sku"))},showInformer:function(a){this.$el.addClass("button_error").find(".size-chooser__error").html(a.message),_.delay(_.bind(this.hideInformer,this),this.INFORMER_DELAY),LMDA.z("cart_add",{result:"failed",error_code:a.code,sku:a.sku})},hideInformer:function(){this.$el.removeClass("button_error")},template:LMDA.Templates.Controls.SizeButton})}(window,document,document.body),function(a,b,c,d){"use strict";LMDA.Views.Sizes=LMDA.Views.BaseView.extend({context:"sizes",INFORMER_DELAY:1500,initialize:function(a){var b=a.model.attributes.items;this.model=a.model,this.items={},this.collection=new LMDA.Collections.Sizes,this.collection.on({add:function(a){var b=this.$el.find('[data-sku="'+a.get("sku")+'"]'),c;this.attachItem(b,a)},reset:function(){var a=this;this.collection.each(function(b){b.attributes.disabled||a.attachItem(d,b)})}},this),b&&b.length&&this.collection.set(b)},update:function(a){this.flush(),this.collection.reset(_.where(a,{disabled:!1}))},attachItem:function(a,b){var c;b.set("brand_size_system",this.model.get("brand_size_system")),c=this.createItemView(a,b),c.on({size_selected:function(a){this.selectItem(a)},size_disabled:function(a){this.trigger("size_disabled",a)}},this),a&&a.length||this.$el.append(c.$el),this.items[b.get("sku")]=c},createItemView:function(a,b){return new LMDA.Views.Size({el:a,model:b})},selectItem:function(a){var b,c,d;a&&(b=this.model.attributes,c=this.getItem(a),c&&(d=c.model.attributes,d.disabled||d.selected||(_.each(this.items,function(b,c){var d=b.model.attributes;d.disabled||(d.selected&&b.model.set("selected",!1),d.sku===a&&b.model.set("selected",!0))},this),this.trigger("size_selected",{sku:d.sku,stock:d.stock,size:d.size,brand_size:d.brand_size}))))},disableItem:function(a,b){var c=this.items[a.sku];return b=b||{},c&&(c.model.set({disabled:!0,selected:!1}),b.informer&&c.showInformer(a)),c},getItem:function(a){return this.items[a]},getSelectedItem:function(){var a=this.collection.findWhere({selected:!0});return a?a.attributes:{}},getAllItems:function(){return this.items},reset:function(){_.each(this.items,function(a,b){!a.get("disabled")&&a.get("selected")&&a.model.set("selected",!1)})},flush:function(){this.$el.html(""),this.items={}}})}(window,document,document.body),LMDA.Views.SizeSubscribe=LMDA.Views.BaseView.extend({el:".size-subscribe",context:"size_subscribe",events:{"click .button[data-sku]":"_selectSize","click .size-subscribe__submit":"_submit"},initialize:function(a){this.productData=a.productData,this.sizeChoosingAvailable=!1,this._initDOM(),a.sizes.length&&(_.each(a.sizes,function(a){a.$el.clone().removeClass("button_disabled").appendTo(this.$sizesContainer)},this),this.$sizes=this.$sizesContainer.find(".button"),this.sizeChoosingAvailable=!0),this.EmailWidget=LMDA.Forms.WidgetView.extend(),this.emailWidget=new this.EmailWidget({name:"email",el:this.$(".size-subscribe__step_2"),type:LMDA.Forms.Types.EMAIL,disableSuggest:!0,required:!0,errorMessages:{type:"Пожалуйста, введите действительный адрес электронной почты. Например, johndoe@domain.com",required:"Это поле необходимо заполнить"}}),LMDA.user&&(LMDA.user.isLogon&&this.$(".size-subscribe__subscriptions").removeClass("size-subscribe__subscriptions_disabled").data("link","/customer/account/subscriptions/"),LMDA.user.email&&(this.emailWidget.set(LMDA.user.email),this.emailWidget.getControl().$el.attr("readonly","1"))),this.$(".size-subscribe__product").html([this.productData.title,this.productData.brand&&this.productData.brand.name||""].join(" ")),this.on("dropdown:toggle",function(a){a.toggle?this.$sizesContainer.toggleClass("size-chooser_base",a.sizeSystem):this.reset()},this),this.$(".size-subscribe__step_2").on("submit",_.bind(function(a){a.preventDefault(),this._submit()},this))},_initDOM:function(){this.$sizesContainer=this.$(".size-subscribe__sizes"),this.$sizes=[],this.$result=this.$(".size-subscribe__step_3")},_selectSize:function(a){var b=$(a.currentTarget);b.hasClass("button_pressed")||this.sku||(b.addClass("button_pressed"),this.sku=b.data("sku"),_.delay(_.bind(function(){this.$el.addClass("size-subscribe_step-2")},this),300))},_submit:function(){function a(){c.$result.addClass("size-subscribe__step_error").removeClass("size-subscribe__step_loading"),c._xhr=null,LMDA.Events.trigger("missingSizeSubscribeFail")}var b=this.sku||this.productData.sku,c=this;if(!this._xhr&&b&&this.emailWidget.validate().result){this.$el.removeClass("size-subscribe_step-2").addClass("size-subscribe_step-3");var d={email:c.emailWidget.get(),subscription_type:"product",full_sku:b,location:"size_on_pp",source:"",isPartner:LMDA.DATA.user.get("isFromPartner")+""};LMDA.DATA.user.get("affiliates")&&(d.source=LMDA.DATA.user.get("affiliates").source),c._xhr=LMDA.ajax({type:"POST",url:"/subscribe/size/",data:d,dataType:"json",timeout:5e3,success:function(d){return"OK"!==d.status?void a():(c.$result.removeClass("size-subscribe__step_loading"),c._xhr=null,void LMDA.Events.trigger("missingSizeSubscribeDone",{sku:b,title:c.productData.title}))},error:a})}},_getAffiliateSource:function(a){var b=new Date,c=new Date,d="";return a&&a.date&&(c.setTime(1e3*a.date),Math.floor(Date.UTC(c.getFullYear(),c.getMonth(),c.getDate())-Date.UTC(b.getFullYear(),b.getMonth(),b.getDate()))/864e5<=30&&(d=a.source)),d},resetClass:function(){var a=this;this.resetClass=this.sizeChoosingAvailable?function(){a.$sizes.toggleClass("button_pressed",!1),a.$el.toggleClass("size-subscribe_step-2 size-subscribe_step-3",!1)}:function(){a.$el.toggleClass("size-subscribe_step-3",!1),a.$el.toggleClass("size-subscribe_step-2",!0)},this.resetClass()},reset:function(){this.$el.toggleClass("size-subscribe_step-2"),this.sku="",this.$result.toggleClass("size-subscribe__step_error",!1).toggleClass("size-subscribe__step_loading",!0),this.emailWidget.handleErrors(),this.resetClass()}}),function(a,b,c,d){"use strict";LMDA.Views.SizeChooser=LMDA.Views.BaseView.extend({context:"size-chooser",initialize:function(a){var b=a.data||{};a.el&&a.el.length||this.setElement(this.template(b)),b=_.extend(this.$el.data("json"),b),this.model=new LMDA.Models.SizeChooser,this.model.set(this.parseData(b)),this.initDOM(),this.initViews(),this.defineSKU(),this.model.on({"change:size_table_link":function(a,b){this.views.sizeTableLink.update(b)},"change:title":function(a,b){b?this.$title.html(b).toggleClass("hidden",!1):this.$title.toggleClass("hidden",!0)},"change:title_css_modifier":function(a,b){this.$title.attr("class",["size-chooser__title",b?" "+b:"",this.$title.hasClass("hidden")?" hidden":""].join(""))}},this),this.on("error",function(a){"ADD__STOCK_IS_NOT_ENOUGH"==a.code&&this.views.sizes.disableItem(a,{informer:a._informer})},this)},parseData:function(a){return a},initDOM:function(){this.$title=this.$(".size-chooser__title"),this.$sizeSystem=this.$(".size-chooser__system"),this.$sizeSystemSingle=this.$sizeSystem.find(".size-chooser__system-single"),this.$sizeSystemSelect=this.$sizeSystem.find(".size-chooser__system-select")},initViews:function(){var a=this.model.attributes;this.views.sizes=new LMDA.Views.Sizes({el:this.$(".size-chooser__list"),model:this.model}),this.views.sizes.on({size_selected:function(a){var b=this.getSizeSystem();this.log("size_selected",{sku:a.sku,stock:a.stock,size_system:b,size:a[b==this.model.get("size_system")?"size":"brand_size"]})}},this),a.size_system!=a.brand_size_system&&(this.initSizeSystemView(),this.updateSizeSystemView()),this.views.sizeTableLink=new LMDA.Views.SizeTableLink({el:this.$(".size-chooser__table-link"),parentModel:this.model}),this.$el.removeClass("size-chooser_preload")},toggleTwoSizeMode:function(a){var b=this.model.attributes;this.$el.toggleClass("size-chooser__two-size",b.size_system!=a&&_.indexOf(["shoes","men_clothes","women_clothes","boys_clothes","girls_clothes"],b.type)>=0)},initSizeSystemView:function(){this.$sizeSystemSelect.find(".select").length||this.$sizeSystemSelect.html(LMDA.Templates.Controls.Select({name:"sizesystem"})),this.views.sizeSystem=new LMDA.Forms.WidgetView({el:this.$sizeSystemSelect,name:"sizesystem",type:LMDA.Forms.Types.SELECT}),this.views.sizeSystem.on("change:widget",function(a,b){this.$el.toggleClass("size-chooser_base",b.value==this.model.get("size_system")),LMDA.localStorage.setItem("selected.sizesystem",b.value),this.model.set("active_size_system",b.value)},this)},updateSizeSystemView:function(){var a=this.model.attributes,b,c,d;a.size_system!=a.brand_size_system&&a.type?(b=this.defineActiveSizeSystem(),this.views.sizeSystem||this.initSizeSystemView(),c=b==a.size_system,d=[{checked:c,value:a.size_system,label:[a.size_system_name," размер (",a.size_system_abbr,")"].join("")},{checked:!c,value:a.brand_size_system,label:["Размер производителя (",a.brand_size_system_abbr,")"].join("")}],this.views.sizeSystem.updateOptions(d),this.views.sizeSystem.set(d[c?0:1]),this.$sizeSystem.toggleClass("size-chooser__system_single",!1)):(this.$sizeSystemSingle.html(["Размер: ",a.brand_size_system_name,"(",a.brand_size_system_abbr,")"].join("")),this.$sizeSystem.toggleClass("size-chooser__system_single",!0))},defineActiveSizeSystem:function(){return LMDA.localStorage.getItem("selected.sizesystem")||this.model.get("active_size_system")},defineSKU:function(){var a=LMDA.Utils.getUrlParam("sku"),b=this.getSizes(!0);1==b.length?b[0].model.set("selected",!0):!this.getSelectedSKU()&&a&&this.views.sizes.selectItem(a)},chooseSize:function(a){var b=this.getSizes(a);!b||b.disabled||b.selected||this.views.sizes.selectItem(a)},getSelectedSKU:function(){return this.model.get("selected_sku")||this.views.sizes.getSelectedItem().sku},getSizes:function(a){var b=this.views.sizes.getAllItems();return"boolean"==typeof a?_.filter(b,function(b,c){return b.get("disabled")==!a}):"all"==a?b:_.find(b,function(b,c){return a==c})},getSizeSystem:function(){return this.model.get("active_size_system")||this.model.get("size_system")},get123StockSizes:function(){var a=this.views.sizes.getAllItems(),b;return _.filter(a,function(a){return b=a.get("stock"),b>0&&4>b})},getStock:function(a){var b=this.views.sizes.getAllItems()[a];return b?b.get("stock"):!1},getData:function(){return this.model.attributes},update:function(a){var b=this.parseData(a);this.model.set(b),this.toggleTwoSizeMode(b.brand_size_system),this.updateSizeSystemView(),b.items&&this.views.sizes.update(b.items)},reset:function(){this.model.set("selected_sku",""),this.views.sizes.reset(),this.trigger("reset")},template:LMDA.Templates.SizeChooser})}(window,document,document.body),function(a,b,c,d){"use strict";var e=!1;LMDA.Views.SizeChooserDropdown=LMDA.Views.BaseView.extend({context:"size-chooser-dropdown",initialize:function(a){var b=this;a=a||{},this.setElement(this.template()),LMDA.Events.on({"size-chooser-dropdown:open_call":function(a){e||(b.initViews(),a.splitDesign&&b.$el.addClass("size-chooser-dropdown_ii")),a.product&&b.views.sizeChooser.update(a.product),b.toggle(!0),a.position&&b.position(a.position,a.square)},"size-chooser-dropdown:close_call":function(){b.toggle()}})},initViews:function(){e=!0,this.views.sizeChooser=new LMDA.Views.SizeChooser({el:this.$(".size-chooser")}),this.$el.html(this.views.sizeChooser.$el),this.views.sizeChooser.on("size_selected",function(a){var b=this.views.sizeChooser.getSizes(a.sku).$el,c=new LMDA.Utils.ButtonPreloader(b);$.when(LMDA.API.Cart.addToCart(a.sku,{source:"add_size_on_cart"})).then(_.bind(function(a){c.stop(),this.toggle()},this),_.bind(function(a){c.stop(),a._informer=!0,this.views.sizeChooser.trigger("error",a)},this))},this)},position:function(c){var d=LMDA.Utils.getElementsDimensions(this.$el).height,e=LMDA.$window.height(),f=a.pageYOffset||b.documentElement.scrollTop,g=c.bottom;0>e+f-(g+d)?(g=c.top-d,this.$el.toggleClass("size-chooser-dropdown_top",!0)):this.$el.toggleClass("size-chooser-dropdown_top",!1),this.$el.css({top:g+"px",left:c.left+"px"})},toggle:function(a){this.$el.toggleClass("size-chooser-dropdown_opened",!!a),a||(this.$el.css("top","-100px"),LMDA.Events.trigger("size-chooser-dropdown:close"))},template:_.template('<div class="dropdown size-chooser-dropdown"></div>')})}(window,document,document.body),function(a,b,c,d){"use strict";LMDA.Views.BuyWidget=LMDA.Views.BaseView.extend({el:".buy-widget",context:"buy-widget",events:{"click .buy-widget__buy:not(.buy-widget__buy_disabled)":"addToCart","click .buy-widget__veil":function(){this.toggleVeil()}},INFORMER_DELAY:1500,initialize:function(a){this.initDOM(),this.productData=a.product,this.viewsInit()},initDOM:function(){this.$buyContainer=this.$(".buy-widget__buy"),this.$buyButton=this.$buyContainer.find(".button"),this.$informer=this.$(".buy-informer"),this.$stock123=this.$(".size-chooser__stock123"),this.$stock123.length&&(this.$stock123Value=this.$stock123.find(".js-stock123-value"),this.toggleStock123=this._toggleStock123)},viewsInit:function(){var a=this.$buyContainer.data("sku"),b=this.$(".size-subscribe"),c=[];a?(this.noSizeSKU=a,this.$masterCard=this.$(".price__mastercard")):(this.views.sizeChooser=new LMDA.Views.SizeChooser({el:this.$(".size-chooser"),data:{size_table_link:this.productData.size_table_link}}),this.views.sizeChooser.on("size_selected",function(a){this.toggleStock123(a.stock),this.log("select_size",a)},this),a=this.views.sizeChooser.getSelectedSKU(),a?this.toggleStock123(this.views.sizeChooser.getStock(a)):LMDA.DATA.isExperimentOn("prism_off")||this.getSizeRecommends(),c=this.views.sizeChooser.getSizes(!1)),!b.length||this.isAvailableToBuy()&&!c.length||(this.$el.addClass("buy-widget_bottom-space"),this.views.sizeSubscribe=new LMDA.Views.SizeSubscribe({el:b,productData:a?_.extend({},this.productData,{sku:a}):this.productData,sizes:c}),LMDA.Events.on("dropdown:toggle",function(a){"size_subscribe"==a.name&&this.views.sizeSubscribe.trigger("dropdown:toggle",{toggle:a.toggle,sizeSystem:this.views.sizeChooser?this.views.sizeChooser.getSizeSystem()==LMDA.country.size:!1})},this))},addToCart:function(){var a,b;this.$el.hasClass("buy-widget_choose-size")||(a=this.noSizeSKU||this.views.sizeChooser.getSelectedSKU(),a?(b=new LMDA.Utils.ButtonPreloader(this.$buyButton),b.start(),$.when(LMDA.API.Cart.addToCart(a)).then(_.bind(function(a){b.stop(),this.reset(),this.views.sizeChooser&&this.views.sizeChooser.reset()},this),_.bind(function(a){b.stop(),this.reset(),this.views.sizeChooser&&this.views.sizeChooser.trigger("error",a),this.showInformer(a)},this))):this.toggleVeil(!0))},toggleVeil:function(a){this._toggleVeil(a),a?(LMDA.Events.trigger("size-chooser-dropdown:open_call",{product:_.extend({},this.views.sizeChooser.getData(),{title:"Выберите размер",title_css_modifier:""}),position:LMDA.Utils.getElementsPosition(this.$buyButton,{verticalSquare:32,verticalMargin:20,horizontMargin:-20})}),LMDA.Events.on("size-chooser-dropdown:close",this._toggleVeil,this)):(LMDA.Events.trigger("size-chooser-dropdown:close_call"),LMDA.Events.off("size-chooser-dropdown:close",this._toggleVeil))},_toggleVeil:function(a){this.$el.toggleClass("buy-widget_choose-size",!!a)},showInformer:function(a){var b=a.message;this.noSizeSKU&&(b=b.replace(/размера/g,"продукта")),this.$informer.addClass("buy-informer_visible").find(".buy-informer__title").html(b),_.delay(_.bind(this.hideInformer,this),this.INFORMER_DELAY),LMDA.z("cart_add",{result:"failed",error_code:a.code,sku:a.sku})},hideInformer:function(){this.$informer.removeClass("buy-informer_visible")},toggleStock123:function(){},_toggleStock123:function(a){"number"==typeof a&&a>0&&4>a?(this.$stock123Value.html(a),this.$stock123.toggle(!0),this.$masterCard&&this.$masterCard.removeClass("price__mastercard-mod")):(this.$stock123.toggle(!1),this.$masterCard&&this.$masterCard.addClass("price__mastercard-mod"))},isAvailableToBuy:function(){return!this.$buyContainer.hasClass("buy-widget__buy_disabled")},isStock123:function(){return this.views.sizeChooser?!!this.views.sizeChooser.get123StockSizes().length:!1},reset:function(){this.toggleStock123()},getSizeRecommends:function(){var a=this;LMDA.ajax({url:"/prism/sku-size",data:{lid:LMDA.uidAny,sku:this.productData.sku},dataType:"json",success:function(b){var c,d,e,f=0;if(b.sizes&&b.sizes.length&&(c=a.views.sizeChooser.getSizes(!0),c.length)){for(;!d&&f<b.sizes.length;)e=b.sizes[f],d=_.find(c,function(a){return e==a.get("size")}),f++;d&&a.views.sizeChooser.chooseSize(d.get("sku"))}}})}})}(window,document,document.body),function(a,b,c,d){"use strict";require(["ii/product/post-cart-recommended"],function(a){LMDA.Views.PostCartAdd=LMDA.Views.Popup.extend({el:".post-cart-add",sel:{recommended:".post-cart-add__recommended_wrapper"},additionalEvents:{"click .post-cart-add__close":function(){LMDA.Statistics.report("popup_cart","close_cont")},"click .popup__close":function(){LMDA.Statistics.report("popup_cart","close_cross")},"click .post-cart-add__basket, .post-cart-add__view-cart":function(){LMDA.Statistics.report("popup_cart","close")},"click .js-button-upselling-buy:not(.button_disabled)":function(a){this.buyUpselling(a)}},init:function(){return this.addedSku="",this.addFromElement="post-cart-popup",_.contains(window.location.pathname,"/checkout/cart")?!1:void LMDA.Events.on(LMDA.Events.CART_ADD,function(b){var c=this.addFromElement===b.addFromElement;if(!c){var d=b.product,e=b.charity||"",f=b.upselling||"",g="",h="",i="",j="",k=!1,l=!1,m,n=LMDA.DATA.isExperimentOn("UI10109_charity"),o=LMDA.DATA.isExperimentOn("UI10461_upselling"),p,q;this.cart=b.cart,this.items=_.reduce(this.cart.packages,function(a,b){return a.concat(b.items)},[]),this.addedSku=b.sku,this.addedSku12=d.sku12,g=LMDA.Templates.CartPopupItem({img_size:"medium",css_modifier:"cart-item_added",sku:d.sku12,full_sku:d.sku16,img:d.img,title:d.title,brand:d.brand,last:d.last,is_in_stock:d.is_in_stock,quantity:d.quantity,brand_size_system:d.brand_size_system,brand_size:d.brand_size,size_system:LMDA.sizeSystem,size:d.size,out_of_stock:d.out_of_stock,is_not_sellable:d.is_not_sellable||!1,url:d.url,category_url:d.category_url||"/",price:LMDA.Utils.formatPrice(d.price,LMDA.country.currency,!0),original_price:d.original_price?"by"===LMDA.country.site?LMDA.Utils.formatPrice(d.original_price,null,!0):LMDA.Utils.formatPrice(d.original_price,LMDA.country.currency):0}),this.items.length>1&&(i=_.reduceRight(this.items,function(a,b){return b.sku16!==this.addedSku?(b.out_of_stock||b.is_not_sellable?l||(l=!0):k||(k=!0),a+LMDA.Templates.CartPopupItem({img_size:"small",css_modifier:"",sku:b.sku12,full_sku:b.sku16,img:b.img,title:b.title,brand:b.brand,last:b.last,is_in_stock:b.is_in_stock,quantity:b.quantity,brand_size_system:b.brand_size_system||"",brand_size:b.brand_size||"",size_system:LMDA.sizeSystem,size:b.size,out_of_stock:b.out_of_stock,is_not_sellable:b.is_not_sellable||!1,url:b.url,category_url:b.category_url||"/",price:LMDA.Utils.formatPrice(b.price,LMDA.country.currency,!0),original_price:b.original_price?"by"===LMDA.country.site?LMDA.Utils.formatPrice(b.original_price,null,!0):LMDA.Utils.formatPrice(b.original_price,LMDA.country.currency):0})):a},"",this),h='<div class="post-cart-add__cart-attention">'+(k?'<div class="post-cart-add__in-stock-title">Также в вашей корзине</div>'+(l?'<span class="post-cart-add__out-of-stock">Некоторых товаров уже нет в наличии</span>':""):l?'<div class="post-cart-add__out-of-stock">Внимание, некоторых товаров из вашей корзины больше нет в наличии!</div>':"")+'</div><div class="post-cart-add__cart-list">'+i+"</div>"),m=1===this.items.length,n&&o?m&&e?(p=e,q=!0):f&&(p=f,q=!1):o&&f?(p=f,q=!1):n&&m&&e&&(p=e,q=!0),p&&(j=LMDA.Templates.PostCartCharityUpselling(_.extend({product:p,isCharity:q,price:LMDA.Utils.formatPrice(p.price.value,LMDA.country.currency),url:p.url,img:p.img,title:p.title,brand:p.brand,sku:p.sku},LMDA.Templates.PostCartCharityUpsellingVars(p,LMDA.country.site)))),this.$content.html(LMDA.Templates.PostCartAddPopup({quantity_string:this.cart.quantity+" "+LMDA.Utils.pluralize(this.cart.quantity,"товар","товара","товаров"),sku:this.addedSku,items_list:g+j+h})),p&&new a({$container:this.$content.find(this.sel.recommended),product:p,addFromElement:this.addFromElement}),this.isActive()?this.adaptSize():this.open(),LMDA.DATA.isExperimentOn("UI5315_Upselling2")&&(this.getUpselling(this.addedSku12,LMDA.Templates.PostCartUpsellingBlock),this.adaptSize())}},this)},outSideCLick:function(a){$(a.target).hasClass("popup")&&(this.close(a),LMDA.Statistics.report("popup_cart","close_empty"))}})})}(window,document,document.body),LMDA.Views.MarketingPopup=LMDA.Views.Popup.extend({el:".overlay-popup",init:function(){window.LMDA.exports.closeMarketingPopup=_.bind(function(a){this.close({},a)},this),window.LMDA.exports.minimizeMarketingPopup=_.bind(function(){this.$el.addClass("overlay-popup_finish")},this)},close:function(a,b){(b||a&&a.target)&&LMDA.Events.trigger("marketingpopup:close"),LMDA.Views.Popup.prototype.close.apply(this,arguments)}}),function(a,b,c,d){"use strict";LMDA.Views.Zoom=LMDA.Views.BaseView.extend({el:".zoom",context:"zoom",DEFAULT_GEOMETRY:{magnifier:{width:258,height:218},baseImage:{width:320,height:461},bigImage:{width:762,height:1100},zoom:{width:635,height:547}},initialize:function(){this.el&&(this.isBlocked=!1,this.$zoomBigImg=this.$(".zoom__big-image"),this.$area=this.$el.siblings(".product-zoom"),this.applyEvents(),this.setGeometry(this.DEFAULT_GEOMETRY),LMDA.isTouch&&(this._getXCoord=this._getTouchXCoord,this._getYCoord=this._getTouchYCoord))},setGeometry:function(a){var b=this.$area.offset();this.geometry={magnifier:{width:a.magnifier.width,height:a.magnifier.height},admissibleSpace:{width:a.baseImage.width-a.magnifier.width,height:a.baseImage.height-a.magnifier.height},magnifierHalf:{width:b.left+a.magnifier.width/2,height:b.top+a.magnifier.height/2}},this.setMvFactor(a)},applyEvents:function(){this.$area.on(LMDA.isTouch?"touchstart":"mouseover",_.bind(this.show,this)),this.$area.on(LMDA.isTouch?"touchmove":"mousemove",_.bind(this.mouseMove,this)),this.$area.on("mouseleave",_.bind(this.hide,this)),this.$area.on("touchstart",function(a){a.stopPropagation()}),LMDA.Events.on("body:tap",_.bind(this.hide,this))},setMvFactor:function(a){this.mvFactor={x:(a.bigImage.width-a.zoom.width)/this.geometry.admissibleSpace.width,y:(a.bigImage.height-a.zoom.height)/this.geometry.admissibleSpace.height}},setImage:function(a,b,c){if(!this.isBlocked){var d=new Image,e=this,f={bigImage:{width:null,height:null}};
d.onload=function(){f.bigImage.width=b||this.width,f.bigImage.height=c||this.height,e.setMvFactor(_.extend(e.DEFAULT_GEOMETRY,f)),e.$zoomBigImg.attr("src",a)},d.src=a,this.currentImageData={url:a}}},mouseMove:function(a){if(!this.isBlocked){var b=this._getXCoord(a)-this.geometry.magnifierHalf.width,c=this._getYCoord(a)-this.geometry.magnifierHalf.height;this.setPos(b,c,!1),a.preventDefault()}},setPos:function(a,b){a=LMDA.Views.Zoom.limitDemention(a,this.geometry.admissibleSpace.width),b=LMDA.Views.Zoom.limitDemention(b,this.geometry.admissibleSpace.height),this.$zoomBigImg.css({top:-(b*this.mvFactor.y)+"px",left:-(a*this.mvFactor.x)+"px"})},show:function(a){this.isBlocked||(a&&"touchstart"===a.type&&this.setPos(this._getXCoord(a)-this.geometry.magnifierHalf.width,this._getYCoord(a)-this.geometry.magnifierHalf.height,!1),this.$el.show(),this.$el.animate({opacity:1},{duration:400,easing:"linear",queue:!1}),this.log("show",this.currentImageData))},hide:function(){this.$el.hide(),this.$el.css({opacity:0}),this.log("hide",this.currentImageData)},lift:function(){this.isBlocked=!1},hold:function(){this.isBlocked=!0},_getXCoord:function(a){return a.pageX},_getTouchXCoord:function(a){return a.originalEvent?a.originalEvent.touches[0].pageX:a.targetTouches[0].pageX},_getYCoord:function(a){return a.pageY},_getTouchYCoord:function(a){return a.originalEvent?a.originalEvent.touches[0].pageY:a.targetTouches[0].pageY}}),LMDA.Views.Zoom.limitDemention=function(a,b){return 0>a?0:a>b?b:a}}(window,document,document.body),LMDA.Views.View3D=Backbone.View.extend({el:".product-zoom",events:{},initialize:function(){this.isBlocked=!1,this.hintTimeout=0,this.math={containerX:this.$el.offset().left,x0:0,speed:6,frames:24,step:320},this.math.limit=this.math.step*this.math.frames,this.$hint=this.$(".product-zoom__3d"),this.$img=this.$(".product-photos__3d").css("left",0),_.bindAll(this,"_drag","_stopDrag"),LMDA.isTouch?(this.events.touchstart=this._startDrag,this._startListening=this._startTouchListening,this._stopListening=this._stopTouchListening,this._getXCoord=this._getTouchXCoord,this.$(".product-zoom__3d").addClass("product-zoom__3d_touch")):this.events.mousedown=this._startDrag},init:function(a){if(!this.isBlocked)if(this.img)this._initHint();else{this.$el.addClass("product-zoom_loaded");var b=new Image,c=this;b.onload=function(){c.img=a,c.$img.attr("src",a),c.$el.removeClass("product-zoom_loaded"),c._initHint()},b.src=a}},_startDrag:function(a){this.isBlocked||(a.preventDefault(),this.hintTimeout&&(window.clearTimeout(this.hintTimeout),this._hideHint()),this._startListening(),this.math.x0=this._getXCoord(a),this.math.startPosition=parseFloat(this.$img.css("left")))},_drag:function(a){a.preventDefault();var b=this._getXCoord(a),c=this.math.limit-this.math.step,d=b-this.math.x0,e=0>d?-1:1,f=Math.ceil(Math.abs(d)/this.math.speed),g=e*f*this.math.step+this.math.startPosition;g>0?g=g%this.math.limit-this.math.limit:-1*g>c&&(g%=this.math.limit),this.$img.css("left",g)},_stopDrag:function(a){this._stopListening()},_initHint:function(){this.hintTimeout&&window.clearTimeout(this.hintTimeout),this._showHint(),this.hintTimeout=window.setTimeout(_.bind(this._hideHint,this),5e3)},_showHint:function(){this.$hint.toggleClass("product-zoom__3d_visible",!0)},_hideHint:function(){this.$hint.toggleClass("product-zoom__3d_visible",!1)},lift:function(a){this.isBlocked=!1,this.init(a)},hold:function(){this.isBlocked=!0,this.hintTimeout&&(window.clearTimeout(this.hintTimeout),this._hideHint())},_startListening:function(){this.$el.on("mousemove",this._drag),this.$el.on("mouseleave",this._stopDrag),this.$el.on("mouseup",this._stopDrag)},_stopListening:function(){this.$el.off("mousemove",this._drag),this.$el.off("mouseleave",this._stopDrag),this.$el.off("mouseup",this._stopDrag)},_startTouchListening:function(){this.$el.on("touchmove",this._drag),this.$el.on("touchend",this._stopDrag)},_stopTouchListening:function(){this.$el.off("touchmove",this._drag),this.$el.off("touchend",this._stopDrag)},_getXCoord:function(a){return a.pageX},_getTouchXCoord:function(a){return a.originalEvent?a.originalEvent.touches[0].pageX:a.targetTouches[0].pageX}}),LMDA.Views.ProductVideo=Backbone.View.extend({events:{},initialize:function(){this.$iframe=this.$(".product-photos__video-iframe")},hold:function(){this.$iframe.attr("src","")},lift:function(a){this.$iframe.attr("src",a)}}),function(a,b,c){LMDA.Views.ProductImages=LMDA.Views.BaseView.extend({el:".product-photos",context:"productImages",events:{"click .photos-list__item":"setImg","mouseenter .photos-list__item":"setImg","touchstart .photos-list":function(a){a.stopPropagation()}},DEFAULT_GEOMETRY:{width:320,height:461},initialize:function(){this.$photoContainer=this.$(".product-zoom"),this.$photo=this.$photoContainer.find(".product-photos__big"),this.$icons=this.$(".photos-list__item"),this.photoContainerClass="product-zoom",this.img=this.$(".product-photos__big").data("orig"),this.geometry={},this.setGeometry()},setGeometry:function(a){_.extend(this.geometry,a||this.DEFAULT_GEOMETRY),this.geometry.urlPart="img"+this.geometry.width+"x"+this.geometry.height},setImg:function(a){var b=$(a.currentTarget),c=b.data("type"),d=b.hasClass("photos-list__item_selected");this.img=b.data("orig"),this.trigger("itemchanged",this.$photo),"zoom"==c?(this.$photoContainer.toggleClass("product-zoom_3d product-zoom_video",!1),this.$photo.attr("src",this.img),this.trigger("setimage:zoom",this.getDataOrig())):"3d"==c?(this.$photoContainer.toggleClass("product-zoom_3d",!0).toggleClass("product-zoom_video",!1),d||this.trigger("setimage:3d",this.getDataOrig())):(this.$photoContainer.toggleClass("product-zoom_video",!0).toggleClass("product-zoom_3d",!1),this.trigger("setimage:video",this.getDataOrig(),b.data("poster"),{width:this.geometry.width,height:this.geometry.height})),d||(this.$icons.removeClass("photos-list__item_selected"),b.addClass("photos-list__item_selected")),"click"===a.type&&(this.log("click",{$el:b,img:this.img}),this.$el.undelegate(".photos-list__item","mouseenter"))},getDataOrig:function(){return this.img&&this.img.replace(this.geometry.urlPart,"product")||""}})}(window,document),function(a,b,c,d){"use strict";LMDA.Views.Slider=LMDA.Views.BaseView.extend({context:"slider",events:{mouseover:"hold",mouseout:"lift"},initialize:function(a){var b=this,c={selArrow:".js-slider-arrow",selControl:".js-slider-control",selItem:".js-slider-item",cnViewport:"js-slider-viewport",cnArrowDisabled:"button_disabled",cnBlocked:"js-slider-blocked",cnActiveControl:"js-slider-control_active"};if(this.o=$.extend(!0,c,a),a.context&&(this.context=a.context+":"+this.context),this.$viewport=this.$el.hasClass(this.o.cnViewport)?this.$el:this.$("."+this.o.cnViewport),this.$list=this.$(".js-slider-list").css("left",0),this.$item=this.getItems(),this.checkItems(this.$item),!this.$el.hasClass(this.o.cnBlocked)&&this.$viewport.length&&this.$list.length&&this.$item.length){if(this.$controls=this.$el.find(this.o.selControl).on("click.Slider",function(){b.controlClick.apply(b,arguments)}),this.$arrows=this.$el.find(this.o.selArrow).on("click.Slider",function(){b.arrowClick.apply(b,arguments)}),this.$arrowPrev=this.$arrows.filter('[data-direction="-1"]'),this.$arrowNext=this.$arrows.filter('[data-direction="1"]'),a.flexible&&LMDA.$window.on("resize.Slider",function(){b.resizeContext()}),this.step=this.getWidth(this.$item)+(parseInt(this.$item.css("margin-left"),10)||0)+(parseInt(this.$item.css("margin-right"),10)||0),this.slidesInViewport=Math.ceil(this.getWidth(this.$viewport)/this.step),this.stepLimit=this.$item.length-this.slidesInViewport,this.slideBy=1,this.looped=!0,a.mode)switch(a.mode){case"fullWidth":this.looped=!1,this.slideBy=this.slidesInViewport;break;case"keepButtons":this.looped=!1}if(this.$item.length<this.slidesInViewport)this.sliderOff();else{if(this.activeSlide=0,this.nextSlide=0,this.isSliding=!1,("inherit"==this.$list.css("position")||"static"==this.$list.css("position"))&&this.$list.css("position","relative"),"carousel"==a.type&&this.looped?(this.$item=this.$item.add(this.$item.slice(0,this.slidesInViewport).clone().data("id","").appendTo(this.$list)),this.carousel=!0,this.stepLimit+=this.slidesInViewport,this.afterSlide=this.afterSlideCarousel,this.beforeSlide=this.beforeSlideCarousel):"fader"==a.type?(this.FADER_OFFSET_MARGIN=-32768,this.$item.css("marginLeft",this.FADER_OFFSET_MARGIN).first().css("marginLeft","auto"),this.slideMechanism=this.fadeMechanism,this.slideMethodAnimate=this.fadeMethodAnimate):this.hideArrowPrev(),a.start){var d="random"==a.start.position?Math.floor(Math.random()*this.$item.length):a.start.position;this.slide("auto",d),LMDA.Events.trigger(a.start.event,d)}a.animation&&(this.animation=!0,this.animateDuration=a.animation.duration||0,this.animateEasing=a.animation.easing||"linear",this.slideMethod=this.slideMethodAnimate),a.autoSliding&&(this.autoSliding=!0,this.autoSlidingBlocked=!1,this.slidingInterval=a.autoSliding.interval,this.autoSlidingInit()),a.controlsHover&&(this.$controlHovered="",this.hoverTimeout=0,this.events["mouseover .js-slider-control"]=this.controlMouseEnter,this.events["mouseout "+a.controlsHover]=_.bind(function(b){$(b.relatedTarget).closest(a.controlsHover).length||(this.$controlHovered="")},this))}}},getItems:function(){return this.$el.find(this.o.selItem)},checkItems:function(a){var b=0;_.each(a,function(a){""!=a.innerHTML&&b++}),b>1?this.$el.removeClass(this.o.cnBlocked):this.$el.addClass(this.o.cnBlocked)},arrowClick:function(a){if(a&&a.preventDefault(),this.isSliding)return!1;var b=$(a.currentTarget);return b.hasClass(this.o.cnArrowDisabled)?!1:(this.isSliding=this.animation,this.autoSlidingBlocked=!0,void this.slide(b.data("direction"),1))},controlClick:function(a){var b=$(a.currentTarget);this.isSliding||b.hasClass(this.o.cnActiveControl)||(this.isSliding=this.animation,this.autoSlidingBlocked=!0,this.slide("auto",parseInt(b.data("for"),10)))},controlMouseEnter:function(a){this.$controlHovered=$(a.currentTarget),this.hoverTimeout&&clearTimeout(this.hoverTimeout),this.hoverTimeout=setTimeout(_.bind(function(){var a=this.$controlHovered;this.isSliding||!a||a.hasClass(this.o.cnActiveControl)||(this.isSliding=this.animation,this.autoSlidingBlocked=!0,this.slide("auto",parseInt(a.data("for"),10)))},this),200)},slide:function(a,b){"auto"==a?this.nextSlide=b:(this.nextSlide=a*b+this.activeSlide,this.nextSlide+=(this.slideBy-1)*a,this.nextSlide>this.stepLimit?this.looped?(this.nextSlide%=this.stepLimit,this.nextSlide-=1,this.nextSlide=Math.max(0,this.nextSlide)):this.nextSlide=this.stepLimit:this.nextSlide<0&&(this.looped?(this.slideMechanism(this.stepLimit),this.nextSlide+=this.stepLimit):this.nextSlide=0)),this.trigger("slider:next",this.nextSlide),this.log("change",{slide:this.nextSlide,total:this.stepLimit}),this.slideMethod(this.nextSlide),this.$controls.length&&($(this.$controls[this.activeSlide]).removeClass(this.o.cnActiveControl),$(this.$controls[this.nextSlide]).addClass(this.o.cnActiveControl)),this.activeSlide=this.nextSlide},slideMethod:function(a){this.slideMechanism(-this.$item[a].offsetLeft),this.afterSlide()},slideMethodAnimate:function(a){this.$list.animate({left:-this.$item[a].offsetLeft},this.animateDuration,this.animateEasing,_.bind(function(){this.afterSlide(),this.isSliding=!1},this))},slideMechanism:function(a){this.$list.css("left",-this.$item[a].offsetLeft)},fadeMethodAnimate:function(a){var b=this.$item.eq(this.activeSlide),c=this.$item.eq(this.nextSlide);b.css("z-index",0).animate({opacity:0},this.animateDuration,this.animateEasing,_.bind(function(){b.css({marginLeft:this.FADER_OFFSET_MARGIN,visibility:"hidden"}),this.isSliding=!1},this)),c.css({marginLeft:"auto","z-index":1,visibility:"visible"}).animate({opacity:1},this.animateDuration,this.animateEasing,_.bind(function(){},this))},fadeMechanism:function(a){var b=this.$item.eq(this.activeSlide),c=this.$item.eq(this.nextSlide);b.css({"z-index":0,opacity:0,visibility:"hidden"}),c.css({"z-index":1,opacity:1,visibility:"visible"})},beforeSlide:function(){return this.stepLimit},afterSlide:function(){this.activeSlide>0?this.showArrowPrev():this.hideArrowPrev(),this.activeSlide!==this.stepLimit?this.showArrowNext():this.hideArrowNext()},beforeSlideCarousel:function(){return this.$list.css("left",-1*this.stepLimit*this.step),this.stepLimit-1},afterSlideCarousel:function(){this.activeSlide==this.stepLimit&&(this.$list.css("left",0),this.activeSlide=0)},autoSlidingInit:function(){this.autoSlidingID=window.setInterval(_.bind(function(){this.autoSlidingBlocked?this.autoSlidingBlocked=!1:(this.isSliding=this.animation,this.slide(1,1))},this),this.slidingInterval)},reset:function(){this.slideMethod(0),this.activeSlide=0,this.autoSliding&&(clearInterval(this.autoSlidingID),this.autoSlidingBlocked=!1,this.autoSlidingInit())},sliderOff:function(){this.$el.addClass(this.o.cnBlocked)},hold:function(){this.autoSliding&&clearInterval(this.autoSlidingID)},lift:function(){this.autoSliding&&(this.autoSlidingBlocked=!1,this.autoSlidingInit())},getWidth:function(a){return a.outerWidth?a.outerWidth():a.width()},resizeContext:function(){this.step=LMDA.$window.width(),this.slideMechanism(this.nextSlide)},showArrowNext:function(){return this.o.mode&&"keepButtons"===this.o.mode?this.$arrowNext.removeClass(this.o.cnArrowDisabled):this.$arrowNext.show()},hideArrowNext:function(){return this.o.mode&&"keepButtons"===this.o.mode?this.$arrowNext.addClass(this.o.cnArrowDisabled):this.$arrowNext.hide()},showArrowPrev:function(){return this.o.mode&&"keepButtons"===this.o.mode?this.$arrowPrev.removeClass(this.o.cnArrowDisabled):this.$arrowPrev.show()},hideArrowPrev:function(){return this.o.mode&&"keepButtons"===this.o.mode?this.$arrowPrev.addClass(this.o.cnArrowDisabled):this.$arrowPrev.hide()}})}(window,document,document.body),function(a,b,c,d){"use strict";LMDA.Views.Tabs=LMDA.Views.BaseView.extend({el:".tabs",context:"tabs",events:{},initialize:function(a){if(this.$el&&this.$el.length){var b=this;a=a||{},this.selTab=a.tab||".tabs__item",this.dataTabId="tab",this.cnTabActive=a.activeClass||"button_pressed",this.cnBlockHidden="hidden",this.activeTab=0,this.tabsMap={},this.blocks=a.blocks||[this.$(".tabs__block")],this.$tabs=this.$el.find(this.selTab).on("click.Tabs",function(){b.onTabClick.apply(b,arguments)}).each(function(a,c){var d=$(c),e=d.data(b.dataTabId)||a;b.tabsMap[e]={index:a,$el:d}}),a.context&&(this.context=a.context+":"+this.context),a.activeTab&&this.setActive(a.activeTab),this.setActive(LMDA.Utils&&LMDA.Utils.pushStater.get("tabs")),LMDA.Events.on("pushStater:tabs",function(a){b.setActive(a.newValue)})}},onTabClick:function(a){return this.setActive($(a.currentTarget).data(this.dataTabId)||$(a.currentTarget).index())},setActive:function(a){if(this.tabsMap[a]){this.activeTab=a;var b=this,c=$(),d=this.tabsMap[a];return this.$tabs.removeClass(this.cnTabActive),d.$el.addClass(this.cnTabActive),this.blocks.length&&_.each(this.blocks,function(a){a.addClass(b.cnBlockHidden),c=c.add(a.eq(d.index).removeClass(b.cnBlockHidden))}),this.log("change",{activeTab:this.activeTab,$el:d.$el,$block:c}),!0}}})}(window,document,document.body),LMDA.Views.SliderTouch=Backbone.View.extend({initialize:function(a){var b=this,c={"default":{bounce:!1,momentum:!1,onScrollEnd:function(){b.trigger("scrollEnd")}},carousel:{eventPassthrough:!0,scrollX:!0,scrollY:!1}},d=a.type||"carousel",e=_.extend(c["default"],c[d]);this.animation=a.animation||{},this.animation.duration=this.animation.duration||400,this.DOMInit()&&(this.step=a.step||this.getItems().width(),this.slider=new LMDA.iScroll(this.$viewport.get(0),e),this.$(".js-slider-arrow").on("click",_.bind(this.arrowClick,this)))},DOMInit:function(){return this.$viewport=this.$el.hasClass("js-slider-viewport")?this.$el:this.$(".js-slider-viewport"),this.$list=this.$viewport,this.$item=this.getItems(),this.$viewport.length*this.$item.length>0},getItems:function(){return this.$(".js-slider-item")},arrowClick:function(a){var b,c=$(a.currentTarget).data("direction");0==this.slider.x&&-1==c||this.slider.x==this.slider.maxScrollX&&1==c||(b=this.$item.get(this.getIsFirstVisible()+c),this.slider.scrollToElement(b,this.animation.duration))},getIsFirstVisible:function(){return-Math.floor(this.slider.x/this.step)}}),function(a,b,c,d){"use strict";LMDA.Views.Footer=LMDA.Views.BaseView.extend({el:".footer__sticky",context:"footer",initialize:function(){var a=this,b,c,d;return this.$el.length?(b=$(".subscription_footer"),c=$(".footer-float__subscribe"),b.length&&c.length&&(this.views.footerSubscription=new LMDA.Views.SubscriptionPopup({el:b,$trigger:c,direction:"up"}),this.views.footerSubscription.on("show",function(a){LMDA.z("subscription_bottom_popup",{mlocation:a.options.location})})),this.initHelpPopup(),d=this.$(".footer__sticky-go-top"),void(d.length&&(d.on("click.Footer",function(a){LMDA.Utils.scrollToTop(a),LMDA.Statistics.report("footerHelp","scrollTop")}),LMDA.Utils.onScroll("y",function(a){LMDA.Utils.onScroll.paint(function(){a>300?d.addClass("footer__sticky-go-top_enabled"):200>a&&d.removeClass("footer__sticky-go-top_enabled")})})))):!1},initHelpPopup:function(){this.helpHintTimer=0,this.$help=this.$(".js-footer-help-link"),this.helpHintSelector=".js-footer-help-hint",this.$helpHint=this.$(this.helpHintSelector),this.views.helpPopup=new LMDA.Views.HelpPopup({el:$(".help-popup")}),this.showHelpPopup=function(a){a.preventDefault(),this.views.helpPopup.open()},this.toggleHelpHint=function(a){this.$helpHint.toggle(a)},this.$helpHint.on("click",_.bind(function(){this.toggleHelpHint(!1)},this)),this.views.helpPopup.on("form:success",this.showHelpHint,this),this.$help.on("click",_.bind(this.showHelpPopup,this)),LMDA.Events.on("header:ask-question",this.views.helpPopup.open,this.views.helpPopup)},showHelpPopup:function(a){var b=$(a.target).closest(this.helpHintSelector);a.preventDefault(),b.length?(this.helpHintTimer&&window.clearTimeout(this.helpHintTimer),this.toggleHelpHint(!1)):this.views.helpPopup.open()},showHelpHint:function(){this.toggleHelpHint(!0),this.helpHintTimer=window.setTimeout(_.bind(function(){this.toggleHelpHint(!1)},this),1e4)},toggleHelpHint:function(a){this.$helpHint.toggleClass("hint_visible",a)}}),new LMDA.Views.Footer}(window,document,document.body),function(a,b,c){function d(a){var b={UI10202_0sec_all:{type:"all",time:0},UI10202_5sec_all:{type:"all",time:5e3},UI10202_5sec_gender:{type:"gender",time:5e3},UI10202_10sec_catalog:{type:"catalog",time:1e4}},c="all",d,e=function(){window.setTimeout(function(){if(!$("input").is(":focus")){var b=new Date((new Date).getTime()+106272e5);document.cookie="overlay_exit=1;expires="+b.toGMTString()+"; path=/;",a.open(),LMDA.Statistics.report("overlay","open")}},d.time)};return LMDA.DATA.isExperimentOn("UI10202_no_popup")?!1:(d=_.find(b,function(a,b){return LMDA.DATA.isExperimentOn(b)}),d||(d=b.UI10202_0sec_all,LMDA.experiments.UI10202_0sec_all="1"),(/(men|women)/.test(LMDA.Utils.parseUrl().pathname[0])||/kids-home/.test(LMDA.Utils.parseUrl().pathname[1]))&&(c="gender"),/(c|cs|sp|a|outlet|novinki|b|cb|bg|action)/.test(LMDA.Utils.parseUrl().pathname[0])&&(c="catalog"),void((+LMDA.experiments.UI10202_0sec_all||LMDA.DATA.isExperimentOn("UI10202_5sec_all")||LMDA.DATA.isExperimentOn("UI10202_5sec_gender")&&"gender"===c||LMDA.DATA.isExperimentOn("UI10202_10sec_catalog")&&"catalog"===c)&&e()))}if(LMDA&&LMDA.Events){var e=b.getElementById("overlay");if(!e)return!1;var f=LMDA.Views.Popup.extend({el:e,init:function(){var b=this;if(this.o={sel:{title:"#overlay-header",countdown:"#overlay-countdown",layout:"#overlay-body",footer:"#overlay-footer",form:".subscription",message:"#overlay-message",disclaimer:".overlay-footer-disclaimer"},cn:{hidden:"hidden",initialView:"overlayinitialview"}},this.$countdown=this.$el.find(this.o.sel.countdown),this.$message=this.$el.find(this.o.sel.message),this.$footer=this.$el.find(this.o.sel.footer),this.$layout=this.$el.find(this.o.sel.layout),this.$form=this.$el.find(this.o.sel.form),this.$title=this.$el.find(this.o.sel.title),this.$goSite=this.$footer.find(".overlay-footer-button").on("click.Overlay",function(){b.close()}),this.$form.length)var c=new LMDA.Views.Subscription({el:this.$form,done:function(a){a.message&&b.$message.html(a.message),b.$title.addClass(b.o.cn.hidden),b.$layout.addClass(b.o.cn.hidden),b.$message.removeClass(b.o.cn.hidden),b.startCountdown(),LMDA.Statistics.report("overlay","submit")},fail:function(a){a.message&&c.$el.find(".subscription__messages").show().find(".subscription__message-fail").html(a.message).show()}});this.on("open",function(){this.$el.removeClass(b.o.cn.initialView)}),this.on("close",function(){b.countdownInterval?a.clearInterval(b.countdownInterval):LMDA.Statistics.report("overlay","close"),LMDA.cookie.get("autoGender")&&"/"===document.location.pathname&&document.location.reload()})},startCountdown:function(b){if(b&&b.preventDefault(),!this.$countdown.length)return this.close();var c=this,d=10,e=function(){c.$countdown.html(["Окно закроется через ",d," ",LMDA.Utils.pluralize(d,"секунду","секунды","секунд")].join(""))};this.countdownInterval&&a.clearInterval(this.countdownInterval),e(),this.countdownInterval=a.setInterval(function(){return d--,d?void e():(a.clearInterval(c.countdownInterval),void c.close())},1e3)}});LMDA.Events.once(LMDA.Events.APP_READY,function(){var a=new f;d(a)})}}(window,document),function(){function a(){var a=LMDA.country&&LMDA.country.site,e=LMDA.Views.Popup.extend({context:"survey",outSideCLick:function(){},initialize:function(){},closeTimeout:null,init:function(){this.on("close",function(){this.$el.remove()})},render:function(){var b=this.getUserData();$("body").append('<div class="popup hidden js-survey-gizmo-popup"><div class="popup__inner"><span class="popup__close" data-popup-close=""></span><span class="popup__loader"></span><div class="popup__content"><iframe src="//www.surveygizmo.com/s3/'+c[a]+$.param(b)+'" frameborder="0" width="'+d+'" height="500" style="overflow:hidden;margin-right:-2px;margin-top:20px;"></iframe></div></div></div>'),this.setElement(".js-survey-gizmo-popup"),LMDA.Views.Popup.prototype.initialize.call(this)},getUserData:function(){var a=this.getSessionId()||"",b=LMDA.Utils.cookie.get("lid")||"",c=LMDA.geo;return{gender:LMDA.user&&LMDA.user.gender,status:LMDA.DATA.user.get("isNew")?"new":"old",sid:a,lid:b,is_client:LMDA.user.isLoggedIn?"yes":"no",geo_id:c.id,country_id:c.countryId,country_name:c.countryName,region_id:c.regionId,region_name:c.regionName,city_id:c.cityId,city_name:c.cityName}},getSessionId:function(){var a=LMDA.Utils.cookie.get("sid");return[].concat(a.match(/\|(\w+)"$/))[1]},closePopup:function(a){var b=this;clearTimeout(this.closeTimeout),this.closeTimeout=window.setTimeout(function(){b.close()},a)}}),f=Backbone.View.extend({el:".js-survey-gizmo",initialize:function(){this.$openHintButton=this.$(".js-survey-gizmo-button"),this.$hint=this.$(".js-survey-gizmo-hint"),this.$closeHint=this.$(".js-survey-gizmo-hint-close"),this.$openPopupButton=this.$hint.find('button[type="submit"]'),this.model.checkInitialConditions()},bindEvents:function(){var a=this;this.$openHintButton.on("click",function(){a.trigger("open-popup"),LMDA.Statistics.report("surveyButton","click",{})}),this.$closeHint.on("click",_.bind(this.closeHint,this)),this.$openPopupButton.on("click",function(){a.trigger("open-popup"),a.closeHint()})},showButton:function(){this.$openHintButton.addClass("survey-gizmo__button_visible"),LMDA.Statistics.report("surveyButton","show",{})},hideButton:function(){this.$openHintButton.removeClass("survey-gizmo__button_visible")},openHint:function(){this.trigger("open-hint"),this.$hint.addClass("survey-gizmo__hint_visible animated animated__fadeInUp")},closeHint:function(){this.$hint.removeClass("survey-gizmo__hint_visible animated animated__fadeInUp")}}),g=Backbone.Model.extend({defaults:{hintWasShown:!1,pageViews:0,sessionStartDate:0,sessionDuration:0,surveyPassed:!1},initialize:function(){this.pageTimeLimitReached=!1,this.pageTimeout=1e4,this.pageCountLimit=10,this.sessionDurationLimit=42e4,this.on("change",this.setLocalData),this.listenMessage()},checkInitialConditions:function(){var a=this,c=function(){var a=new Date,b=a.getDate(),c=a.getMonth()+1,d=a.getFullYear();return a=b+"/"+c+"/"+d}();LMDA.localStorage.getItemCrossDomain(b,function(b){null!=b&&a.set(b),a.get("surveyPassed")||(window.setTimeout(function(){a.trigger("show-button")},100),a.get("sessionStartDate")!=c&&(a.set("sessionStartDate",c),a.set("sessionDuration",0)),a.hintHandler(),a.setPageTimeout(),a.pageViewsCounter(),a.sessionTimeCounter())})},setLocalData:function(){LMDA.localStorage.setItemCrossDomain(b,this.toJSON())},setPageTimeout:function(){setTimeout(_.bind(function(){this.pageTimeLimitReached=!0,this.hintHandler()},this),this.pageTimeout)},pageViewsCounter:function(){var a=this.get("pageViews");this.set("pageViews",++a),this.get("pageViews")>=this.pageCountLimit&&this.hintHandler()},sessionTimeCounter:function(){var a=this,b=new Date,c=b.getTime(),d=function(){var b=new Date,d=b.getTime(),e=a.get("sessionDuration");a.set("sessionDuration",d-c+e)};window.addEventListener?window.addEventListener("beforeunload",d):window.attachEvent&&window.attachEvent("onbeforeunload",d)},hintHandler:function(){var a=this.toJSON();!a.hintWasShown&&this.pageTimeLimitReached&&a.pageViews>=this.pageCountLimit&&a.sessionDuration>this.sessionDurationLimit&&(LMDA.Statistics.report("surveyHint","open",{}),this.trigger("open-hint"))},listenMessage:function(){var a=this;$(window).on("message",function(b){var c=b.origin||b.originalEvent.origin,d;"http://www.surveygizmo.com"==c&&(d=b.data||b.originalEvent.data,d&&("passed"==d.surveyStatus?(a.set("surveyPassed",!0),a.trigger("hide-button"),LMDA.Events.trigger("survey:pass")):"close"==d.surveyPopup&&a.trigger("close-popup")))})}}),h=new g,i=new f({model:h}),j=new e({el:".js-survey-gizmo-popup"});i.on("open-popup",function(){j.render(),j.open()}).on("open-hint",function(){h.set("hintWasShown",!0)}),h.on("show-button",function(){i.showButton(),i.bindEvents()}).on("hide-button",function(){i.hideButton(),j.closePopup(7e3)}).on("open-hint",function(){i.openHint()}).on("close-popup",function(){j.closePopup(0)}),j.on("close",function(){h.get("surveyPassed")?h.set("hintWasShown",!0):this.log("abort")})}var b,c,d;if(LMDA.DATA)if(LMDA.DATA.isExperimentOn("survey_gizmo"))b="survey_gizmo",c={ru:"2112010/survey-web-site-v2?",ua:"2264078/Web-site-survey-UA?",kz:"2264076/survey-web-site-v2-copy?",by:"2264079/Web-site-survey-BY?"},d=700;else{if(!LMDA.DATA.isExperimentOn("survey_gizmo_2"))return;b="survey_gizmo_2",c={ru:"2343393/Price-and-assortment-Onsite?country=RU&",ua:"2343393/Price-and-assortment-Onsite?country=UA&",kz:"2343393/Price-and-assortment-Onsite?country=KZ&",by:"2343393/Price-and-assortment-Onsite?country=BY&"},d=900}LMDA.Events.once(LMDA.Events.STAT_READY,function(){LMDA.PARAMS&&LMDA.PARAMS.page&&"cart"!=LMDA.PARAMS.page.view&&a()})}(),function(){function a(){var a,b,c=document.createElement("script"),d,e={ru:{clid:"10718Abhth",siteNew:"15524"},by:{clid:"10718RshNd",siteNew:"31153"},kz:{clid:"10718Qbbay",siteNew:"31156"},ua:{clid:"10718strEB",siteNew:"31162"}};c.type="text/javascript",c.async=!0,c.charset="utf-8",c.src="//cleversite.ru/cleversite/widget_new.php?supercode=1&referer_main="+encodeURIComponent(document.referrer)+"&clid="+e[LMDA.site].clid+"&siteNew="+e[LMDA.site].siteNew,d=document.getElementsByTagName("script")[0],window==window.top&&-1==window.location.pathname.indexOf("/landing/size-tab/")&&d.parentNode.insertBefore(c,d)}function b(){var a={ru:{clid:"127471"},by:{clid:"136468"},kz:{clid:"136465"},ua:{clid:"136467"}},b=a[LMDA.site||"ru"].clid;window.liveTex=!0,window.liveTexID=b,window.liveTex_object=!0,function(){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src="//cs15.livetex.ru/js/client.js";var b=document.getElementsByTagName("script")[0];b?b.parentNode.insertBefore(a,b):document.documentElement.firstChild.appendChild(a)}()}if(!LMDA.isTouch){var c=LMDA.PARAMS&&LMDA.PARAMS.page;LMDA.Events.once(LMDA.Events.STAT_READY,function(){var d;document.__proto__&&LMDA.experiments&&"1"==LMDA.experiments.zopim_chat&&(window.clever_event_hook=function(a,b){"Send survay"===b&&LMDA.Statistics.report("cleversite","open"),"Send message"===b&&LMDA.Statistics.report("cleversite","submit")},c&&"cart"==c.view?setTimeout(a,6e4):a()),d="1"===LMDA.experiments.UI10310_livetex_chat,d&&(c&&"cart"==c.view?setTimeout(b,6e4):b())})}}(),function(a,b){"use strict";var c=LMDA.Views.BaseView.extend({defaults:{evt:LMDA.Utils.getEventsNamesMap("MenuView"),sel:{categories:".menu__categories",dropdown:".menu__category-dropdown",dropdownsWrapper:".menu__categories-dropdowns",tab:".menu__tab",tabTrigger:".menu__breadcrumbs-tabs-item",tabTriggerLeft:".menu__column-tabs-trigger",trigger:".menu__category-trigger",wrapper:"#menu-wrapper"},cn:{active:"menu__category-trigger_active",dropdown:"menu__category-dropdown",dropdownActive:"menu__category-dropdown_active",loading:"menu__categories_loading",tabActive:"menu__tab_active",tabTriggerActive:"button_toggled",tabTriggerLeft:"menu__column-tabs-trigger",tabTriggerLeftActive:"menu__column-tabs-trigger_active"},dataProps:{ajax:"ajax",tabTarget:"target"},msDelayLoad:0,msDelayHover:100},initialize:function(){if(!this.o.$menu||!this.o.$menu.length)return this;var b=this;if(this.$menu=this.o.$menu,this.$wrapper=this.$menu.find(this.o.sel.wrapper),this.$categories=this.$wrapper.find(this.o.sel.categories),this.$triggers=this.$categories.find(this.o.sel.trigger),this.$dropdownsWrapper=this.$menu.parent().find(this.o.sel.dropdownsWrapper),this.$triggers.length){if(LMDA.isTouch)return this.$triggers.one(this.o.evt.click,function f(a){a&&a.preventDefault(),b.$triggers.off(b.o.evt.click,f),b.loadMenu($(this))}),this;var c=!1,d=null,e;this.$triggers.on(this.o.evt.mousemove,function g(f){f&&f.preventDefault(),c=!0,d=$(this),e&&(a.clearTimeout(e),e=null),e=a.setTimeout(function(){c&&(e=null,b.$triggers.off(b.o.evt.mousemove,g).off(b.o.evt.mouseleave),b.loadMenu(d))},b.o.msDelayLoad)}).on(this.o.evt.mouseleave,function(){c=!1})}return this},getTriggers:function(a){return a.find([this.o.sel.tabTrigger,this.o.sel.tabTriggerLeft].join(", "))},loadMenu:function(a){function b(a){return a&&a.preventDefault(),a&&a.stopPropagation(),!1}var c=this,d=this.$categories.data(this.o.dataProps.ajax);return this.$xhr&&this.$xhr.abort(),this.$categories.addClass(this.o.cn.loading).on(this.o.evt.click,b),this.$xhr=$.ajax({type:"get",contentType:"html",url:d}).done(function(d){c.$dropdowns=c.$dropdownsWrapper.html(d).find(c.o.sel.dropdown),c.$categories.off(c.o.evt.click,b).removeClass(c.o.cn.loading),c[LMDA.isTouch?"bindTouchTriggers":"bindTriggers"](),a&&c.showDropdown(a),c.$tabTriggers=c.getTriggers(c.$dropdownsWrapper),c.$tabTriggers.length&&c.bindTabs()}),this},hideDropdowns:function(){return this.$triggers.removeClass(this.o.cn.active),this.$dropdowns.removeClass(this.o.cn.dropdownActive).hide(),this.trigger("hideDropdowns"),this},getElOffset:function(a){if(!a||!a.length)return{top:0,left:0,width:0,height:0};var b=a.offset();return b.width=b.width||a.outerWidth&&a.outerWidth()||a.width(),b.height=b.height||a.outerHeight&&a.outerHeight()||a.height(),b},updateBounds:function(){var a=this.getElOffset(this.$triggers.first()),b=this.getElOffset(this.$triggers.last()),c=this.getElOffset(this.$currentDropdown);return this.bounds=[[a.left,b.left+b.width+5,a.top-5,a.top+a.height+15],[c.left,c.left+c.width,c.top,c.top+c.height]],this},bindTriggers:function(){function b(a){g.x=a.pageX||a.clientX+document.body.scrollLeft+document.scrollLeft||0,g.y=a.pageY||a.clientY+document.body.scrollTop+document.scrollTop||0}function c(a){return b(a),g.x>=f.bounds[0][0]&&g.x<=f.bounds[0][1]&&g.y>=f.bounds[0][2]&&g.y<=f.bounds[0][3]?!0:g.x>=f.bounds[1][0]&&g.x<=f.bounds[1][1]&&g.y>=f.bounds[1][2]&&g.y<=f.bounds[1][3]?!0:!1}function d(a){c(a)||(LMDA.$body.off(f.o.evt.mousemove,d),f.hideDropdowns(),e())
}function e(){h&&(h=a.clearTimeout(h)),i=null}var f=this,g={x:0,y:0},h=null,i=null;return this.$triggers.on(this.o.evt.mouseenter,function(b){var c=$(this);i=function(){c.hasClass(f.o.cn.active)||(f.showDropdown(c),LMDA.$body.off(f.o.evt.mousemove,d).on(f.o.evt.mousemove,d))},h&&(h=a.clearTimeout(h)),h=a.setTimeout(function(){i&&i(),e()},f.o.msDelayHover)}).on(this.o.evt.mouseleave,e),this.on("dropdownShown",function(){f.updateBounds()}),LMDA.$window.on("resize.MenuView",function(){f.updateBounds()}),LMDA.$body.on(f.o.evt.mousemove,d),this},bindTouchTriggers:function(){function b(a){return $(a.target).closest(e.$currentDropdown).length?void 0:e.hideDropdowns()}function c(a){return a>f?e.hideDropdowns():void 0}function d(a){return function(){c(a)}}var e=this,f=Math.max(document.documentElement.clientHeight,a.innerHeight||0);return this.on("hideDropdowns",function(){LMDA.$body.off(e.o.evt.click,b),LMDA.Utils.onScroll.off("y",d)}),this.on("dropdownShown",function(){LMDA.$body.off(e.o.evt.click,b).on(e.o.evt.click,b),LMDA.Utils.onScroll("y",d)}),this.$triggers.on(this.o.evt.click,function(a){var b=$(this);return b.hasClass(e.o.cn.active)?!0:(a.preventDefault(),a.stopPropagation(),e.showDropdown(b))}),this},showDropdown:function(a){this.hideDropdowns(),this.$currentTrigger=a.addClass(this.o.cn.active),this.$currentDropdown=this.$dropdowns.eq(a.index()).addClass(this.o.cn.dropdownActive).show();var b=this.getTriggers(this.$currentDropdown);b.length&&(b.filter([[".",this.o.cn.tabTriggerActive].join(""),[".",this.o.cn.tabTriggerLeftActive].join("")].join(", ")).length||this.showTab(b.first(),b)),this.trigger("dropdownShown",{$dropdown:this.$currentDropdown,$trigger:this.$currentTrigger})},bindTabs:function(){var a=this;return this.$tabTriggers.on(this.o.evt.click,function(b){b&&b.preventDefault(),a.showTab($(this))}),this},showTab:function(a,b){var c=this.o.cn[a.hasClass(this.o.cn.tabTriggerLeft)?"tabTriggerLeftActive":"tabTriggerActive"],d=a.data(this.o.dataProps.tabTarget),e=this.$currentDropdown.find(this.o.sel.tab).removeClass(this.o.cn.tabActive),f=e.filter(['[data-target="',d,'"]'].join(""));return this.$currentDropdown.find(".menu__breadcrumbs-items").html(a.html()),b=b||a.siblings(),b.removeClass(c),a.addClass(c),f.addClass(this.o.cn.tabActive),a.hasClass(this.o.cn.tabTriggerLeft)&&b.parent().css("height",f.height()),!0}});new c({$menu:$("#menu")})}(window),function(a,b){"use strict";var c=LMDA.Views.BaseView.extend({defaults:{evt:LMDA.Utils.getEventsNamesMap("SubscriptionView"),sel:{wrapper:".ii-subscription__wrapper",title:".ii-subscription__title",form:".ii-subscription__form",formEmail:".ii-subscription__form-email",formButtons:".ii-subscription__form-button",message:".ii-subscription__message"},cn:{buttonLoading:"button_inprogress",buttonDisabled:"button_disabled",blocked:"ii-blocked"},data:{gender:"gender"}},initialize:function(){if(!this.options.$container||!this.options.$container.length)return this;var a=this;return require(["ii/widget/tip"],function(b){a.tip=new b({preset:"subscription"}),a.init&&a.init()}),this},init:function(){var a=this;return this.$container=this.options.$container,this.source=this.options.source,this.$wrapper=this.$container.find(this.o.sel.wrapper),this.$title=this.$wrapper.find(this.o.sel.title),this.$form=this.$wrapper.find(this.o.sel.form),this.$formEmail=this.$form.find(this.o.sel.formEmail),this.$formButtons=this.$form.find(this.o.sel.formButtons),this.$message=this.$wrapper.find(this.o.sel.message),this.$formButtons.on(this.o.evt.click,function(){a.onButtonClick.apply(a,arguments)}),this.$form.on(this.o.evt.submit,function(){a.onFormSubmit.apply(a,arguments)}),this.$lastButton=this.$formButtons.first(),this},onFormSubmit:function(a){return a&&a.preventDefault(),this.$form.hasClass(this.o.cn.blocked)?!1:(this.email=$.trim(this.$formEmail.val()),LMDA.Validators.email.validator(this.email)?this.block():(this.showError(this.$formEmail,LMDA.Validators.email.message),!1))},onButtonClick:function(a){a&&a.preventDefault();var b=$(a.currentTarget);if(!b.hasClass(this.o.cn.buttonDisabled))return this.$lastButton=b,this.$form.submit()},showError:function(a,b){return this.tip.error(a,b,"top"),this},handleSubmitFail:function(a){return this.showError(this.$lastButton,a.message),this},handleSubmitDone:function(a){return this.$form.hide(),this.$title.hide(),this.$message.html(a.message).show(),this},block:function(){var a=this,b=_.reduce(this.$form.serializeArray(),function(a,b){return a[b.name]=b.value,a},{});return this.tip.close(),this.$message.hide(),this.$form.addClass(this.o.cn.blocked),this.$formButtons.addClass(this.o.cn.buttonDisabled),b.gender=this.$lastButton.addClass(this.o.cn.buttonLoading).data(this.o.data.gender),LMDA.API.subscribe.newsletter(b,{source:this.source}).fail(function(){a.handleSubmitFail.apply(a,arguments)}).done(function(){a.handleSubmitDone.apply(a,arguments)}).always(function(b){a.$form.removeClass(a.o.cn.blocked),a.$formButtons.removeClass([a.o.cn.buttonDisabled,a.o.cn.buttonLoading].join(" "))}),this}});new c({$container:$('[data-widget="subscription"]'),source:"mainpage"});var d=c.extend({handleSubmitDone:function(){this.$wrapper.remove()}});new d({$container:$(".footer-subscription-block"),source:"footer",sel:{wrapper:".footer-subscription-block-wrapper",title:".footer-subscription-block__title",form:".footer-subscription-form",formEmail:".footer-subscription-form__email",formButtons:".footer-subscription-form__button",message:".footer-subscription-form__message"}})}(window),function(){var a={},b={NO_SOURCE:0,SERVICE_MAILING:1,MAILING:2,SEARCH_ENGINES:3,ADWORDS:4,WT_ONSITE:5,WT_TAGS:6,UTM_TAGS:7},c,d="",e,f,g;window.location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(b,c,d){a[c]=d}),f=function(a){LMDA.localStorage.setItemCrossDomain(a,e)},c=function(a){return a?_.some(["yandex.","google.","rambler.","bing.","ru.search.yahoo.","en.search.yahoo.","ask.","mail.ru","go.mail.ru","google.com.ua","images.google.ru","maps.google.ru","nova.rambler.ru","gogo.ru","nigma.ru","search.qip.ru","webalta.ru","sm.aport.ru","meta.ua","search.bigmir.net","search.i.ua","index.online.ua","web20.a.ua","search.ukr.net","search.com.ua","search.ua","poisk.ru","go.km.ru","liveinternet.ru","gde.ru","affiliates.quintura.com","akavita.by","search.tut.by","all.by"],function(b){return new RegExp("^https?://(www\\.)?"+b.replace(/\./g,"\\.")).test(a)?(d=b,!0):void 0}):!1}(document.referrer),e={date:(new Date).getTime()/1e3>>0,medium:a.utm_medium||"",source:a.utm_source||"",campaign:a.utm_campaign||"",term:a.utm_term||"",content:a.utm_content||""},g=function(){var f="",g;return"1"===a.utm_nooverride?b.NO_SOURCE:"nl"===a.utm_source&&a.utm_campaign&&-1!=a.utm_campaign.indexOf("_AU_")?b.SERVICE_MAILING:"nl"===a.utm_source?b.MAILING:"os"===a.utm_medium?b.WT_ONSITE:a.utm_source&&a.utm_source.length?b.UTM_TAGS:(_.each(a,function(c,d){"wt_ga"===d.substr(0,5)&&(e=_.extend(e,{medium:"cpc",source:"AdWords",campaign:d.substr(5,2),content:c}),e.term=a["wt_gk"+e.campaign]||"",g=b.ADWORDS),"wt_os"===d.substr(0,5)&&(g=b.WT_ONSITE),"wt_"===d.substr(0,3)&&(f=d)}),g?g:f&&a[f]?(e=_.extend(e,function(a){return{medium:a[1]||"",source:a[2]||"",campaign:a[3]||"",content:a[4]||"",term:a[5]||""}}(a[f].split("."))),b.WT_TAGS):a.gclid?(e=_.extend(e,{medium:"cpc",source:"Google",campaign:"",content:"",term:""}),b.ADWORDS):c?(e=_.extend(e,{medium:"organic",source:d,campaign:"",content:"",term:""}),b.SEARCH_ENGINES):b.NO_SOURCE)}(),g==b.ADWORDS||g==b.WT_TAGS||g==b.UTM_TAGS?(f("affiliate_nl_not_affected"),f("affiliate_base"),f("affiliate_seo_affected")):g==b.MAILING?(f("affiliate_base"),f("affiliate_seo_affected")):g==b.SEARCH_ENGINES&&f("affiliate_seo_affected")}(),LMDA.Marketing=function(){this.subscriberId=0,this.customerId=0,this.init()},LMDA.Marketing.prototype.init=function(){this._loadClientId(),this.affiliates={},this._config(),this._anyPageInitialization(),this._replaceableInitialization(),LMDA.page.initMarketingParts(this),this._loadAffiliates()},LMDA.Marketing.prototype=_.extend(LMDA.Marketing.prototype,Backbone.Events),LMDA.Marketing.prototype._loadAffiliates=function(){var a=0,b=["affiliate_nl_not_affected","affiliate_base","affiliate_seo_affected","subscriber_base"];_.each(b,function(c){var d=this;LMDA.localStorage.getItemCrossDomain(c,function(e){e&&(d.affiliates[c]=e),a++,a==b.length&&d.trigger("loaded:affiliates")})},this)},LMDA.Marketing.prototype._replaceableInitialization=function(){},LMDA.Marketing.prototype._anyPageInitialization=function(){},LMDA.Marketing.prototype._loadClientId=function(){var a;return LMDA.user.isLogon?void this.setClientId(LMDA.user.id,LMDA.user.subscriberId):(a=document.cookie.match(/LM_REMAIL="(.*?)"; /),null!==a&&a.length>1?(a=a[1].split(/-/),void(a.length>1&&this.setClientId(a[1],a[0]))):void 0)},LMDA.Marketing.prototype.setClientId=function(a,b){this.customerId=a||this.customerId||"",this.subscriberId=b||this.subscriberId||"",document.cookie='LM_REMAIL="'+b+"-"+a+'";path=/;domain='+document.domain.replace(/^.[^\.]*/,"")+";expires=Mon, 03 Nov 2014 23:59:00 GMT"},LMDA.Marketing.prototype.loadPixel=function(a){var b=new Image;b.src=a+(/\?/.test(a)?"&":"?")+"random="+Math.floor(1e9*Math.random())},LMDA.Marketing.prototype._config=function(){this.admitad="4e8640d77b"},LMDA.Marketing.prototype._anyPageInitialization=function(){this.loadPixel("//ib.adnxs.com/px?id=89564&t=2")},LMDA.Stats=LMDA.Stats||{},LMDA.Stats.init=function(){},function(a,b,c){"use strict";LMDA.z=function(a,b){function c(){var a=new Image;a.src="/z?"+$.param(b)}b=b||{},_.extend(b,LMDA.z.getGeneralParams(a)),LMDA.DATA.app.get("ready")?c():LMDA.Events.once(LMDA.Events.APP_READY,function(){c()})},LMDA.z.getGeneralParams=function(a){var b={ab:LMDA.experiments.ID,action:a,customer_id:LMDA.user&&LMDA.user.id,referrer:document.referrer,rnd:1e6*Math.random()|0};if("pageview"!==a&&(b.url=window.location.href),"cart:not-empty"==LMDA.DATA.page.get("type"))try{b["interface"]=LMDA.pageData.checkout_type}catch(c){}return b},LMDA.z.mapSizes=function(a){return _.map(a,function(a){return $(a).find(".button__title").eq(0).text()}).join(";")},LMDA.z.logReccommendations=function(a,b){a[0]&&LMDA.z("show_recommendations",{source:b,sku:_.map(a.find("a[data-sku]"),function(a,b){return b+":"+$(a).data("sku")}).join(";")})},LMDA.zDeferred=function(a,b,c){LMDA.localStorage.setItemCrossDomain("lmda.z",{action:a,params:b},c)},LMDA.localStorage.getItemCrossDomain("lmda.z",function(a){a&&_.isObject(a)&&(LMDA.z(a.action,a.params),LMDA.localStorage.setItemCrossDomain("lmda.z",""))})}(window,document);
;
!function(){require(["ii/multi-filter/multi-filter"])}();